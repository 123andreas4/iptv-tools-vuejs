{"remainingRequest":"/media/ernst/63bce43c-5e51-4bf1-a611-3afdf32ac6f6/VueJS/IPTV-Tools/node_modules/thread-loader/dist/cjs.js!/media/ernst/63bce43c-5e51-4bf1-a611-3afdf32ac6f6/VueJS/IPTV-Tools/node_modules/babel-loader/lib/index.js!/media/ernst/63bce43c-5e51-4bf1-a611-3afdf32ac6f6/VueJS/IPTV-Tools/node_modules/bootstrap-vue/esm/components/carousel/carousel.js","dependencies":[{"path":"/media/ernst/63bce43c-5e51-4bf1-a611-3afdf32ac6f6/VueJS/IPTV-Tools/node_modules/bootstrap-vue/esm/components/carousel/carousel.js","mtime":499162500000},{"path":"/media/ernst/63bce43c-5e51-4bf1-a611-3afdf32ac6f6/VueJS/IPTV-Tools/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/media/ernst/63bce43c-5e51-4bf1-a611-3afdf32ac6f6/VueJS/IPTV-Tools/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/media/ernst/63bce43c-5e51-4bf1-a611-3afdf32ac6f6/VueJS/IPTV-Tools/node_modules/babel-loader/lib/index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmtleXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zeW1ib2wuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3JzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zcGxpdC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lm1hcC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdC5qcyI7Cgp2YXIgX3dhdGNoOwoKZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7CiAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpOwoKICBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgewogICAgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7CiAgICBpZiAoZW51bWVyYWJsZU9ubHkpIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7CiAgICAgIHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOwogICAgfSk7CiAgICBrZXlzLnB1c2guYXBwbHkoa2V5cywgc3ltYm9scyk7CiAgfQoKICByZXR1cm4ga2V5czsKfQoKZnVuY3Rpb24gX29iamVjdFNwcmVhZCh0YXJnZXQpIHsKICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgewogICAgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXSAhPSBudWxsID8gYXJndW1lbnRzW2ldIDoge307CgogICAgaWYgKGkgJSAyKSB7CiAgICAgIG93bktleXMoT2JqZWN0KHNvdXJjZSksIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOwogICAgICB9KTsKICAgIH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsKICAgIH0gZWxzZSB7CiAgICAgIG93bktleXMoT2JqZWN0KHNvdXJjZSkpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOwogICAgICB9KTsKICAgIH0KICB9CgogIHJldHVybiB0YXJnZXQ7Cn0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsKICBpZiAoa2V5IGluIG9iaikgewogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7CiAgICAgIHZhbHVlOiB2YWx1ZSwKICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICB3cml0YWJsZTogdHJ1ZQogICAgfSk7CiAgfSBlbHNlIHsKICAgIG9ialtrZXldID0gdmFsdWU7CiAgfQoKICByZXR1cm4gb2JqOwp9CgppbXBvcnQgeyBWdWUgfSBmcm9tICcuLi8uLi92dWUnOwppbXBvcnQgeyBOQU1FX0NBUk9VU0VMIH0gZnJvbSAnLi4vLi4vY29uc3RhbnRzL2NvbXBvbmVudHMnOwppbXBvcnQgeyBJU19CUk9XU0VSLCBIQVNfUE9JTlRFUl9FVkVOVF9TVVBQT1JULCBIQVNfVE9VQ0hfU1VQUE9SVCB9IGZyb20gJy4uLy4uL2NvbnN0YW50cy9lbnYnOwppbXBvcnQgeyBFVkVOVF9OQU1FX1BBVVNFRCwgRVZFTlRfTkFNRV9TTElESU5HX0VORCwgRVZFTlRfTkFNRV9TTElESU5HX1NUQVJULCBFVkVOVF9OQU1FX1VOUEFVU0VELCBFVkVOVF9PUFRJT05TX05PX0NBUFRVUkUgfSBmcm9tICcuLi8uLi9jb25zdGFudHMvZXZlbnRzJzsKaW1wb3J0IHsgQ09ERV9FTlRFUiwgQ09ERV9MRUZULCBDT0RFX1JJR0hULCBDT0RFX1NQQUNFIH0gZnJvbSAnLi4vLi4vY29uc3RhbnRzL2tleS1jb2Rlcyc7CmltcG9ydCB7IFBST1BfVFlQRV9CT09MRUFOLCBQUk9QX1RZUEVfTlVNQkVSLCBQUk9QX1RZUEVfTlVNQkVSX1NUUklORywgUFJPUF9UWVBFX1NUUklORyB9IGZyb20gJy4uLy4uL2NvbnN0YW50cy9wcm9wcyc7CmltcG9ydCB7IGFkZENsYXNzLCBnZXRBY3RpdmVFbGVtZW50LCByZWZsb3csIHJlbW92ZUNsYXNzLCByZXF1ZXN0QUYsIHNlbGVjdEFsbCwgc2V0QXR0ciB9IGZyb20gJy4uLy4uL3V0aWxzL2RvbSc7CmltcG9ydCB7IGV2ZW50T24sIGV2ZW50T2ZmLCBzdG9wRXZlbnQgfSBmcm9tICcuLi8uLi91dGlscy9ldmVudHMnOwppbXBvcnQgeyBpc1VuZGVmaW5lZCB9IGZyb20gJy4uLy4uL3V0aWxzL2luc3BlY3QnOwppbXBvcnQgeyBtYXRoQWJzLCBtYXRoRmxvb3IsIG1hdGhNYXgsIG1hdGhNaW4gfSBmcm9tICcuLi8uLi91dGlscy9tYXRoJzsKaW1wb3J0IHsgbWFrZU1vZGVsTWl4aW4gfSBmcm9tICcuLi8uLi91dGlscy9tb2RlbCc7CmltcG9ydCB7IHRvSW50ZWdlciB9IGZyb20gJy4uLy4uL3V0aWxzL251bWJlcic7CmltcG9ydCB7IG5vb3AgfSBmcm9tICcuLi8uLi91dGlscy9ub29wJzsKaW1wb3J0IHsgc29ydEtleXMgfSBmcm9tICcuLi8uLi91dGlscy9vYmplY3QnOwppbXBvcnQgeyBvYnNlcnZlRG9tIH0gZnJvbSAnLi4vLi4vdXRpbHMvb2JzZXJ2ZS1kb20nOwppbXBvcnQgeyBtYWtlUHJvcCwgbWFrZVByb3BzQ29uZmlndXJhYmxlIH0gZnJvbSAnLi4vLi4vdXRpbHMvcHJvcHMnOwppbXBvcnQgeyBpZE1peGluLCBwcm9wcyBhcyBpZFByb3BzIH0gZnJvbSAnLi4vLi4vbWl4aW5zL2lkJzsKaW1wb3J0IHsgbm9ybWFsaXplU2xvdE1peGluIH0gZnJvbSAnLi4vLi4vbWl4aW5zL25vcm1hbGl6ZS1zbG90JzsgLy8gLS0tIENvbnN0YW50cyAtLS0KCnZhciBfbWFrZU1vZGVsTWl4aW4gPSBtYWtlTW9kZWxNaXhpbigndmFsdWUnLCB7CiAgdHlwZTogUFJPUF9UWVBFX05VTUJFUiwKICBkZWZhdWx0VmFsdWU6IDAKfSksCiAgICBtb2RlbE1peGluID0gX21ha2VNb2RlbE1peGluLm1peGluLAogICAgbW9kZWxQcm9wcyA9IF9tYWtlTW9kZWxNaXhpbi5wcm9wcywKICAgIE1PREVMX1BST1BfTkFNRSA9IF9tYWtlTW9kZWxNaXhpbi5wcm9wLAogICAgTU9ERUxfRVZFTlRfTkFNRSA9IF9tYWtlTW9kZWxNaXhpbi5ldmVudDsgLy8gU2xpZGUgZGlyZWN0aW9uYWwgY2xhc3NlcwoKCnZhciBESVJFQ1RJT04gPSB7CiAgbmV4dDogewogICAgZGlyQ2xhc3M6ICdjYXJvdXNlbC1pdGVtLWxlZnQnLAogICAgb3ZlcmxheUNsYXNzOiAnY2Fyb3VzZWwtaXRlbS1uZXh0JwogIH0sCiAgcHJldjogewogICAgZGlyQ2xhc3M6ICdjYXJvdXNlbC1pdGVtLXJpZ2h0JywKICAgIG92ZXJsYXlDbGFzczogJ2Nhcm91c2VsLWl0ZW0tcHJldicKICB9Cn07IC8vIEZhbGxiYWNrIFRyYW5zaXRpb24gZHVyYXRpb24gKHdpdGggYSBsaXR0bGUgYnVmZmVyKSBpbiBtcwoKdmFyIFRSQU5TX0RVUkFUSU9OID0gNjAwICsgNTA7IC8vIFRpbWUgZm9yIG1vdXNlIGNvbXBhdCBldmVudHMgdG8gZmlyZSBhZnRlciB0b3VjaAoKdmFyIFRPVUNIX0VWRU5UX0NPTVBBVF9XQUlUID0gNTAwOyAvLyBOdW1iZXIgb2YgcGl4ZWxzIHRvIGNvbnNpZGVyIHRvdWNoIG1vdmUgYSBzd2lwZQoKdmFyIFNXSVBFX1RIUkVTSE9MRCA9IDQwOyAvLyBQb2ludGVyRXZlbnQgcG9pbnRlciB0eXBlcwoKdmFyIFBvaW50ZXJUeXBlID0gewogIFRPVUNIOiAndG91Y2gnLAogIFBFTjogJ3BlbicKfTsgLy8gVHJhbnNpdGlvbiBFdmVudCBuYW1lcwoKdmFyIFRyYW5zaXRpb25FbmRFdmVudHMgPSB7CiAgV2Via2l0VHJhbnNpdGlvbjogJ3dlYmtpdFRyYW5zaXRpb25FbmQnLAogIE1velRyYW5zaXRpb246ICd0cmFuc2l0aW9uZW5kJywKICBPVHJhbnNpdGlvbjogJ290cmFuc2l0aW9uZW5kIG9UcmFuc2l0aW9uRW5kJywKICB0cmFuc2l0aW9uOiAndHJhbnNpdGlvbmVuZCcKfTsgLy8gLS0tIEhlbHBlciBtZXRob2RzIC0tLQovLyBSZXR1cm4gdGhlIGJyb3dzZXIgc3BlY2lmaWMgdHJhbnNpdGlvbkVuZCBldmVudCBuYW1lCgp2YXIgZ2V0VHJhbnNpdGlvbkVuZEV2ZW50ID0gZnVuY3Rpb24gZ2V0VHJhbnNpdGlvbkVuZEV2ZW50KGVsKSB7CiAgZm9yICh2YXIgbmFtZSBpbiBUcmFuc2l0aW9uRW5kRXZlbnRzKSB7CiAgICBpZiAoIWlzVW5kZWZpbmVkKGVsLnN0eWxlW25hbWVdKSkgewogICAgICByZXR1cm4gVHJhbnNpdGlvbkVuZEV2ZW50c1tuYW1lXTsKICAgIH0KICB9IC8vIEZhbGxiYWNrCgogIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovCgoKICByZXR1cm4gbnVsbDsKfTsgLy8gLS0tIFByb3BzIC0tLQoKCmV4cG9ydCB2YXIgcHJvcHMgPSBtYWtlUHJvcHNDb25maWd1cmFibGUoc29ydEtleXMoX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIGlkUHJvcHMpLCBtb2RlbFByb3BzKSwge30sIHsKICBiYWNrZ3JvdW5kOiBtYWtlUHJvcChQUk9QX1RZUEVfU1RSSU5HKSwKICBjb250cm9sczogbWFrZVByb3AoUFJPUF9UWVBFX0JPT0xFQU4sIGZhbHNlKSwKICAvLyBFbmFibGUgY3Jvc3MtZmFkZSBhbmltYXRpb24gaW5zdGVhZCBvZiBzbGlkZSBhbmltYXRpb24KICBmYWRlOiBtYWtlUHJvcChQUk9QX1RZUEVfQk9PTEVBTiwgZmFsc2UpLAogIC8vIFNuaWZmZWQgYnkgY2Fyb3VzZWwtc2xpZGUKICBpbWdIZWlnaHQ6IG1ha2VQcm9wKFBST1BfVFlQRV9OVU1CRVJfU1RSSU5HKSwKICAvLyBTbmlmZmVkIGJ5IGNhcm91c2VsLXNsaWRlCiAgaW1nV2lkdGg6IG1ha2VQcm9wKFBST1BfVFlQRV9OVU1CRVJfU1RSSU5HKSwKICBpbmRpY2F0b3JzOiBtYWtlUHJvcChQUk9QX1RZUEVfQk9PTEVBTiwgZmFsc2UpLAogIGludGVydmFsOiBtYWtlUHJvcChQUk9QX1RZUEVfTlVNQkVSLCA1MDAwKSwKICBsYWJlbEdvdG9TbGlkZTogbWFrZVByb3AoUFJPUF9UWVBFX1NUUklORywgJ0dvdG8gc2xpZGUnKSwKICBsYWJlbEluZGljYXRvcnM6IG1ha2VQcm9wKFBST1BfVFlQRV9TVFJJTkcsICdTZWxlY3QgYSBzbGlkZSB0byBkaXNwbGF5JyksCiAgbGFiZWxOZXh0OiBtYWtlUHJvcChQUk9QX1RZUEVfU1RSSU5HLCAnTmV4dCBzbGlkZScpLAogIGxhYmVsUHJldjogbWFrZVByb3AoUFJPUF9UWVBFX1NUUklORywgJ1ByZXZpb3VzIHNsaWRlJyksCiAgLy8gRGlzYWJsZSBzbGlkZS9mYWRlIGFuaW1hdGlvbgogIG5vQW5pbWF0aW9uOiBtYWtlUHJvcChQUk9QX1RZUEVfQk9PTEVBTiwgZmFsc2UpLAogIC8vIERpc2FibGUgcGF1c2Ugb24gaG92ZXIKICBub0hvdmVyUGF1c2U6IG1ha2VQcm9wKFBST1BfVFlQRV9CT09MRUFOLCBmYWxzZSksCiAgLy8gU25pZmZlZCBieSBjYXJvdXNlbC1zbGlkZQogIG5vVG91Y2g6IG1ha2VQcm9wKFBST1BfVFlQRV9CT09MRUFOLCBmYWxzZSksCiAgLy8gRGlzYWJsZSB3cmFwcGluZy9sb29waW5nIHdoZW4gc3RhcnQvZW5kIGlzIHJlYWNoZWQKICBub1dyYXA6IG1ha2VQcm9wKFBST1BfVFlQRV9CT09MRUFOLCBmYWxzZSkKfSkpLCBOQU1FX0NBUk9VU0VMKTsgLy8gLS0tIE1haW4gY29tcG9uZW50IC0tLQovLyBAdnVlL2NvbXBvbmVudAoKZXhwb3J0IHZhciBCQ2Fyb3VzZWwgPSAvKiNfX1BVUkVfXyovVnVlLmV4dGVuZCh7CiAgbmFtZTogTkFNRV9DQVJPVVNFTCwKICBtaXhpbnM6IFtpZE1peGluLCBtb2RlbE1peGluLCBub3JtYWxpemVTbG90TWl4aW5dLAogIHByb3ZpZGU6IGZ1bmN0aW9uIHByb3ZpZGUoKSB7CiAgICByZXR1cm4gewogICAgICBidkNhcm91c2VsOiB0aGlzCiAgICB9OwogIH0sCiAgcHJvcHM6IHByb3BzLAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBpbmRleDogdGhpc1tNT0RFTF9QUk9QX05BTUVdIHx8IDAsCiAgICAgIGlzU2xpZGluZzogZmFsc2UsCiAgICAgIHRyYW5zaXRpb25FbmRFdmVudDogbnVsbCwKICAgICAgc2xpZGVzOiBbXSwKICAgICAgZGlyZWN0aW9uOiBudWxsLAogICAgICBpc1BhdXNlZDogISh0b0ludGVnZXIodGhpcy5pbnRlcnZhbCwgMCkgPiAwKSwKICAgICAgLy8gVG91Y2ggZXZlbnQgaGFuZGxpbmcgdmFsdWVzCiAgICAgIHRvdWNoU3RhcnRYOiAwLAogICAgICB0b3VjaERlbHRhWDogMAogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICBudW1TbGlkZXM6IGZ1bmN0aW9uIG51bVNsaWRlcygpIHsKICAgICAgcmV0dXJuIHRoaXMuc2xpZGVzLmxlbmd0aDsKICAgIH0KICB9LAogIHdhdGNoOiAoX3dhdGNoID0ge30sIF9kZWZpbmVQcm9wZXJ0eShfd2F0Y2gsIE1PREVMX1BST1BfTkFNRSwgZnVuY3Rpb24gKG5ld1ZhbHVlLCBvbGRWYWx1ZSkgewogICAgaWYgKG5ld1ZhbHVlICE9PSBvbGRWYWx1ZSkgewogICAgICB0aGlzLnNldFNsaWRlKHRvSW50ZWdlcihuZXdWYWx1ZSwgMCkpOwogICAgfQogIH0pLCBfZGVmaW5lUHJvcGVydHkoX3dhdGNoLCAiaW50ZXJ2YWwiLCBmdW5jdGlvbiBpbnRlcnZhbChuZXdWYWx1ZSwgb2xkVmFsdWUpIHsKICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovCiAgICBpZiAobmV3VmFsdWUgPT09IG9sZFZhbHVlKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAoIW5ld1ZhbHVlKSB7CiAgICAgIC8vIFBhdXNpbmcgc2xpZGUgc2hvdwogICAgICB0aGlzLnBhdXNlKGZhbHNlKTsKICAgIH0gZWxzZSB7CiAgICAgIC8vIFJlc3RhcnRpbmcgb3IgQ2hhbmdpbmcgaW50ZXJ2YWwKICAgICAgdGhpcy5wYXVzZSh0cnVlKTsKICAgICAgdGhpcy5zdGFydChmYWxzZSk7CiAgICB9CiAgfSksIF9kZWZpbmVQcm9wZXJ0eShfd2F0Y2gsICJpc1BhdXNlZCIsIGZ1bmN0aW9uIGlzUGF1c2VkKG5ld1ZhbHVlLCBvbGRWYWx1ZSkgewogICAgaWYgKG5ld1ZhbHVlICE9PSBvbGRWYWx1ZSkgewogICAgICB0aGlzLiRlbWl0KG5ld1ZhbHVlID8gRVZFTlRfTkFNRV9QQVVTRUQgOiBFVkVOVF9OQU1FX1VOUEFVU0VEKTsKICAgIH0KICB9KSwgX2RlZmluZVByb3BlcnR5KF93YXRjaCwgImluZGV4IiwgZnVuY3Rpb24gaW5kZXgodG8sIGZyb20pIHsKICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovCiAgICBpZiAodG8gPT09IGZyb20gfHwgdGhpcy5pc1NsaWRpbmcpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRoaXMuZG9TbGlkZSh0bywgZnJvbSk7CiAgfSksIF93YXRjaCksCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIC8vIENyZWF0ZSBwcml2YXRlIG5vbi1yZWFjdGl2ZSBwcm9wcwogICAgdGhpcy4kX2ludGVydmFsID0gbnVsbDsKICAgIHRoaXMuJF9hbmltYXRpb25UaW1lb3V0ID0gbnVsbDsKICAgIHRoaXMuJF90b3VjaFRpbWVvdXQgPSBudWxsOwogICAgdGhpcy4kX29ic2VydmVyID0gbnVsbDsgLy8gU2V0IGluaXRpYWwgcGF1c2VkIHN0YXRlCgogICAgdGhpcy5pc1BhdXNlZCA9ICEodG9JbnRlZ2VyKHRoaXMuaW50ZXJ2YWwsIDApID4gMCk7CiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkgewogICAgLy8gQ2FjaGUgY3VycmVudCBicm93c2VyIHRyYW5zaXRpb25lbmQgZXZlbnQgbmFtZQogICAgdGhpcy50cmFuc2l0aW9uRW5kRXZlbnQgPSBnZXRUcmFuc2l0aW9uRW5kRXZlbnQodGhpcy4kZWwpIHx8IG51bGw7IC8vIEdldCBhbGwgc2xpZGVzCgogICAgdGhpcy51cGRhdGVTbGlkZXMoKTsgLy8gT2JzZXJ2ZSBjaGlsZCBjaGFuZ2VzIHNvIHdlIGNhbiB1cGRhdGUgc2xpZGUgbGlzdAoKICAgIHRoaXMuc2V0T2JzZXJ2ZXIodHJ1ZSk7CiAgfSwKICBiZWZvcmVEZXN0cm95OiBmdW5jdGlvbiBiZWZvcmVEZXN0cm95KCkgewogICAgdGhpcy5jbGVhckludGVydmFsKCk7CiAgICB0aGlzLmNsZWFyQW5pbWF0aW9uVGltZW91dCgpOwogICAgdGhpcy5jbGVhclRvdWNoVGltZW91dCgpOwogICAgdGhpcy5zZXRPYnNlcnZlcihmYWxzZSk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBjbGVhckludGVydmFsOiBmdW5jdGlvbiAoX2NsZWFySW50ZXJ2YWwpIHsKICAgICAgZnVuY3Rpb24gY2xlYXJJbnRlcnZhbCgpIHsKICAgICAgICByZXR1cm4gX2NsZWFySW50ZXJ2YWwuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgY2xlYXJJbnRlcnZhbC50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gX2NsZWFySW50ZXJ2YWwudG9TdHJpbmcoKTsKICAgICAgfTsKCiAgICAgIHJldHVybiBjbGVhckludGVydmFsOwogICAgfShmdW5jdGlvbiAoKSB7CiAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy4kX2ludGVydmFsKTsKICAgICAgdGhpcy4kX2ludGVydmFsID0gbnVsbDsKICAgIH0pLAogICAgY2xlYXJBbmltYXRpb25UaW1lb3V0OiBmdW5jdGlvbiBjbGVhckFuaW1hdGlvblRpbWVvdXQoKSB7CiAgICAgIGNsZWFyVGltZW91dCh0aGlzLiRfYW5pbWF0aW9uVGltZW91dCk7CiAgICAgIHRoaXMuJF9hbmltYXRpb25UaW1lb3V0ID0gbnVsbDsKICAgIH0sCiAgICBjbGVhclRvdWNoVGltZW91dDogZnVuY3Rpb24gY2xlYXJUb3VjaFRpbWVvdXQoKSB7CiAgICAgIGNsZWFyVGltZW91dCh0aGlzLiRfdG91Y2hUaW1lb3V0KTsKICAgICAgdGhpcy4kX3RvdWNoVGltZW91dCA9IG51bGw7CiAgICB9LAogICAgc2V0T2JzZXJ2ZXI6IGZ1bmN0aW9uIHNldE9ic2VydmVyKCkgewogICAgICB2YXIgb24gPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IGZhbHNlOwogICAgICB0aGlzLiRfb2JzZXJ2ZXIgJiYgdGhpcy4kX29ic2VydmVyLmRpc2Nvbm5lY3QoKTsKICAgICAgdGhpcy4kX29ic2VydmVyID0gbnVsbDsKCiAgICAgIGlmIChvbikgewogICAgICAgIHRoaXMuJF9vYnNlcnZlciA9IG9ic2VydmVEb20odGhpcy4kcmVmcy5pbm5lciwgdGhpcy51cGRhdGVTbGlkZXMuYmluZCh0aGlzKSwgewogICAgICAgICAgc3VidHJlZTogZmFsc2UsCiAgICAgICAgICBjaGlsZExpc3Q6IHRydWUsCiAgICAgICAgICBhdHRyaWJ1dGVzOiB0cnVlLAogICAgICAgICAgYXR0cmlidXRlRmlsdGVyOiBbJ2lkJ10KICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIC8vIFNldCBzbGlkZQogICAgc2V0U2xpZGU6IGZ1bmN0aW9uIHNldFNsaWRlKHNsaWRlKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB2YXIgZGlyZWN0aW9uID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBudWxsOyAvLyBEb24ndCBhbmltYXRlIHdoZW4gcGFnZSBpcyBub3QgdmlzaWJsZQoKICAgICAgLyogaXN0YW5idWwgaWdub3JlIGlmOiBkaWZmaWN1bHQgdG8gdGVzdCAqLwoKICAgICAgaWYgKElTX0JST1dTRVIgJiYgZG9jdW1lbnQudmlzaWJpbGl0eVN0YXRlICYmIGRvY3VtZW50LmhpZGRlbikgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIG5vV3JhcCA9IHRoaXMubm9XcmFwOwogICAgICB2YXIgbnVtU2xpZGVzID0gdGhpcy5udW1TbGlkZXM7IC8vIE1ha2Ugc3VyZSB3ZSBoYXZlIGFuIGludGVnZXIgKHlvdSBuZXZlciBrbm93ISkKCiAgICAgIHNsaWRlID0gbWF0aEZsb29yKHNsaWRlKTsgLy8gRG9uJ3QgZG8gYW55dGhpbmcgaWYgbm90aGluZyB0byBzbGlkZSB0bwoKICAgICAgaWYgKG51bVNsaWRlcyA9PT0gMCkgewogICAgICAgIHJldHVybjsKICAgICAgfSAvLyBEb24ndCBjaGFuZ2Ugc2xpZGUgd2hpbGUgdHJhbnNpdGlvbmluZywgd2FpdCB1bnRpbCB0cmFuc2l0aW9uIGlzIGRvbmUKCgogICAgICBpZiAodGhpcy5pc1NsaWRpbmcpIHsKICAgICAgICAvLyBTY2hlZHVsZSBzbGlkZSBhZnRlciBzbGlkaW5nIGNvbXBsZXRlCiAgICAgICAgdGhpcy4kb25jZShFVkVOVF9OQU1FX1NMSURJTkdfRU5ELCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAvLyBXcmFwIGluIGByZXF1ZXN0QUYoKWAgdG8gYWxsb3cgdGhlIHNsaWRlIHRvIHByb3Blcmx5IGZpbmlzaCB0byBhdm9pZCBnbGl0Y2hpbmcKICAgICAgICAgIHJlcXVlc3RBRihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJldHVybiBfdGhpcy5zZXRTbGlkZShzbGlkZSwgZGlyZWN0aW9uKTsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy5kaXJlY3Rpb24gPSBkaXJlY3Rpb247IC8vIFNldCBuZXcgc2xpZGUgaW5kZXgKICAgICAgLy8gV3JhcCBhcm91bmQgaWYgbmVjZXNzYXJ5IChpZiBuby13cmFwIG5vdCBlbmFibGVkKQoKICAgICAgdGhpcy5pbmRleCA9IHNsaWRlID49IG51bVNsaWRlcyA/IG5vV3JhcCA/IG51bVNsaWRlcyAtIDEgOiAwIDogc2xpZGUgPCAwID8gbm9XcmFwID8gMCA6IG51bVNsaWRlcyAtIDEgOiBzbGlkZTsgLy8gRW5zdXJlIHRoZSB2LW1vZGVsIGlzIHN5bmNoZWQgdXAgaWYgbm8td3JhcCBpcyBlbmFibGVkCiAgICAgIC8vIGFuZCB1c2VyIHRyaWVkIHRvIHNsaWRlIHBhc3MgZWl0aGVyIGVuZHMKCiAgICAgIGlmIChub1dyYXAgJiYgdGhpcy5pbmRleCAhPT0gc2xpZGUgJiYgdGhpcy5pbmRleCAhPT0gdGhpc1tNT0RFTF9QUk9QX05BTUVdKSB7CiAgICAgICAgdGhpcy4kZW1pdChNT0RFTF9FVkVOVF9OQU1FLCB0aGlzLmluZGV4KTsKICAgICAgfQogICAgfSwKICAgIC8vIFByZXZpb3VzIHNsaWRlCiAgICBwcmV2OiBmdW5jdGlvbiBwcmV2KCkgewogICAgICB0aGlzLnNldFNsaWRlKHRoaXMuaW5kZXggLSAxLCAncHJldicpOwogICAgfSwKICAgIC8vIE5leHQgc2xpZGUKICAgIG5leHQ6IGZ1bmN0aW9uIG5leHQoKSB7CiAgICAgIHRoaXMuc2V0U2xpZGUodGhpcy5pbmRleCArIDEsICduZXh0Jyk7CiAgICB9LAogICAgLy8gUGF1c2UgYXV0byByb3RhdGlvbgogICAgcGF1c2U6IGZ1bmN0aW9uIHBhdXNlKGV2ZW50KSB7CiAgICAgIGlmICghZXZlbnQpIHsKICAgICAgICB0aGlzLmlzUGF1c2VkID0gdHJ1ZTsKICAgICAgfQoKICAgICAgdGhpcy5jbGVhckludGVydmFsKCk7CiAgICB9LAogICAgLy8gU3RhcnQgYXV0byByb3RhdGUgc2xpZGVzCiAgICBzdGFydDogZnVuY3Rpb24gc3RhcnQoZXZlbnQpIHsKICAgICAgaWYgKCFldmVudCkgewogICAgICAgIHRoaXMuaXNQYXVzZWQgPSBmYWxzZTsKICAgICAgfQogICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dDogbW9zdCBsaWtlbHkgd2lsbCBuZXZlciBoYXBwZW4sIGJ1dCBqdXN0IGluIGNhc2UgKi8KCgogICAgICB0aGlzLmNsZWFySW50ZXJ2YWwoKTsgLy8gRG9uJ3Qgc3RhcnQgaWYgbm8gaW50ZXJ2YWwsIG9yIGxlc3MgdGhhbiAyIHNsaWRlcwoKICAgICAgaWYgKHRoaXMuaW50ZXJ2YWwgJiYgdGhpcy5udW1TbGlkZXMgPiAxKSB7CiAgICAgICAgdGhpcy4kX2ludGVydmFsID0gc2V0SW50ZXJ2YWwodGhpcy5uZXh0LCBtYXRoTWF4KDEwMDAsIHRoaXMuaW50ZXJ2YWwpKTsKICAgICAgfQogICAgfSwKICAgIC8vIFJlc3RhcnQgYXV0byByb3RhdGUgc2xpZGVzIHdoZW4gZm9jdXMvaG92ZXIgbGVhdmVzIHRoZSBjYXJvdXNlbAoKICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovCiAgICByZXN0YXJ0OiBmdW5jdGlvbiByZXN0YXJ0KCkgewogICAgICBpZiAoIXRoaXMuJGVsLmNvbnRhaW5zKGdldEFjdGl2ZUVsZW1lbnQoKSkpIHsKICAgICAgICB0aGlzLnN0YXJ0KCk7CiAgICAgIH0KICAgIH0sCiAgICBkb1NsaWRlOiBmdW5jdGlvbiBkb1NsaWRlKHRvLCBmcm9tKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdmFyIGlzQ3ljbGluZyA9IEJvb2xlYW4odGhpcy5pbnRlcnZhbCk7IC8vIERldGVybWluZSBzbGlkaW5nIGRpcmVjdGlvbgoKICAgICAgdmFyIGRpcmVjdGlvbiA9IHRoaXMuY2FsY0RpcmVjdGlvbih0aGlzLmRpcmVjdGlvbiwgZnJvbSwgdG8pOwogICAgICB2YXIgb3ZlcmxheUNsYXNzID0gZGlyZWN0aW9uLm92ZXJsYXlDbGFzczsKICAgICAgdmFyIGRpckNsYXNzID0gZGlyZWN0aW9uLmRpckNsYXNzOyAvLyBEZXRlcm1pbmUgY3VycmVudCBhbmQgbmV4dCBzbGlkZXMKCiAgICAgIHZhciBjdXJyZW50U2xpZGUgPSB0aGlzLnNsaWRlc1tmcm9tXTsKICAgICAgdmFyIG5leHRTbGlkZSA9IHRoaXMuc2xpZGVzW3RvXTsgLy8gRG9uJ3QgZG8gYW55dGhpbmcgaWYgdGhlcmUgYXJlbid0IGFueSBzbGlkZXMgdG8gc2xpZGUgdG8KCiAgICAgIGlmICghY3VycmVudFNsaWRlIHx8ICFuZXh0U2xpZGUpIHsKICAgICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLwogICAgICAgIHJldHVybjsKICAgICAgfSAvLyBTdGFydCBhbmltYXRpbmcKCgogICAgICB0aGlzLmlzU2xpZGluZyA9IHRydWU7CgogICAgICBpZiAoaXNDeWNsaW5nKSB7CiAgICAgICAgdGhpcy5wYXVzZShmYWxzZSk7CiAgICAgIH0KCiAgICAgIHRoaXMuJGVtaXQoRVZFTlRfTkFNRV9TTElESU5HX1NUQVJULCB0byk7IC8vIFVwZGF0ZSB2LW1vZGVsCgogICAgICB0aGlzLiRlbWl0KE1PREVMX0VWRU5UX05BTUUsIHRoaXMuaW5kZXgpOwoKICAgICAgaWYgKHRoaXMubm9BbmltYXRpb24pIHsKICAgICAgICBhZGRDbGFzcyhuZXh0U2xpZGUsICdhY3RpdmUnKTsKICAgICAgICByZW1vdmVDbGFzcyhjdXJyZW50U2xpZGUsICdhY3RpdmUnKTsKICAgICAgICB0aGlzLmlzU2xpZGluZyA9IGZhbHNlOyAvLyBOb3RpZnkgb3Vyc2VsdmVzIHRoYXQgd2UncmUgZG9uZSBzbGlkaW5nIChzbGlkKQoKICAgICAgICB0aGlzLiRuZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gX3RoaXMyLiRlbWl0KEVWRU5UX05BTUVfU0xJRElOR19FTkQsIHRvKTsKICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBhZGRDbGFzcyhuZXh0U2xpZGUsIG92ZXJsYXlDbGFzcyk7IC8vIFRyaWdnZXIgYSByZWZsb3cgb2YgbmV4dCBzbGlkZQoKICAgICAgICByZWZsb3cobmV4dFNsaWRlKTsKICAgICAgICBhZGRDbGFzcyhjdXJyZW50U2xpZGUsIGRpckNsYXNzKTsKICAgICAgICBhZGRDbGFzcyhuZXh0U2xpZGUsIGRpckNsYXNzKTsgLy8gVHJhbnNpdGlvbiBFbmQgaGFuZGxlcgoKICAgICAgICB2YXIgY2FsbGVkID0gZmFsc2U7CiAgICAgICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQ6IGRpZmZpY3VsdCB0byB0ZXN0ICovCgogICAgICAgIHZhciBvbmNlVHJhbnNFbmQgPSBmdW5jdGlvbiBvbmNlVHJhbnNFbmQoKSB7CiAgICAgICAgICBpZiAoY2FsbGVkKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KCiAgICAgICAgICBjYWxsZWQgPSB0cnVlOwogICAgICAgICAgLyogaXN0YW5idWwgaWdub3JlIGlmOiB0cmFuc2l0aW9uIGV2ZW50cyBjYW50IGJlIHRlc3RlZCBpbiBKU0RPTSAqLwoKICAgICAgICAgIGlmIChfdGhpczIudHJhbnNpdGlvbkVuZEV2ZW50KSB7CiAgICAgICAgICAgIHZhciBldmVudHMgPSBfdGhpczIudHJhbnNpdGlvbkVuZEV2ZW50LnNwbGl0KC9ccysvKTsKCiAgICAgICAgICAgIGV2ZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChldmVudCkgewogICAgICAgICAgICAgIHJldHVybiBldmVudE9mZihuZXh0U2xpZGUsIGV2ZW50LCBvbmNlVHJhbnNFbmQsIEVWRU5UX09QVElPTlNfTk9fQ0FQVFVSRSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQoKICAgICAgICAgIF90aGlzMi5jbGVhckFuaW1hdGlvblRpbWVvdXQoKTsKCiAgICAgICAgICByZW1vdmVDbGFzcyhuZXh0U2xpZGUsIGRpckNsYXNzKTsKICAgICAgICAgIHJlbW92ZUNsYXNzKG5leHRTbGlkZSwgb3ZlcmxheUNsYXNzKTsKICAgICAgICAgIGFkZENsYXNzKG5leHRTbGlkZSwgJ2FjdGl2ZScpOwogICAgICAgICAgcmVtb3ZlQ2xhc3MoY3VycmVudFNsaWRlLCAnYWN0aXZlJyk7CiAgICAgICAgICByZW1vdmVDbGFzcyhjdXJyZW50U2xpZGUsIGRpckNsYXNzKTsKICAgICAgICAgIHJlbW92ZUNsYXNzKGN1cnJlbnRTbGlkZSwgb3ZlcmxheUNsYXNzKTsKICAgICAgICAgIHNldEF0dHIoY3VycmVudFNsaWRlLCAnYXJpYS1jdXJyZW50JywgJ2ZhbHNlJyk7CiAgICAgICAgICBzZXRBdHRyKG5leHRTbGlkZSwgJ2FyaWEtY3VycmVudCcsICd0cnVlJyk7CiAgICAgICAgICBzZXRBdHRyKGN1cnJlbnRTbGlkZSwgJ2FyaWEtaGlkZGVuJywgJ3RydWUnKTsKICAgICAgICAgIHNldEF0dHIobmV4dFNsaWRlLCAnYXJpYS1oaWRkZW4nLCAnZmFsc2UnKTsKICAgICAgICAgIF90aGlzMi5pc1NsaWRpbmcgPSBmYWxzZTsKICAgICAgICAgIF90aGlzMi5kaXJlY3Rpb24gPSBudWxsOyAvLyBOb3RpZnkgb3Vyc2VsdmVzIHRoYXQgd2UncmUgZG9uZSBzbGlkaW5nIChzbGlkKQoKICAgICAgICAgIF90aGlzMi4kbmV4dFRpY2soZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gX3RoaXMyLiRlbWl0KEVWRU5UX05BTUVfU0xJRElOR19FTkQsIHRvKTsKICAgICAgICAgIH0pOwogICAgICAgIH07IC8vIFNldCB1cCB0cmFuc2l0aW9uZW5kIGhhbmRsZXIKCiAgICAgICAgLyogaXN0YW5idWwgaWdub3JlIGlmOiB0cmFuc2l0aW9uIGV2ZW50cyBjYW50IGJlIHRlc3RlZCBpbiBKU0RPTSAqLwoKCiAgICAgICAgaWYgKHRoaXMudHJhbnNpdGlvbkVuZEV2ZW50KSB7CiAgICAgICAgICB2YXIgZXZlbnRzID0gdGhpcy50cmFuc2l0aW9uRW5kRXZlbnQuc3BsaXQoL1xzKy8pOwogICAgICAgICAgZXZlbnRzLmZvckVhY2goZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgICAgIHJldHVybiBldmVudE9uKG5leHRTbGlkZSwgZXZlbnQsIG9uY2VUcmFuc0VuZCwgRVZFTlRfT1BUSU9OU19OT19DQVBUVVJFKTsKICAgICAgICAgIH0pOwogICAgICAgIH0gLy8gRmFsbGJhY2sgdG8gc2V0VGltZW91dCgpCgoKICAgICAgICB0aGlzLiRfYW5pbWF0aW9uVGltZW91dCA9IHNldFRpbWVvdXQob25jZVRyYW5zRW5kLCBUUkFOU19EVVJBVElPTik7CiAgICAgIH0KCiAgICAgIGlmIChpc0N5Y2xpbmcpIHsKICAgICAgICB0aGlzLnN0YXJ0KGZhbHNlKTsKICAgICAgfQogICAgfSwKICAgIC8vIFVwZGF0ZSBzbGlkZSBsaXN0CiAgICB1cGRhdGVTbGlkZXM6IGZ1bmN0aW9uIHVwZGF0ZVNsaWRlcygpIHsKICAgICAgdGhpcy5wYXVzZSh0cnVlKTsgLy8gR2V0IGFsbCBzbGlkZXMgYXMgRE9NIGVsZW1lbnRzCgogICAgICB0aGlzLnNsaWRlcyA9IHNlbGVjdEFsbCgnLmNhcm91c2VsLWl0ZW0nLCB0aGlzLiRyZWZzLmlubmVyKTsKICAgICAgdmFyIG51bVNsaWRlcyA9IHRoaXMuc2xpZGVzLmxlbmd0aDsgLy8gS2VlcCBzbGlkZSBudW1iZXIgaW4gcmFuZ2UKCiAgICAgIHZhciBpbmRleCA9IG1hdGhNYXgoMCwgbWF0aE1pbihtYXRoRmxvb3IodGhpcy5pbmRleCksIG51bVNsaWRlcyAtIDEpKTsKICAgICAgdGhpcy5zbGlkZXMuZm9yRWFjaChmdW5jdGlvbiAoc2xpZGUsIGlkeCkgewogICAgICAgIHZhciBuID0gaWR4ICsgMTsKCiAgICAgICAgaWYgKGlkeCA9PT0gaW5kZXgpIHsKICAgICAgICAgIGFkZENsYXNzKHNsaWRlLCAnYWN0aXZlJyk7CiAgICAgICAgICBzZXRBdHRyKHNsaWRlLCAnYXJpYS1jdXJyZW50JywgJ3RydWUnKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmVtb3ZlQ2xhc3Moc2xpZGUsICdhY3RpdmUnKTsKICAgICAgICAgIHNldEF0dHIoc2xpZGUsICdhcmlhLWN1cnJlbnQnLCAnZmFsc2UnKTsKICAgICAgICB9CgogICAgICAgIHNldEF0dHIoc2xpZGUsICdhcmlhLXBvc2luc2V0JywgU3RyaW5nKG4pKTsKICAgICAgICBzZXRBdHRyKHNsaWRlLCAnYXJpYS1zZXRzaXplJywgU3RyaW5nKG51bVNsaWRlcykpOwogICAgICB9KTsgLy8gU2V0IHNsaWRlIGFzIGFjdGl2ZQoKICAgICAgdGhpcy5zZXRTbGlkZShpbmRleCk7CiAgICAgIHRoaXMuc3RhcnQodGhpcy5pc1BhdXNlZCk7CiAgICB9LAogICAgY2FsY0RpcmVjdGlvbjogZnVuY3Rpb24gY2FsY0RpcmVjdGlvbigpIHsKICAgICAgdmFyIGRpcmVjdGlvbiA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogbnVsbDsKICAgICAgdmFyIGN1ckluZGV4ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiAwOwogICAgICB2YXIgbmV4dEluZGV4ID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiAwOwoKICAgICAgaWYgKCFkaXJlY3Rpb24pIHsKICAgICAgICByZXR1cm4gbmV4dEluZGV4ID4gY3VySW5kZXggPyBESVJFQ1RJT04ubmV4dCA6IERJUkVDVElPTi5wcmV2OwogICAgICB9CgogICAgICByZXR1cm4gRElSRUNUSU9OW2RpcmVjdGlvbl07CiAgICB9LAogICAgaGFuZGxlQ2xpY2s6IGZ1bmN0aW9uIGhhbmRsZUNsaWNrKGV2ZW50LCBmbikgewogICAgICB2YXIga2V5Q29kZSA9IGV2ZW50LmtleUNvZGU7CgogICAgICBpZiAoZXZlbnQudHlwZSA9PT0gJ2NsaWNrJyB8fCBrZXlDb2RlID09PSBDT0RFX1NQQUNFIHx8IGtleUNvZGUgPT09IENPREVfRU5URVIpIHsKICAgICAgICBzdG9wRXZlbnQoZXZlbnQpOwogICAgICAgIGZuKCk7CiAgICAgIH0KICAgIH0sCgogICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQ6IEpTRE9NIGRvZXNuJ3Qgc3VwcG9ydCB0b3VjaCBldmVudHMgKi8KICAgIGhhbmRsZVN3aXBlOiBmdW5jdGlvbiBoYW5kbGVTd2lwZSgpIHsKICAgICAgdmFyIGFic0RlbHRhWCA9IG1hdGhBYnModGhpcy50b3VjaERlbHRhWCk7CgogICAgICBpZiAoYWJzRGVsdGFYIDw9IFNXSVBFX1RIUkVTSE9MRCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIGRpcmVjdGlvbiA9IGFic0RlbHRhWCAvIHRoaXMudG91Y2hEZWx0YVg7IC8vIFJlc2V0IHRvdWNoIGRlbHRhIFgKICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3R3YnMvYm9vdHN0cmFwL3B1bGwvMjg1NTgKCiAgICAgIHRoaXMudG91Y2hEZWx0YVggPSAwOwoKICAgICAgaWYgKGRpcmVjdGlvbiA+IDApIHsKICAgICAgICAvLyBTd2lwZSBsZWZ0CiAgICAgICAgdGhpcy5wcmV2KCk7CiAgICAgIH0gZWxzZSBpZiAoZGlyZWN0aW9uIDwgMCkgewogICAgICAgIC8vIFN3aXBlIHJpZ2h0CiAgICAgICAgdGhpcy5uZXh0KCk7CiAgICAgIH0KICAgIH0sCgogICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQ6IEpTRE9NIGRvZXNuJ3Qgc3VwcG9ydCB0b3VjaCBldmVudHMgKi8KICAgIHRvdWNoU3RhcnQ6IGZ1bmN0aW9uIHRvdWNoU3RhcnQoZXZlbnQpIHsKICAgICAgaWYgKEhBU19QT0lOVEVSX0VWRU5UX1NVUFBPUlQgJiYgUG9pbnRlclR5cGVbZXZlbnQucG9pbnRlclR5cGUudG9VcHBlckNhc2UoKV0pIHsKICAgICAgICB0aGlzLnRvdWNoU3RhcnRYID0gZXZlbnQuY2xpZW50WDsKICAgICAgfSBlbHNlIGlmICghSEFTX1BPSU5URVJfRVZFTlRfU1VQUE9SVCkgewogICAgICAgIHRoaXMudG91Y2hTdGFydFggPSBldmVudC50b3VjaGVzWzBdLmNsaWVudFg7CiAgICAgIH0KICAgIH0sCgogICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQ6IEpTRE9NIGRvZXNuJ3Qgc3VwcG9ydCB0b3VjaCBldmVudHMgKi8KICAgIHRvdWNoTW92ZTogZnVuY3Rpb24gdG91Y2hNb3ZlKGV2ZW50KSB7CiAgICAgIC8vIEVuc3VyZSBzd2lwaW5nIHdpdGggb25lIHRvdWNoIGFuZCBub3QgcGluY2hpbmcKICAgICAgaWYgKGV2ZW50LnRvdWNoZXMgJiYgZXZlbnQudG91Y2hlcy5sZW5ndGggPiAxKSB7CiAgICAgICAgdGhpcy50b3VjaERlbHRhWCA9IDA7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy50b3VjaERlbHRhWCA9IGV2ZW50LnRvdWNoZXNbMF0uY2xpZW50WCAtIHRoaXMudG91Y2hTdGFydFg7CiAgICAgIH0KICAgIH0sCgogICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQ6IEpTRE9NIGRvZXNuJ3Qgc3VwcG9ydCB0b3VjaCBldmVudHMgKi8KICAgIHRvdWNoRW5kOiBmdW5jdGlvbiB0b3VjaEVuZChldmVudCkgewogICAgICBpZiAoSEFTX1BPSU5URVJfRVZFTlRfU1VQUE9SVCAmJiBQb2ludGVyVHlwZVtldmVudC5wb2ludGVyVHlwZS50b1VwcGVyQ2FzZSgpXSkgewogICAgICAgIHRoaXMudG91Y2hEZWx0YVggPSBldmVudC5jbGllbnRYIC0gdGhpcy50b3VjaFN0YXJ0WDsKICAgICAgfQoKICAgICAgdGhpcy5oYW5kbGVTd2lwZSgpOyAvLyBJZiBpdCdzIGEgdG91Y2gtZW5hYmxlZCBkZXZpY2UsIG1vdXNlZW50ZXIvbGVhdmUgYXJlIGZpcmVkIGFzCiAgICAgIC8vIHBhcnQgb2YgdGhlIG1vdXNlIGNvbXBhdGliaWxpdHkgZXZlbnRzIG9uIGZpcnN0IHRhcCAtIHRoZSBjYXJvdXNlbAogICAgICAvLyB3b3VsZCBzdG9wIGN5Y2xpbmcgdW50aWwgdXNlciB0YXBwZWQgb3V0IG9mIGl0OwogICAgICAvLyBoZXJlLCB3ZSBsaXN0ZW4gZm9yIHRvdWNoZW5kLCBleHBsaWNpdGx5IHBhdXNlIHRoZSBjYXJvdXNlbAogICAgICAvLyAoYXMgaWYgaXQncyB0aGUgc2Vjb25kIHRpbWUgd2UgdGFwIG9uIGl0LCBtb3VzZWVudGVyIGNvbXBhdCBldmVudAogICAgICAvLyBpcyBOT1QgZmlyZWQpIGFuZCBhZnRlciBhIHRpbWVvdXQgKHRvIGFsbG93IGZvciBtb3VzZSBjb21wYXRpYmlsaXR5CiAgICAgIC8vIGV2ZW50cyB0byBmaXJlKSB3ZSBleHBsaWNpdGx5IHJlc3RhcnQgY3ljbGluZwoKICAgICAgdGhpcy5wYXVzZShmYWxzZSk7CiAgICAgIHRoaXMuY2xlYXJUb3VjaFRpbWVvdXQoKTsKICAgICAgdGhpcy4kX3RvdWNoVGltZW91dCA9IHNldFRpbWVvdXQodGhpcy5zdGFydCwgVE9VQ0hfRVZFTlRfQ09NUEFUX1dBSVQgKyBtYXRoTWF4KDEwMDAsIHRoaXMuaW50ZXJ2YWwpKTsKICAgIH0KICB9LAogIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKGgpIHsKICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgIHZhciBpbmRpY2F0b3JzID0gdGhpcy5pbmRpY2F0b3JzLAogICAgICAgIGJhY2tncm91bmQgPSB0aGlzLmJhY2tncm91bmQsCiAgICAgICAgbm9BbmltYXRpb24gPSB0aGlzLm5vQW5pbWF0aW9uLAogICAgICAgIG5vSG92ZXJQYXVzZSA9IHRoaXMubm9Ib3ZlclBhdXNlLAogICAgICAgIG5vVG91Y2ggPSB0aGlzLm5vVG91Y2gsCiAgICAgICAgaW5kZXggPSB0aGlzLmluZGV4LAogICAgICAgIGlzU2xpZGluZyA9IHRoaXMuaXNTbGlkaW5nLAogICAgICAgIHBhdXNlID0gdGhpcy5wYXVzZSwKICAgICAgICByZXN0YXJ0ID0gdGhpcy5yZXN0YXJ0LAogICAgICAgIHRvdWNoU3RhcnQgPSB0aGlzLnRvdWNoU3RhcnQsCiAgICAgICAgdG91Y2hFbmQgPSB0aGlzLnRvdWNoRW5kOwogICAgdmFyIGlkSW5uZXIgPSB0aGlzLnNhZmVJZCgnX19CVl9pbm5lcl8nKTsgLy8gV3JhcHBlciBmb3Igc2xpZGVzCgogICAgdmFyICRpbm5lciA9IGgoJ2RpdicsIHsKICAgICAgc3RhdGljQ2xhc3M6ICdjYXJvdXNlbC1pbm5lcicsCiAgICAgIGF0dHJzOiB7CiAgICAgICAgaWQ6IGlkSW5uZXIsCiAgICAgICAgcm9sZTogJ2xpc3QnCiAgICAgIH0sCiAgICAgIHJlZjogJ2lubmVyJwogICAgfSwgW3RoaXMubm9ybWFsaXplU2xvdCgpXSk7IC8vIFByZXYgYW5kIG5leHQgY29udHJvbHMKCiAgICB2YXIgJGNvbnRyb2xzID0gaCgpOwoKICAgIGlmICh0aGlzLmNvbnRyb2xzKSB7CiAgICAgIHZhciBtYWtlQ29udHJvbCA9IGZ1bmN0aW9uIG1ha2VDb250cm9sKGRpcmVjdGlvbiwgbGFiZWwsIGhhbmRsZXIpIHsKICAgICAgICB2YXIgaGFuZGxlcldyYXBwZXIgPSBmdW5jdGlvbiBoYW5kbGVyV3JhcHBlcihldmVudCkgewogICAgICAgICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi8KICAgICAgICAgIGlmICghaXNTbGlkaW5nKSB7CiAgICAgICAgICAgIF90aGlzMy5oYW5kbGVDbGljayhldmVudCwgaGFuZGxlcik7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzdG9wRXZlbnQoZXZlbnQsIHsKICAgICAgICAgICAgICBwcm9wYWdhdGlvbjogZmFsc2UKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfTsKCiAgICAgICAgcmV0dXJuIGgoJ2EnLCB7CiAgICAgICAgICBzdGF0aWNDbGFzczogImNhcm91c2VsLWNvbnRyb2wtIi5jb25jYXQoZGlyZWN0aW9uKSwKICAgICAgICAgIGF0dHJzOiB7CiAgICAgICAgICAgIGhyZWY6ICcjJywKICAgICAgICAgICAgcm9sZTogJ2J1dHRvbicsCiAgICAgICAgICAgICdhcmlhLWNvbnRyb2xzJzogaWRJbm5lciwKICAgICAgICAgICAgJ2FyaWEtZGlzYWJsZWQnOiBpc1NsaWRpbmcgPyAndHJ1ZScgOiBudWxsCiAgICAgICAgICB9LAogICAgICAgICAgb246IHsKICAgICAgICAgICAgY2xpY2s6IGhhbmRsZXJXcmFwcGVyLAogICAgICAgICAgICBrZXlkb3duOiBoYW5kbGVyV3JhcHBlcgogICAgICAgICAgfQogICAgICAgIH0sIFtoKCdzcGFuJywgewogICAgICAgICAgc3RhdGljQ2xhc3M6ICJjYXJvdXNlbC1jb250cm9sLSIuY29uY2F0KGRpcmVjdGlvbiwgIi1pY29uIiksCiAgICAgICAgICBhdHRyczogewogICAgICAgICAgICAnYXJpYS1oaWRkZW4nOiAndHJ1ZScKICAgICAgICAgIH0KICAgICAgICB9KSwgaCgnc3BhbicsIHsKICAgICAgICAgIGNsYXNzOiAnc3Itb25seScKICAgICAgICB9LCBbbGFiZWxdKV0pOwogICAgICB9OwoKICAgICAgJGNvbnRyb2xzID0gW21ha2VDb250cm9sKCdwcmV2JywgdGhpcy5sYWJlbFByZXYsIHRoaXMucHJldiksIG1ha2VDb250cm9sKCduZXh0JywgdGhpcy5sYWJlbE5leHQsIHRoaXMubmV4dCldOwogICAgfSAvLyBJbmRpY2F0b3JzCgoKICAgIHZhciAkaW5kaWNhdG9ycyA9IGgoJ29sJywgewogICAgICBzdGF0aWNDbGFzczogJ2Nhcm91c2VsLWluZGljYXRvcnMnLAogICAgICBkaXJlY3RpdmVzOiBbewogICAgICAgIG5hbWU6ICdzaG93JywKICAgICAgICB2YWx1ZTogaW5kaWNhdG9ycwogICAgICB9XSwKICAgICAgYXR0cnM6IHsKICAgICAgICBpZDogdGhpcy5zYWZlSWQoJ19fQlZfaW5kaWNhdG9yc18nKSwKICAgICAgICAnYXJpYS1oaWRkZW4nOiBpbmRpY2F0b3JzID8gJ2ZhbHNlJyA6ICd0cnVlJywKICAgICAgICAnYXJpYS1sYWJlbCc6IHRoaXMubGFiZWxJbmRpY2F0b3JzLAogICAgICAgICdhcmlhLW93bnMnOiBpZElubmVyCiAgICAgIH0KICAgIH0sIHRoaXMuc2xpZGVzLm1hcChmdW5jdGlvbiAoc2xpZGUsIGkpIHsKICAgICAgdmFyIGhhbmRsZXIgPSBmdW5jdGlvbiBoYW5kbGVyKGV2ZW50KSB7CiAgICAgICAgX3RoaXMzLmhhbmRsZUNsaWNrKGV2ZW50LCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpczMuc2V0U2xpZGUoaSk7CiAgICAgICAgfSk7CiAgICAgIH07CgogICAgICByZXR1cm4gaCgnbGknLCB7CiAgICAgICAgY2xhc3M6IHsKICAgICAgICAgIGFjdGl2ZTogaSA9PT0gaW5kZXgKICAgICAgICB9LAogICAgICAgIGF0dHJzOiB7CiAgICAgICAgICByb2xlOiAnYnV0dG9uJywKICAgICAgICAgIGlkOiBfdGhpczMuc2FmZUlkKCJfX0JWX2luZGljYXRvcl8iLmNvbmNhdChpICsgMSwgIl8iKSksCiAgICAgICAgICB0YWJpbmRleDogaW5kaWNhdG9ycyA/ICcwJyA6ICctMScsCiAgICAgICAgICAnYXJpYS1jdXJyZW50JzogaSA9PT0gaW5kZXggPyAndHJ1ZScgOiAnZmFsc2UnLAogICAgICAgICAgJ2FyaWEtbGFiZWwnOiAiIi5jb25jYXQoX3RoaXMzLmxhYmVsR290b1NsaWRlLCAiICIpLmNvbmNhdChpICsgMSksCiAgICAgICAgICAnYXJpYS1kZXNjcmliZWRieSc6IHNsaWRlLmlkIHx8IG51bGwsCiAgICAgICAgICAnYXJpYS1jb250cm9scyc6IGlkSW5uZXIKICAgICAgICB9LAogICAgICAgIG9uOiB7CiAgICAgICAgICBjbGljazogaGFuZGxlciwKICAgICAgICAgIGtleWRvd246IGhhbmRsZXIKICAgICAgICB9LAogICAgICAgIGtleTogInNsaWRlXyIuY29uY2F0KGkpCiAgICAgIH0pOwogICAgfSkpOwogICAgdmFyIG9uID0gewogICAgICBtb3VzZWVudGVyOiBub0hvdmVyUGF1c2UgPyBub29wIDogcGF1c2UsCiAgICAgIG1vdXNlbGVhdmU6IG5vSG92ZXJQYXVzZSA/IG5vb3AgOiByZXN0YXJ0LAogICAgICBmb2N1c2luOiBwYXVzZSwKICAgICAgZm9jdXNvdXQ6IHJlc3RhcnQsCiAgICAgIGtleWRvd246IGZ1bmN0aW9uIGtleWRvd24oZXZlbnQpIHsKICAgICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLwogICAgICAgIGlmICgvaW5wdXR8dGV4dGFyZWEvaS50ZXN0KGV2ZW50LnRhcmdldC50YWdOYW1lKSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgdmFyIGtleUNvZGUgPSBldmVudC5rZXlDb2RlOwoKICAgICAgICBpZiAoa2V5Q29kZSA9PT0gQ09ERV9MRUZUIHx8IGtleUNvZGUgPT09IENPREVfUklHSFQpIHsKICAgICAgICAgIHN0b3BFdmVudChldmVudCk7CgogICAgICAgICAgX3RoaXMzW2tleUNvZGUgPT09IENPREVfTEVGVCA/ICdwcmV2JyA6ICduZXh0J10oKTsKICAgICAgICB9CiAgICAgIH0KICAgIH07IC8vIFRvdWNoIHN1cHBvcnQgZXZlbnQgaGFuZGxlcnMgZm9yIGVudmlyb25tZW50CgogICAgaWYgKEhBU19UT1VDSF9TVVBQT1JUICYmICFub1RvdWNoKSB7CiAgICAgIC8vIEF0dGFjaCBhcHByb3ByaWF0ZSBsaXN0ZW5lcnMgKHByZXBlbmQgZXZlbnQgbmFtZSB3aXRoICcmJyBmb3IgcGFzc2l2ZSBtb2RlKQoKICAgICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQ6IEpTRE9NIGRvZXNuJ3Qgc3VwcG9ydCB0b3VjaCBldmVudHMgKi8KICAgICAgaWYgKEhBU19QT0lOVEVSX0VWRU5UX1NVUFBPUlQpIHsKICAgICAgICBvblsnJnBvaW50ZXJkb3duJ10gPSB0b3VjaFN0YXJ0OwogICAgICAgIG9uWycmcG9pbnRlcnVwJ10gPSB0b3VjaEVuZDsKICAgICAgfSBlbHNlIHsKICAgICAgICBvblsnJnRvdWNoc3RhcnQnXSA9IHRvdWNoU3RhcnQ7CiAgICAgICAgb25bJyZ0b3VjaG1vdmUnXSA9IHRoaXMudG91Y2hNb3ZlOwogICAgICAgIG9uWycmdG91Y2hlbmQnXSA9IHRvdWNoRW5kOwogICAgICB9CiAgICB9IC8vIFJldHVybiB0aGUgY2Fyb3VzZWwKCgogICAgcmV0dXJuIGgoJ2RpdicsIHsKICAgICAgc3RhdGljQ2xhc3M6ICdjYXJvdXNlbCcsCiAgICAgIGNsYXNzOiB7CiAgICAgICAgc2xpZGU6ICFub0FuaW1hdGlvbiwKICAgICAgICAnY2Fyb3VzZWwtZmFkZSc6ICFub0FuaW1hdGlvbiAmJiB0aGlzLmZhZGUsCiAgICAgICAgJ3BvaW50ZXItZXZlbnQnOiBIQVNfVE9VQ0hfU1VQUE9SVCAmJiBIQVNfUE9JTlRFUl9FVkVOVF9TVVBQT1JUICYmICFub1RvdWNoCiAgICAgIH0sCiAgICAgIHN0eWxlOiB7CiAgICAgICAgYmFja2dyb3VuZDogYmFja2dyb3VuZAogICAgICB9LAogICAgICBhdHRyczogewogICAgICAgIHJvbGU6ICdyZWdpb24nLAogICAgICAgIGlkOiB0aGlzLnNhZmVJZCgpLAogICAgICAgICdhcmlhLWJ1c3knOiBpc1NsaWRpbmcgPyAndHJ1ZScgOiAnZmFsc2UnCiAgICAgIH0sCiAgICAgIG9uOiBvbgogICAgfSwgWyRpbm5lciwgJGNvbnRyb2xzLCAkaW5kaWNhdG9yc10pOwogIH0KfSk7"},null]}