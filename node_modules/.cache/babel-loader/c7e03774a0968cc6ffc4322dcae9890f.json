{"remainingRequest":"/media/ernst/63bce43c-5e51-4bf1-a611-3afdf32ac6f6/VueJS/IPTV-Tools/node_modules/thread-loader/dist/cjs.js!/media/ernst/63bce43c-5e51-4bf1-a611-3afdf32ac6f6/VueJS/IPTV-Tools/node_modules/babel-loader/lib/index.js!/media/ernst/63bce43c-5e51-4bf1-a611-3afdf32ac6f6/VueJS/IPTV-Tools/node_modules/vue2-perfect-scrollbar/dist/vue2-perfect-scrollbar.umd.js","dependencies":[{"path":"/media/ernst/63bce43c-5e51-4bf1-a611-3afdf32ac6f6/VueJS/IPTV-Tools/node_modules/vue2-perfect-scrollbar/dist/vue2-perfect-scrollbar.umd.js","mtime":499162500000},{"path":"/media/ernst/63bce43c-5e51-4bf1-a611-3afdf32ac6f6/VueJS/IPTV-Tools/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/media/ernst/63bce43c-5e51-4bf1-a611-3afdf32ac6f6/VueJS/IPTV-Tools/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/media/ernst/63bce43c-5e51-4bf1-a611-3afdf32ac6f6/VueJS/IPTV-Tools/node_modules/babel-loader/lib/index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF90eXBlb2YgPSByZXF1aXJlKCIvbWVkaWEvZXJuc3QvNjNiY2U0M2MtNWU1MS00YmYxLWE2MTEtM2FmZGYzMmFjNmY2L1Z1ZUpTL0lQVFYtVG9vbHMvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvdHlwZW9mIikuZGVmYXVsdDsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3Qua2V5cy5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNwbGljZS5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5tYXRjaC5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmpvaW4uanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuc3BsaXQuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIik7CgooZnVuY3Rpb24gKGdsb2JhbCwgZmFjdG9yeSkgewogICh0eXBlb2YgZXhwb3J0cyA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2YoZXhwb3J0cykpID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyA/IGZhY3RvcnkoZXhwb3J0cykgOiB0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQgPyBkZWZpbmUoWydleHBvcnRzJ10sIGZhY3RvcnkpIDogZmFjdG9yeShnbG9iYWwuVnVlMlBlcmZlY3RTY3JvbGxiYXIgPSB7fSk7Cn0pKHRoaXMsIGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgJ3VzZSBzdHJpY3QnOwogIC8qIQogICAqIHBlcmZlY3Qtc2Nyb2xsYmFyIHYxLjUuMAogICAqIENvcHlyaWdodCAyMDIwIEh5dW5qZSBKdW4sIE1EQm9vdHN0cmFwIGFuZCBDb250cmlidXRvcnMKICAgKiBMaWNlbnNlZCB1bmRlciBNSVQKICAgKi8KCiAgZnVuY3Rpb24gZ2V0KGVsZW1lbnQpIHsKICAgIHJldHVybiBnZXRDb21wdXRlZFN0eWxlKGVsZW1lbnQpOwogIH0KCiAgZnVuY3Rpb24gc2V0KGVsZW1lbnQsIG9iaikgewogICAgZm9yICh2YXIga2V5IGluIG9iaikgewogICAgICB2YXIgdmFsID0gb2JqW2tleV07CgogICAgICBpZiAodHlwZW9mIHZhbCA9PT0gJ251bWJlcicpIHsKICAgICAgICB2YWwgPSB2YWwgKyAicHgiOwogICAgICB9CgogICAgICBlbGVtZW50LnN0eWxlW2tleV0gPSB2YWw7CiAgICB9CgogICAgcmV0dXJuIGVsZW1lbnQ7CiAgfQoKICBmdW5jdGlvbiBkaXYoY2xhc3NOYW1lKSB7CiAgICB2YXIgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICBkaXYuY2xhc3NOYW1lID0gY2xhc3NOYW1lOwogICAgcmV0dXJuIGRpdjsKICB9CgogIHZhciBlbE1hdGNoZXMgPSB0eXBlb2YgRWxlbWVudCAhPT0gJ3VuZGVmaW5lZCcgJiYgKEVsZW1lbnQucHJvdG90eXBlLm1hdGNoZXMgfHwgRWxlbWVudC5wcm90b3R5cGUud2Via2l0TWF0Y2hlc1NlbGVjdG9yIHx8IEVsZW1lbnQucHJvdG90eXBlLm1vek1hdGNoZXNTZWxlY3RvciB8fCBFbGVtZW50LnByb3RvdHlwZS5tc01hdGNoZXNTZWxlY3Rvcik7CgogIGZ1bmN0aW9uIG1hdGNoZXMoZWxlbWVudCwgcXVlcnkpIHsKICAgIGlmICghZWxNYXRjaGVzKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignTm8gZWxlbWVudCBtYXRjaGluZyBtZXRob2Qgc3VwcG9ydGVkJyk7CiAgICB9CgogICAgcmV0dXJuIGVsTWF0Y2hlcy5jYWxsKGVsZW1lbnQsIHF1ZXJ5KTsKICB9CgogIGZ1bmN0aW9uIHJlbW92ZShlbGVtZW50KSB7CiAgICBpZiAoZWxlbWVudC5yZW1vdmUpIHsKICAgICAgZWxlbWVudC5yZW1vdmUoKTsKICAgIH0gZWxzZSB7CiAgICAgIGlmIChlbGVtZW50LnBhcmVudE5vZGUpIHsKICAgICAgICBlbGVtZW50LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZWxlbWVudCk7CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIHF1ZXJ5Q2hpbGRyZW4oZWxlbWVudCwgc2VsZWN0b3IpIHsKICAgIHJldHVybiBBcnJheS5wcm90b3R5cGUuZmlsdGVyLmNhbGwoZWxlbWVudC5jaGlsZHJlbiwgZnVuY3Rpb24gKGNoaWxkKSB7CiAgICAgIHJldHVybiBtYXRjaGVzKGNoaWxkLCBzZWxlY3Rvcik7CiAgICB9KTsKICB9CgogIHZhciBjbHMgPSB7CiAgICBtYWluOiAncHMnLAogICAgcnRsOiAncHNfX3J0bCcsCiAgICBlbGVtZW50OiB7CiAgICAgIHRodW1iOiBmdW5jdGlvbiB0aHVtYih4KSB7CiAgICAgICAgcmV0dXJuICJwc19fdGh1bWItIiArIHg7CiAgICAgIH0sCiAgICAgIHJhaWw6IGZ1bmN0aW9uIHJhaWwoeCkgewogICAgICAgIHJldHVybiAicHNfX3JhaWwtIiArIHg7CiAgICAgIH0sCiAgICAgIGNvbnN1bWluZzogJ3BzX19jaGlsZC0tY29uc3VtZScKICAgIH0sCiAgICBzdGF0ZTogewogICAgICBmb2N1czogJ3BzLS1mb2N1cycsCiAgICAgIGNsaWNraW5nOiAncHMtLWNsaWNraW5nJywKICAgICAgYWN0aXZlOiBmdW5jdGlvbiBhY3RpdmUoeCkgewogICAgICAgIHJldHVybiAicHMtLWFjdGl2ZS0iICsgeDsKICAgICAgfSwKICAgICAgc2Nyb2xsaW5nOiBmdW5jdGlvbiBzY3JvbGxpbmcoeCkgewogICAgICAgIHJldHVybiAicHMtLXNjcm9sbGluZy0iICsgeDsKICAgICAgfQogICAgfQogIH07CiAgLyoKICAgKiBIZWxwZXIgbWV0aG9kcwogICAqLwoKICB2YXIgc2Nyb2xsaW5nQ2xhc3NUaW1lb3V0ID0gewogICAgeDogbnVsbCwKICAgIHk6IG51bGwKICB9OwoKICBmdW5jdGlvbiBhZGRTY3JvbGxpbmdDbGFzcyhpLCB4KSB7CiAgICB2YXIgY2xhc3NMaXN0ID0gaS5lbGVtZW50LmNsYXNzTGlzdDsKICAgIHZhciBjbGFzc05hbWUgPSBjbHMuc3RhdGUuc2Nyb2xsaW5nKHgpOwoKICAgIGlmIChjbGFzc0xpc3QuY29udGFpbnMoY2xhc3NOYW1lKSkgewogICAgICBjbGVhclRpbWVvdXQoc2Nyb2xsaW5nQ2xhc3NUaW1lb3V0W3hdKTsKICAgIH0gZWxzZSB7CiAgICAgIGNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lKTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIHJlbW92ZVNjcm9sbGluZ0NsYXNzKGksIHgpIHsKICAgIHNjcm9sbGluZ0NsYXNzVGltZW91dFt4XSA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gaS5pc0FsaXZlICYmIGkuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGNscy5zdGF0ZS5zY3JvbGxpbmcoeCkpOwogICAgfSwgaS5zZXR0aW5ncy5zY3JvbGxpbmdUaHJlc2hvbGQpOwogIH0KCiAgZnVuY3Rpb24gc2V0U2Nyb2xsaW5nQ2xhc3NJbnN0YW50bHkoaSwgeCkgewogICAgYWRkU2Nyb2xsaW5nQ2xhc3MoaSwgeCk7CiAgICByZW1vdmVTY3JvbGxpbmdDbGFzcyhpLCB4KTsKICB9CgogIHZhciBFdmVudEVsZW1lbnQgPSBmdW5jdGlvbiBFdmVudEVsZW1lbnQoZWxlbWVudCkgewogICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDsKICAgIHRoaXMuaGFuZGxlcnMgPSB7fTsKICB9OwoKICB2YXIgcHJvdG90eXBlQWNjZXNzb3JzID0gewogICAgaXNFbXB0eTogewogICAgICBjb25maWd1cmFibGU6IHRydWUKICAgIH0KICB9OwoKICBFdmVudEVsZW1lbnQucHJvdG90eXBlLmJpbmQgPSBmdW5jdGlvbiBiaW5kKGV2ZW50TmFtZSwgaGFuZGxlcikgewogICAgaWYgKHR5cGVvZiB0aGlzLmhhbmRsZXJzW2V2ZW50TmFtZV0gPT09ICd1bmRlZmluZWQnKSB7CiAgICAgIHRoaXMuaGFuZGxlcnNbZXZlbnROYW1lXSA9IFtdOwogICAgfQoKICAgIHRoaXMuaGFuZGxlcnNbZXZlbnROYW1lXS5wdXNoKGhhbmRsZXIpOwogICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBoYW5kbGVyLCBmYWxzZSk7CiAgfTsKCiAgRXZlbnRFbGVtZW50LnByb3RvdHlwZS51bmJpbmQgPSBmdW5jdGlvbiB1bmJpbmQoZXZlbnROYW1lLCB0YXJnZXQpIHsKICAgIHZhciB0aGlzJDEgPSB0aGlzOwogICAgdGhpcy5oYW5kbGVyc1tldmVudE5hbWVdID0gdGhpcy5oYW5kbGVyc1tldmVudE5hbWVdLmZpbHRlcihmdW5jdGlvbiAoaGFuZGxlcikgewogICAgICBpZiAodGFyZ2V0ICYmIGhhbmRsZXIgIT09IHRhcmdldCkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICB0aGlzJDEuZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgaGFuZGxlciwgZmFsc2UpOwogICAgICByZXR1cm4gZmFsc2U7CiAgICB9KTsKICB9OwoKICBFdmVudEVsZW1lbnQucHJvdG90eXBlLnVuYmluZEFsbCA9IGZ1bmN0aW9uIHVuYmluZEFsbCgpIHsKICAgIHZhciB0aGlzJDEgPSB0aGlzOwoKICAgIGZvciAodmFyIG5hbWUgaW4gdGhpcyQxLmhhbmRsZXJzKSB7CiAgICAgIHRoaXMkMS51bmJpbmQobmFtZSk7CiAgICB9CiAgfTsKCiAgcHJvdG90eXBlQWNjZXNzb3JzLmlzRW1wdHkuZ2V0ID0gZnVuY3Rpb24gKCkgewogICAgdmFyIHRoaXMkMSA9IHRoaXM7CiAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy5oYW5kbGVycykuZXZlcnkoZnVuY3Rpb24gKGtleSkgewogICAgICByZXR1cm4gdGhpcyQxLmhhbmRsZXJzW2tleV0ubGVuZ3RoID09PSAwOwogICAgfSk7CiAgfTsKCiAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoRXZlbnRFbGVtZW50LnByb3RvdHlwZSwgcHJvdG90eXBlQWNjZXNzb3JzKTsKCiAgdmFyIEV2ZW50TWFuYWdlciA9IGZ1bmN0aW9uIEV2ZW50TWFuYWdlcigpIHsKICAgIHRoaXMuZXZlbnRFbGVtZW50cyA9IFtdOwogIH07CgogIEV2ZW50TWFuYWdlci5wcm90b3R5cGUuZXZlbnRFbGVtZW50ID0gZnVuY3Rpb24gZXZlbnRFbGVtZW50KGVsZW1lbnQpIHsKICAgIHZhciBlZSA9IHRoaXMuZXZlbnRFbGVtZW50cy5maWx0ZXIoZnVuY3Rpb24gKGVlKSB7CiAgICAgIHJldHVybiBlZS5lbGVtZW50ID09PSBlbGVtZW50OwogICAgfSlbMF07CgogICAgaWYgKCFlZSkgewogICAgICBlZSA9IG5ldyBFdmVudEVsZW1lbnQoZWxlbWVudCk7CiAgICAgIHRoaXMuZXZlbnRFbGVtZW50cy5wdXNoKGVlKTsKICAgIH0KCiAgICByZXR1cm4gZWU7CiAgfTsKCiAgRXZlbnRNYW5hZ2VyLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gYmluZChlbGVtZW50LCBldmVudE5hbWUsIGhhbmRsZXIpIHsKICAgIHRoaXMuZXZlbnRFbGVtZW50KGVsZW1lbnQpLmJpbmQoZXZlbnROYW1lLCBoYW5kbGVyKTsKICB9OwoKICBFdmVudE1hbmFnZXIucHJvdG90eXBlLnVuYmluZCA9IGZ1bmN0aW9uIHVuYmluZChlbGVtZW50LCBldmVudE5hbWUsIGhhbmRsZXIpIHsKICAgIHZhciBlZSA9IHRoaXMuZXZlbnRFbGVtZW50KGVsZW1lbnQpOwogICAgZWUudW5iaW5kKGV2ZW50TmFtZSwgaGFuZGxlcik7CgogICAgaWYgKGVlLmlzRW1wdHkpIHsKICAgICAgLy8gcmVtb3ZlCiAgICAgIHRoaXMuZXZlbnRFbGVtZW50cy5zcGxpY2UodGhpcy5ldmVudEVsZW1lbnRzLmluZGV4T2YoZWUpLCAxKTsKICAgIH0KICB9OwoKICBFdmVudE1hbmFnZXIucHJvdG90eXBlLnVuYmluZEFsbCA9IGZ1bmN0aW9uIHVuYmluZEFsbCgpIHsKICAgIHRoaXMuZXZlbnRFbGVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7CiAgICAgIHJldHVybiBlLnVuYmluZEFsbCgpOwogICAgfSk7CiAgICB0aGlzLmV2ZW50RWxlbWVudHMgPSBbXTsKICB9OwoKICBFdmVudE1hbmFnZXIucHJvdG90eXBlLm9uY2UgPSBmdW5jdGlvbiBvbmNlKGVsZW1lbnQsIGV2ZW50TmFtZSwgaGFuZGxlcikgewogICAgdmFyIGVlID0gdGhpcy5ldmVudEVsZW1lbnQoZWxlbWVudCk7CgogICAgdmFyIG9uY2VIYW5kbGVyID0gZnVuY3Rpb24gb25jZUhhbmRsZXIoZXZ0KSB7CiAgICAgIGVlLnVuYmluZChldmVudE5hbWUsIG9uY2VIYW5kbGVyKTsKICAgICAgaGFuZGxlcihldnQpOwogICAgfTsKCiAgICBlZS5iaW5kKGV2ZW50TmFtZSwgb25jZUhhbmRsZXIpOwogIH07CgogIGZ1bmN0aW9uIGNyZWF0ZUV2ZW50KG5hbWUpIHsKICAgIGlmICh0eXBlb2Ygd2luZG93LkN1c3RvbUV2ZW50ID09PSAnZnVuY3Rpb24nKSB7CiAgICAgIHJldHVybiBuZXcgQ3VzdG9tRXZlbnQobmFtZSk7CiAgICB9IGVsc2UgewogICAgICB2YXIgZXZ0ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0N1c3RvbUV2ZW50Jyk7CiAgICAgIGV2dC5pbml0Q3VzdG9tRXZlbnQobmFtZSwgZmFsc2UsIGZhbHNlLCB1bmRlZmluZWQpOwogICAgICByZXR1cm4gZXZ0OwogICAgfQogIH0KCiAgZnVuY3Rpb24gcHJvY2Vzc1Njcm9sbERpZmYoaSwgYXhpcywgZGlmZiwgdXNlU2Nyb2xsaW5nQ2xhc3MsIGZvcmNlRmlyZVJlYWNoRXZlbnQpIHsKICAgIGlmICh1c2VTY3JvbGxpbmdDbGFzcyA9PT0gdm9pZCAwKSB7CiAgICAgIHVzZVNjcm9sbGluZ0NsYXNzID0gdHJ1ZTsKICAgIH0KCiAgICBpZiAoZm9yY2VGaXJlUmVhY2hFdmVudCA9PT0gdm9pZCAwKSB7CiAgICAgIGZvcmNlRmlyZVJlYWNoRXZlbnQgPSBmYWxzZTsKICAgIH0KCiAgICB2YXIgZmllbGRzOwoKICAgIGlmIChheGlzID09PSAndG9wJykgewogICAgICBmaWVsZHMgPSBbJ2NvbnRlbnRIZWlnaHQnLCAnY29udGFpbmVySGVpZ2h0JywgJ3Njcm9sbFRvcCcsICd5JywgJ3VwJywgJ2Rvd24nXTsKICAgIH0gZWxzZSBpZiAoYXhpcyA9PT0gJ2xlZnQnKSB7CiAgICAgIGZpZWxkcyA9IFsnY29udGVudFdpZHRoJywgJ2NvbnRhaW5lcldpZHRoJywgJ3Njcm9sbExlZnQnLCAneCcsICdsZWZ0JywgJ3JpZ2h0J107CiAgICB9IGVsc2UgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ0EgcHJvcGVyIGF4aXMgc2hvdWxkIGJlIHByb3ZpZGVkJyk7CiAgICB9CgogICAgcHJvY2Vzc1Njcm9sbERpZmYkMShpLCBkaWZmLCBmaWVsZHMsIHVzZVNjcm9sbGluZ0NsYXNzLCBmb3JjZUZpcmVSZWFjaEV2ZW50KTsKICB9CgogIGZ1bmN0aW9uIHByb2Nlc3NTY3JvbGxEaWZmJDEoaSwgZGlmZiwgcmVmLCB1c2VTY3JvbGxpbmdDbGFzcywgZm9yY2VGaXJlUmVhY2hFdmVudCkgewogICAgdmFyIGNvbnRlbnRIZWlnaHQgPSByZWZbMF07CiAgICB2YXIgY29udGFpbmVySGVpZ2h0ID0gcmVmWzFdOwogICAgdmFyIHNjcm9sbFRvcCA9IHJlZlsyXTsKICAgIHZhciB5ID0gcmVmWzNdOwogICAgdmFyIHVwID0gcmVmWzRdOwogICAgdmFyIGRvd24gPSByZWZbNV07CgogICAgaWYgKHVzZVNjcm9sbGluZ0NsYXNzID09PSB2b2lkIDApIHsKICAgICAgdXNlU2Nyb2xsaW5nQ2xhc3MgPSB0cnVlOwogICAgfQoKICAgIGlmIChmb3JjZUZpcmVSZWFjaEV2ZW50ID09PSB2b2lkIDApIHsKICAgICAgZm9yY2VGaXJlUmVhY2hFdmVudCA9IGZhbHNlOwogICAgfQoKICAgIHZhciBlbGVtZW50ID0gaS5lbGVtZW50OyAvLyByZXNldCByZWFjaAoKICAgIGkucmVhY2hbeV0gPSBudWxsOyAvLyAxIGZvciBzdWJwaXhlbCByb3VuZGluZwoKICAgIGlmIChlbGVtZW50W3Njcm9sbFRvcF0gPCAxKSB7CiAgICAgIGkucmVhY2hbeV0gPSAnc3RhcnQnOwogICAgfSAvLyAxIGZvciBzdWJwaXhlbCByb3VuZGluZwoKCiAgICBpZiAoZWxlbWVudFtzY3JvbGxUb3BdID4gaVtjb250ZW50SGVpZ2h0XSAtIGlbY29udGFpbmVySGVpZ2h0XSAtIDEpIHsKICAgICAgaS5yZWFjaFt5XSA9ICdlbmQnOwogICAgfQoKICAgIGlmIChkaWZmKSB7CiAgICAgIGVsZW1lbnQuZGlzcGF0Y2hFdmVudChjcmVhdGVFdmVudCgicHMtc2Nyb2xsLSIgKyB5KSk7CgogICAgICBpZiAoZGlmZiA8IDApIHsKICAgICAgICBlbGVtZW50LmRpc3BhdGNoRXZlbnQoY3JlYXRlRXZlbnQoInBzLXNjcm9sbC0iICsgdXApKTsKICAgICAgfSBlbHNlIGlmIChkaWZmID4gMCkgewogICAgICAgIGVsZW1lbnQuZGlzcGF0Y2hFdmVudChjcmVhdGVFdmVudCgicHMtc2Nyb2xsLSIgKyBkb3duKSk7CiAgICAgIH0KCiAgICAgIGlmICh1c2VTY3JvbGxpbmdDbGFzcykgewogICAgICAgIHNldFNjcm9sbGluZ0NsYXNzSW5zdGFudGx5KGksIHkpOwogICAgICB9CiAgICB9CgogICAgaWYgKGkucmVhY2hbeV0gJiYgKGRpZmYgfHwgZm9yY2VGaXJlUmVhY2hFdmVudCkpIHsKICAgICAgZWxlbWVudC5kaXNwYXRjaEV2ZW50KGNyZWF0ZUV2ZW50KCJwcy0iICsgeSArICItcmVhY2gtIiArIGkucmVhY2hbeV0pKTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIHRvSW50KHgpIHsKICAgIHJldHVybiBwYXJzZUludCh4LCAxMCkgfHwgMDsKICB9CgogIGZ1bmN0aW9uIGlzRWRpdGFibGUoZWwpIHsKICAgIHJldHVybiBtYXRjaGVzKGVsLCAnaW5wdXQsW2NvbnRlbnRlZGl0YWJsZV0nKSB8fCBtYXRjaGVzKGVsLCAnc2VsZWN0LFtjb250ZW50ZWRpdGFibGVdJykgfHwgbWF0Y2hlcyhlbCwgJ3RleHRhcmVhLFtjb250ZW50ZWRpdGFibGVdJykgfHwgbWF0Y2hlcyhlbCwgJ2J1dHRvbixbY29udGVudGVkaXRhYmxlXScpOwogIH0KCiAgZnVuY3Rpb24gb3V0ZXJXaWR0aChlbGVtZW50KSB7CiAgICB2YXIgc3R5bGVzID0gZ2V0KGVsZW1lbnQpOwogICAgcmV0dXJuIHRvSW50KHN0eWxlcy53aWR0aCkgKyB0b0ludChzdHlsZXMucGFkZGluZ0xlZnQpICsgdG9JbnQoc3R5bGVzLnBhZGRpbmdSaWdodCkgKyB0b0ludChzdHlsZXMuYm9yZGVyTGVmdFdpZHRoKSArIHRvSW50KHN0eWxlcy5ib3JkZXJSaWdodFdpZHRoKTsKICB9CgogIHZhciBlbnYgPSB7CiAgICBpc1dlYktpdDogdHlwZW9mIGRvY3VtZW50ICE9PSAndW5kZWZpbmVkJyAmJiAnV2Via2l0QXBwZWFyYW5jZScgaW4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLAogICAgc3VwcG9ydHNUb3VjaDogdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgKCdvbnRvdWNoc3RhcnQnIGluIHdpbmRvdyB8fCAnbWF4VG91Y2hQb2ludHMnIGluIHdpbmRvdy5uYXZpZ2F0b3IgJiYgd2luZG93Lm5hdmlnYXRvci5tYXhUb3VjaFBvaW50cyA+IDAgfHwgd2luZG93LkRvY3VtZW50VG91Y2ggJiYgZG9jdW1lbnQgaW5zdGFuY2VvZiB3aW5kb3cuRG9jdW1lbnRUb3VjaCksCiAgICBzdXBwb3J0c0llUG9pbnRlcjogdHlwZW9mIG5hdmlnYXRvciAhPT0gJ3VuZGVmaW5lZCcgJiYgbmF2aWdhdG9yLm1zTWF4VG91Y2hQb2ludHMsCiAgICBpc0Nocm9tZTogdHlwZW9mIG5hdmlnYXRvciAhPT0gJ3VuZGVmaW5lZCcgJiYgL0Nocm9tZS9pLnRlc3QobmF2aWdhdG9yICYmIG5hdmlnYXRvci51c2VyQWdlbnQpCiAgfTsKCiAgZnVuY3Rpb24gdXBkYXRlR2VvbWV0cnkoaSkgewogICAgdmFyIGVsZW1lbnQgPSBpLmVsZW1lbnQ7CiAgICB2YXIgcm91bmRlZFNjcm9sbFRvcCA9IE1hdGguZmxvb3IoZWxlbWVudC5zY3JvbGxUb3ApOwogICAgdmFyIHJlY3QgPSBlbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgaS5jb250YWluZXJXaWR0aCA9IE1hdGguY2VpbChyZWN0LndpZHRoKTsKICAgIGkuY29udGFpbmVySGVpZ2h0ID0gTWF0aC5jZWlsKHJlY3QuaGVpZ2h0KTsKICAgIGkuY29udGVudFdpZHRoID0gZWxlbWVudC5zY3JvbGxXaWR0aDsKICAgIGkuY29udGVudEhlaWdodCA9IGVsZW1lbnQuc2Nyb2xsSGVpZ2h0OwoKICAgIGlmICghZWxlbWVudC5jb250YWlucyhpLnNjcm9sbGJhclhSYWlsKSkgewogICAgICAvLyBjbGVhbiB1cCBhbmQgYXBwZW5kCiAgICAgIHF1ZXJ5Q2hpbGRyZW4oZWxlbWVudCwgY2xzLmVsZW1lbnQucmFpbCgneCcpKS5mb3JFYWNoKGZ1bmN0aW9uIChlbCkgewogICAgICAgIHJldHVybiByZW1vdmUoZWwpOwogICAgICB9KTsKICAgICAgZWxlbWVudC5hcHBlbmRDaGlsZChpLnNjcm9sbGJhclhSYWlsKTsKICAgIH0KCiAgICBpZiAoIWVsZW1lbnQuY29udGFpbnMoaS5zY3JvbGxiYXJZUmFpbCkpIHsKICAgICAgLy8gY2xlYW4gdXAgYW5kIGFwcGVuZAogICAgICBxdWVyeUNoaWxkcmVuKGVsZW1lbnQsIGNscy5lbGVtZW50LnJhaWwoJ3knKSkuZm9yRWFjaChmdW5jdGlvbiAoZWwpIHsKICAgICAgICByZXR1cm4gcmVtb3ZlKGVsKTsKICAgICAgfSk7CiAgICAgIGVsZW1lbnQuYXBwZW5kQ2hpbGQoaS5zY3JvbGxiYXJZUmFpbCk7CiAgICB9CgogICAgaWYgKCFpLnNldHRpbmdzLnN1cHByZXNzU2Nyb2xsWCAmJiBpLmNvbnRhaW5lcldpZHRoICsgaS5zZXR0aW5ncy5zY3JvbGxYTWFyZ2luT2Zmc2V0IDwgaS5jb250ZW50V2lkdGgpIHsKICAgICAgaS5zY3JvbGxiYXJYQWN0aXZlID0gdHJ1ZTsKICAgICAgaS5yYWlsWFdpZHRoID0gaS5jb250YWluZXJXaWR0aCAtIGkucmFpbFhNYXJnaW5XaWR0aDsKICAgICAgaS5yYWlsWFJhdGlvID0gaS5jb250YWluZXJXaWR0aCAvIGkucmFpbFhXaWR0aDsKICAgICAgaS5zY3JvbGxiYXJYV2lkdGggPSBnZXRUaHVtYlNpemUoaSwgdG9JbnQoaS5yYWlsWFdpZHRoICogaS5jb250YWluZXJXaWR0aCAvIGkuY29udGVudFdpZHRoKSk7CiAgICAgIGkuc2Nyb2xsYmFyWExlZnQgPSB0b0ludCgoaS5uZWdhdGl2ZVNjcm9sbEFkanVzdG1lbnQgKyBlbGVtZW50LnNjcm9sbExlZnQpICogKGkucmFpbFhXaWR0aCAtIGkuc2Nyb2xsYmFyWFdpZHRoKSAvIChpLmNvbnRlbnRXaWR0aCAtIGkuY29udGFpbmVyV2lkdGgpKTsKICAgIH0gZWxzZSB7CiAgICAgIGkuc2Nyb2xsYmFyWEFjdGl2ZSA9IGZhbHNlOwogICAgfQoKICAgIGlmICghaS5zZXR0aW5ncy5zdXBwcmVzc1Njcm9sbFkgJiYgaS5jb250YWluZXJIZWlnaHQgKyBpLnNldHRpbmdzLnNjcm9sbFlNYXJnaW5PZmZzZXQgPCBpLmNvbnRlbnRIZWlnaHQpIHsKICAgICAgaS5zY3JvbGxiYXJZQWN0aXZlID0gdHJ1ZTsKICAgICAgaS5yYWlsWUhlaWdodCA9IGkuY29udGFpbmVySGVpZ2h0IC0gaS5yYWlsWU1hcmdpbkhlaWdodDsKICAgICAgaS5yYWlsWVJhdGlvID0gaS5jb250YWluZXJIZWlnaHQgLyBpLnJhaWxZSGVpZ2h0OwogICAgICBpLnNjcm9sbGJhcllIZWlnaHQgPSBnZXRUaHVtYlNpemUoaSwgdG9JbnQoaS5yYWlsWUhlaWdodCAqIGkuY29udGFpbmVySGVpZ2h0IC8gaS5jb250ZW50SGVpZ2h0KSk7CiAgICAgIGkuc2Nyb2xsYmFyWVRvcCA9IHRvSW50KHJvdW5kZWRTY3JvbGxUb3AgKiAoaS5yYWlsWUhlaWdodCAtIGkuc2Nyb2xsYmFyWUhlaWdodCkgLyAoaS5jb250ZW50SGVpZ2h0IC0gaS5jb250YWluZXJIZWlnaHQpKTsKICAgIH0gZWxzZSB7CiAgICAgIGkuc2Nyb2xsYmFyWUFjdGl2ZSA9IGZhbHNlOwogICAgfQoKICAgIGlmIChpLnNjcm9sbGJhclhMZWZ0ID49IGkucmFpbFhXaWR0aCAtIGkuc2Nyb2xsYmFyWFdpZHRoKSB7CiAgICAgIGkuc2Nyb2xsYmFyWExlZnQgPSBpLnJhaWxYV2lkdGggLSBpLnNjcm9sbGJhclhXaWR0aDsKICAgIH0KCiAgICBpZiAoaS5zY3JvbGxiYXJZVG9wID49IGkucmFpbFlIZWlnaHQgLSBpLnNjcm9sbGJhcllIZWlnaHQpIHsKICAgICAgaS5zY3JvbGxiYXJZVG9wID0gaS5yYWlsWUhlaWdodCAtIGkuc2Nyb2xsYmFyWUhlaWdodDsKICAgIH0KCiAgICB1cGRhdGVDc3MoZWxlbWVudCwgaSk7CgogICAgaWYgKGkuc2Nyb2xsYmFyWEFjdGl2ZSkgewogICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoY2xzLnN0YXRlLmFjdGl2ZSgneCcpKTsKICAgIH0gZWxzZSB7CiAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjbHMuc3RhdGUuYWN0aXZlKCd4JykpOwogICAgICBpLnNjcm9sbGJhclhXaWR0aCA9IDA7CiAgICAgIGkuc2Nyb2xsYmFyWExlZnQgPSAwOwogICAgICBlbGVtZW50LnNjcm9sbExlZnQgPSBpLmlzUnRsID09PSB0cnVlID8gaS5jb250ZW50V2lkdGggOiAwOwogICAgfQoKICAgIGlmIChpLnNjcm9sbGJhcllBY3RpdmUpIHsKICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKGNscy5zdGF0ZS5hY3RpdmUoJ3knKSk7CiAgICB9IGVsc2UgewogICAgICBlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoY2xzLnN0YXRlLmFjdGl2ZSgneScpKTsKICAgICAgaS5zY3JvbGxiYXJZSGVpZ2h0ID0gMDsKICAgICAgaS5zY3JvbGxiYXJZVG9wID0gMDsKICAgICAgZWxlbWVudC5zY3JvbGxUb3AgPSAwOwogICAgfQogIH0KCiAgZnVuY3Rpb24gZ2V0VGh1bWJTaXplKGksIHRodW1iU2l6ZSkgewogICAgaWYgKGkuc2V0dGluZ3MubWluU2Nyb2xsYmFyTGVuZ3RoKSB7CiAgICAgIHRodW1iU2l6ZSA9IE1hdGgubWF4KHRodW1iU2l6ZSwgaS5zZXR0aW5ncy5taW5TY3JvbGxiYXJMZW5ndGgpOwogICAgfQoKICAgIGlmIChpLnNldHRpbmdzLm1heFNjcm9sbGJhckxlbmd0aCkgewogICAgICB0aHVtYlNpemUgPSBNYXRoLm1pbih0aHVtYlNpemUsIGkuc2V0dGluZ3MubWF4U2Nyb2xsYmFyTGVuZ3RoKTsKICAgIH0KCiAgICByZXR1cm4gdGh1bWJTaXplOwogIH0KCiAgZnVuY3Rpb24gdXBkYXRlQ3NzKGVsZW1lbnQsIGkpIHsKICAgIHZhciB4UmFpbE9mZnNldCA9IHsKICAgICAgd2lkdGg6IGkucmFpbFhXaWR0aAogICAgfTsKICAgIHZhciByb3VuZGVkU2Nyb2xsVG9wID0gTWF0aC5mbG9vcihlbGVtZW50LnNjcm9sbFRvcCk7CgogICAgaWYgKGkuaXNSdGwpIHsKICAgICAgeFJhaWxPZmZzZXQubGVmdCA9IGkubmVnYXRpdmVTY3JvbGxBZGp1c3RtZW50ICsgZWxlbWVudC5zY3JvbGxMZWZ0ICsgaS5jb250YWluZXJXaWR0aCAtIGkuY29udGVudFdpZHRoOwogICAgfSBlbHNlIHsKICAgICAgeFJhaWxPZmZzZXQubGVmdCA9IGVsZW1lbnQuc2Nyb2xsTGVmdDsKICAgIH0KCiAgICBpZiAoaS5pc1Njcm9sbGJhclhVc2luZ0JvdHRvbSkgewogICAgICB4UmFpbE9mZnNldC5ib3R0b20gPSBpLnNjcm9sbGJhclhCb3R0b20gLSByb3VuZGVkU2Nyb2xsVG9wOwogICAgfSBlbHNlIHsKICAgICAgeFJhaWxPZmZzZXQudG9wID0gaS5zY3JvbGxiYXJYVG9wICsgcm91bmRlZFNjcm9sbFRvcDsKICAgIH0KCiAgICBzZXQoaS5zY3JvbGxiYXJYUmFpbCwgeFJhaWxPZmZzZXQpOwogICAgdmFyIHlSYWlsT2Zmc2V0ID0gewogICAgICB0b3A6IHJvdW5kZWRTY3JvbGxUb3AsCiAgICAgIGhlaWdodDogaS5yYWlsWUhlaWdodAogICAgfTsKCiAgICBpZiAoaS5pc1Njcm9sbGJhcllVc2luZ1JpZ2h0KSB7CiAgICAgIGlmIChpLmlzUnRsKSB7CiAgICAgICAgeVJhaWxPZmZzZXQucmlnaHQgPSBpLmNvbnRlbnRXaWR0aCAtIChpLm5lZ2F0aXZlU2Nyb2xsQWRqdXN0bWVudCArIGVsZW1lbnQuc2Nyb2xsTGVmdCkgLSBpLnNjcm9sbGJhcllSaWdodCAtIGkuc2Nyb2xsYmFyWU91dGVyV2lkdGggLSA5OwogICAgICB9IGVsc2UgewogICAgICAgIHlSYWlsT2Zmc2V0LnJpZ2h0ID0gaS5zY3JvbGxiYXJZUmlnaHQgLSBlbGVtZW50LnNjcm9sbExlZnQ7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGlmIChpLmlzUnRsKSB7CiAgICAgICAgeVJhaWxPZmZzZXQubGVmdCA9IGkubmVnYXRpdmVTY3JvbGxBZGp1c3RtZW50ICsgZWxlbWVudC5zY3JvbGxMZWZ0ICsgaS5jb250YWluZXJXaWR0aCAqIDIgLSBpLmNvbnRlbnRXaWR0aCAtIGkuc2Nyb2xsYmFyWUxlZnQgLSBpLnNjcm9sbGJhcllPdXRlcldpZHRoOwogICAgICB9IGVsc2UgewogICAgICAgIHlSYWlsT2Zmc2V0LmxlZnQgPSBpLnNjcm9sbGJhcllMZWZ0ICsgZWxlbWVudC5zY3JvbGxMZWZ0OwogICAgICB9CiAgICB9CgogICAgc2V0KGkuc2Nyb2xsYmFyWVJhaWwsIHlSYWlsT2Zmc2V0KTsKICAgIHNldChpLnNjcm9sbGJhclgsIHsKICAgICAgbGVmdDogaS5zY3JvbGxiYXJYTGVmdCwKICAgICAgd2lkdGg6IGkuc2Nyb2xsYmFyWFdpZHRoIC0gaS5yYWlsQm9yZGVyWFdpZHRoCiAgICB9KTsKICAgIHNldChpLnNjcm9sbGJhclksIHsKICAgICAgdG9wOiBpLnNjcm9sbGJhcllUb3AsCiAgICAgIGhlaWdodDogaS5zY3JvbGxiYXJZSGVpZ2h0IC0gaS5yYWlsQm9yZGVyWVdpZHRoCiAgICB9KTsKICB9CgogIGZ1bmN0aW9uIGNsaWNrUmFpbChpKSB7CiAgICB2YXIgZWxlbWVudCA9IGkuZWxlbWVudDsKICAgIGkuZXZlbnQuYmluZChpLnNjcm9sbGJhclksICdtb3VzZWRvd24nLCBmdW5jdGlvbiAoZSkgewogICAgICByZXR1cm4gZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgIH0pOwogICAgaS5ldmVudC5iaW5kKGkuc2Nyb2xsYmFyWVJhaWwsICdtb3VzZWRvd24nLCBmdW5jdGlvbiAoZSkgewogICAgICB2YXIgcG9zaXRpb25Ub3AgPSBlLnBhZ2VZIC0gd2luZG93LnBhZ2VZT2Zmc2V0IC0gaS5zY3JvbGxiYXJZUmFpbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3A7CiAgICAgIHZhciBkaXJlY3Rpb24gPSBwb3NpdGlvblRvcCA+IGkuc2Nyb2xsYmFyWVRvcCA/IDEgOiAtMTsKICAgICAgaS5lbGVtZW50LnNjcm9sbFRvcCArPSBkaXJlY3Rpb24gKiBpLmNvbnRhaW5lckhlaWdodDsKICAgICAgdXBkYXRlR2VvbWV0cnkoaSk7CiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICB9KTsKICAgIGkuZXZlbnQuYmluZChpLnNjcm9sbGJhclgsICdtb3VzZWRvd24nLCBmdW5jdGlvbiAoZSkgewogICAgICByZXR1cm4gZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgIH0pOwogICAgaS5ldmVudC5iaW5kKGkuc2Nyb2xsYmFyWFJhaWwsICdtb3VzZWRvd24nLCBmdW5jdGlvbiAoZSkgewogICAgICB2YXIgcG9zaXRpb25MZWZ0ID0gZS5wYWdlWCAtIHdpbmRvdy5wYWdlWE9mZnNldCAtIGkuc2Nyb2xsYmFyWFJhaWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdDsKICAgICAgdmFyIGRpcmVjdGlvbiA9IHBvc2l0aW9uTGVmdCA+IGkuc2Nyb2xsYmFyWExlZnQgPyAxIDogLTE7CiAgICAgIGkuZWxlbWVudC5zY3JvbGxMZWZ0ICs9IGRpcmVjdGlvbiAqIGkuY29udGFpbmVyV2lkdGg7CiAgICAgIHVwZGF0ZUdlb21ldHJ5KGkpOwogICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgfSk7CiAgfQoKICBmdW5jdGlvbiBkcmFnVGh1bWIoaSkgewogICAgYmluZE1vdXNlU2Nyb2xsSGFuZGxlcihpLCBbJ2NvbnRhaW5lcldpZHRoJywgJ2NvbnRlbnRXaWR0aCcsICdwYWdlWCcsICdyYWlsWFdpZHRoJywgJ3Njcm9sbGJhclgnLCAnc2Nyb2xsYmFyWFdpZHRoJywgJ3Njcm9sbExlZnQnLCAneCcsICdzY3JvbGxiYXJYUmFpbCddKTsKICAgIGJpbmRNb3VzZVNjcm9sbEhhbmRsZXIoaSwgWydjb250YWluZXJIZWlnaHQnLCAnY29udGVudEhlaWdodCcsICdwYWdlWScsICdyYWlsWUhlaWdodCcsICdzY3JvbGxiYXJZJywgJ3Njcm9sbGJhcllIZWlnaHQnLCAnc2Nyb2xsVG9wJywgJ3knLCAnc2Nyb2xsYmFyWVJhaWwnXSk7CiAgfQoKICBmdW5jdGlvbiBiaW5kTW91c2VTY3JvbGxIYW5kbGVyKGksIHJlZikgewogICAgdmFyIGNvbnRhaW5lckhlaWdodCA9IHJlZlswXTsKICAgIHZhciBjb250ZW50SGVpZ2h0ID0gcmVmWzFdOwogICAgdmFyIHBhZ2VZID0gcmVmWzJdOwogICAgdmFyIHJhaWxZSGVpZ2h0ID0gcmVmWzNdOwogICAgdmFyIHNjcm9sbGJhclkgPSByZWZbNF07CiAgICB2YXIgc2Nyb2xsYmFyWUhlaWdodCA9IHJlZls1XTsKICAgIHZhciBzY3JvbGxUb3AgPSByZWZbNl07CiAgICB2YXIgeSA9IHJlZls3XTsKICAgIHZhciBzY3JvbGxiYXJZUmFpbCA9IHJlZls4XTsKICAgIHZhciBlbGVtZW50ID0gaS5lbGVtZW50OwogICAgdmFyIHN0YXJ0aW5nU2Nyb2xsVG9wID0gbnVsbDsKICAgIHZhciBzdGFydGluZ01vdXNlUGFnZVkgPSBudWxsOwogICAgdmFyIHNjcm9sbEJ5ID0gbnVsbDsKCiAgICBmdW5jdGlvbiBtb3VzZU1vdmVIYW5kbGVyKGUpIHsKICAgICAgaWYgKGUudG91Y2hlcyAmJiBlLnRvdWNoZXNbMF0pIHsKICAgICAgICBlW3BhZ2VZXSA9IGUudG91Y2hlc1swXS5wYWdlWTsKICAgICAgfQoKICAgICAgZWxlbWVudFtzY3JvbGxUb3BdID0gc3RhcnRpbmdTY3JvbGxUb3AgKyBzY3JvbGxCeSAqIChlW3BhZ2VZXSAtIHN0YXJ0aW5nTW91c2VQYWdlWSk7CiAgICAgIGFkZFNjcm9sbGluZ0NsYXNzKGksIHkpOwogICAgICB1cGRhdGVHZW9tZXRyeShpKTsKICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgfQoKICAgIGZ1bmN0aW9uIG1vdXNlVXBIYW5kbGVyKCkgewogICAgICByZW1vdmVTY3JvbGxpbmdDbGFzcyhpLCB5KTsKICAgICAgaVtzY3JvbGxiYXJZUmFpbF0uY2xhc3NMaXN0LnJlbW92ZShjbHMuc3RhdGUuY2xpY2tpbmcpOwogICAgICBpLmV2ZW50LnVuYmluZChpLm93bmVyRG9jdW1lbnQsICdtb3VzZW1vdmUnLCBtb3VzZU1vdmVIYW5kbGVyKTsKICAgIH0KCiAgICBmdW5jdGlvbiBiaW5kTW92ZXMoZSwgdG91Y2hNb2RlKSB7CiAgICAgIHN0YXJ0aW5nU2Nyb2xsVG9wID0gZWxlbWVudFtzY3JvbGxUb3BdOwoKICAgICAgaWYgKHRvdWNoTW9kZSAmJiBlLnRvdWNoZXMpIHsKICAgICAgICBlW3BhZ2VZXSA9IGUudG91Y2hlc1swXS5wYWdlWTsKICAgICAgfQoKICAgICAgc3RhcnRpbmdNb3VzZVBhZ2VZID0gZVtwYWdlWV07CiAgICAgIHNjcm9sbEJ5ID0gKGlbY29udGVudEhlaWdodF0gLSBpW2NvbnRhaW5lckhlaWdodF0pIC8gKGlbcmFpbFlIZWlnaHRdIC0gaVtzY3JvbGxiYXJZSGVpZ2h0XSk7CgogICAgICBpZiAoIXRvdWNoTW9kZSkgewogICAgICAgIGkuZXZlbnQuYmluZChpLm93bmVyRG9jdW1lbnQsICdtb3VzZW1vdmUnLCBtb3VzZU1vdmVIYW5kbGVyKTsKICAgICAgICBpLmV2ZW50Lm9uY2UoaS5vd25lckRvY3VtZW50LCAnbW91c2V1cCcsIG1vdXNlVXBIYW5kbGVyKTsKICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaS5ldmVudC5iaW5kKGkub3duZXJEb2N1bWVudCwgJ3RvdWNobW92ZScsIG1vdXNlTW92ZUhhbmRsZXIpOwogICAgICB9CgogICAgICBpW3Njcm9sbGJhcllSYWlsXS5jbGFzc0xpc3QuYWRkKGNscy5zdGF0ZS5jbGlja2luZyk7CiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICB9CgogICAgaS5ldmVudC5iaW5kKGlbc2Nyb2xsYmFyWV0sICdtb3VzZWRvd24nLCBmdW5jdGlvbiAoZSkgewogICAgICBiaW5kTW92ZXMoZSk7CiAgICB9KTsKICAgIGkuZXZlbnQuYmluZChpW3Njcm9sbGJhclldLCAndG91Y2hzdGFydCcsIGZ1bmN0aW9uIChlKSB7CiAgICAgIGJpbmRNb3ZlcyhlLCB0cnVlKTsKICAgIH0pOwogIH0KCiAgZnVuY3Rpb24ga2V5Ym9hcmQoaSkgewogICAgdmFyIGVsZW1lbnQgPSBpLmVsZW1lbnQ7CgogICAgdmFyIGVsZW1lbnRIb3ZlcmVkID0gZnVuY3Rpb24gZWxlbWVudEhvdmVyZWQoKSB7CiAgICAgIHJldHVybiBtYXRjaGVzKGVsZW1lbnQsICc6aG92ZXInKTsKICAgIH07CgogICAgdmFyIHNjcm9sbGJhckZvY3VzZWQgPSBmdW5jdGlvbiBzY3JvbGxiYXJGb2N1c2VkKCkgewogICAgICByZXR1cm4gbWF0Y2hlcyhpLnNjcm9sbGJhclgsICc6Zm9jdXMnKSB8fCBtYXRjaGVzKGkuc2Nyb2xsYmFyWSwgJzpmb2N1cycpOwogICAgfTsKCiAgICBmdW5jdGlvbiBzaG91bGRQcmV2ZW50RGVmYXVsdChkZWx0YVgsIGRlbHRhWSkgewogICAgICB2YXIgc2Nyb2xsVG9wID0gTWF0aC5mbG9vcihlbGVtZW50LnNjcm9sbFRvcCk7CgogICAgICBpZiAoZGVsdGFYID09PSAwKSB7CiAgICAgICAgaWYgKCFpLnNjcm9sbGJhcllBY3RpdmUpIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIGlmIChzY3JvbGxUb3AgPT09IDAgJiYgZGVsdGFZID4gMCB8fCBzY3JvbGxUb3AgPj0gaS5jb250ZW50SGVpZ2h0IC0gaS5jb250YWluZXJIZWlnaHQgJiYgZGVsdGFZIDwgMCkgewogICAgICAgICAgcmV0dXJuICFpLnNldHRpbmdzLndoZWVsUHJvcGFnYXRpb247CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgc2Nyb2xsTGVmdCA9IGVsZW1lbnQuc2Nyb2xsTGVmdDsKCiAgICAgIGlmIChkZWx0YVkgPT09IDApIHsKICAgICAgICBpZiAoIWkuc2Nyb2xsYmFyWEFjdGl2ZSkgewogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgaWYgKHNjcm9sbExlZnQgPT09IDAgJiYgZGVsdGFYIDwgMCB8fCBzY3JvbGxMZWZ0ID49IGkuY29udGVudFdpZHRoIC0gaS5jb250YWluZXJXaWR0aCAmJiBkZWx0YVggPiAwKSB7CiAgICAgICAgICByZXR1cm4gIWkuc2V0dGluZ3Mud2hlZWxQcm9wYWdhdGlvbjsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGkuZXZlbnQuYmluZChpLm93bmVyRG9jdW1lbnQsICdrZXlkb3duJywgZnVuY3Rpb24gKGUpIHsKICAgICAgaWYgKGUuaXNEZWZhdWx0UHJldmVudGVkICYmIGUuaXNEZWZhdWx0UHJldmVudGVkKCkgfHwgZS5kZWZhdWx0UHJldmVudGVkKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoIWVsZW1lbnRIb3ZlcmVkKCkgJiYgIXNjcm9sbGJhckZvY3VzZWQoKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIGFjdGl2ZUVsZW1lbnQgPSBkb2N1bWVudC5hY3RpdmVFbGVtZW50ID8gZG9jdW1lbnQuYWN0aXZlRWxlbWVudCA6IGkub3duZXJEb2N1bWVudC5hY3RpdmVFbGVtZW50OwoKICAgICAgaWYgKGFjdGl2ZUVsZW1lbnQpIHsKICAgICAgICBpZiAoYWN0aXZlRWxlbWVudC50YWdOYW1lID09PSAnSUZSQU1FJykgewogICAgICAgICAgYWN0aXZlRWxlbWVudCA9IGFjdGl2ZUVsZW1lbnQuY29udGVudERvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8vIGdvIGRlZXBlciBpZiBlbGVtZW50IGlzIGEgd2ViY29tcG9uZW50CiAgICAgICAgICB3aGlsZSAoYWN0aXZlRWxlbWVudC5zaGFkb3dSb290KSB7CiAgICAgICAgICAgIGFjdGl2ZUVsZW1lbnQgPSBhY3RpdmVFbGVtZW50LnNoYWRvd1Jvb3QuYWN0aXZlRWxlbWVudDsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmIChpc0VkaXRhYmxlKGFjdGl2ZUVsZW1lbnQpKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgZGVsdGFYID0gMDsKICAgICAgdmFyIGRlbHRhWSA9IDA7CgogICAgICBzd2l0Y2ggKGUud2hpY2gpIHsKICAgICAgICBjYXNlIDM3OgogICAgICAgICAgLy8gbGVmdAogICAgICAgICAgaWYgKGUubWV0YUtleSkgewogICAgICAgICAgICBkZWx0YVggPSAtaS5jb250ZW50V2lkdGg7CiAgICAgICAgICB9IGVsc2UgaWYgKGUuYWx0S2V5KSB7CiAgICAgICAgICAgIGRlbHRhWCA9IC1pLmNvbnRhaW5lcldpZHRoOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZGVsdGFYID0gLTMwOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDM4OgogICAgICAgICAgLy8gdXAKICAgICAgICAgIGlmIChlLm1ldGFLZXkpIHsKICAgICAgICAgICAgZGVsdGFZID0gaS5jb250ZW50SGVpZ2h0OwogICAgICAgICAgfSBlbHNlIGlmIChlLmFsdEtleSkgewogICAgICAgICAgICBkZWx0YVkgPSBpLmNvbnRhaW5lckhlaWdodDsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGRlbHRhWSA9IDMwOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDM5OgogICAgICAgICAgLy8gcmlnaHQKICAgICAgICAgIGlmIChlLm1ldGFLZXkpIHsKICAgICAgICAgICAgZGVsdGFYID0gaS5jb250ZW50V2lkdGg7CiAgICAgICAgICB9IGVsc2UgaWYgKGUuYWx0S2V5KSB7CiAgICAgICAgICAgIGRlbHRhWCA9IGkuY29udGFpbmVyV2lkdGg7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBkZWx0YVggPSAzMDsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSA0MDoKICAgICAgICAgIC8vIGRvd24KICAgICAgICAgIGlmIChlLm1ldGFLZXkpIHsKICAgICAgICAgICAgZGVsdGFZID0gLWkuY29udGVudEhlaWdodDsKICAgICAgICAgIH0gZWxzZSBpZiAoZS5hbHRLZXkpIHsKICAgICAgICAgICAgZGVsdGFZID0gLWkuY29udGFpbmVySGVpZ2h0OwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZGVsdGFZID0gLTMwOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDMyOgogICAgICAgICAgLy8gc3BhY2UgYmFyCiAgICAgICAgICBpZiAoZS5zaGlmdEtleSkgewogICAgICAgICAgICBkZWx0YVkgPSBpLmNvbnRhaW5lckhlaWdodDsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGRlbHRhWSA9IC1pLmNvbnRhaW5lckhlaWdodDsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAzMzoKICAgICAgICAgIC8vIHBhZ2UgdXAKICAgICAgICAgIGRlbHRhWSA9IGkuY29udGFpbmVySGVpZ2h0OwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMzQ6CiAgICAgICAgICAvLyBwYWdlIGRvd24KICAgICAgICAgIGRlbHRhWSA9IC1pLmNvbnRhaW5lckhlaWdodDsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDM2OgogICAgICAgICAgLy8gaG9tZQogICAgICAgICAgZGVsdGFZID0gaS5jb250ZW50SGVpZ2h0OwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMzU6CiAgICAgICAgICAvLyBlbmQKICAgICAgICAgIGRlbHRhWSA9IC1pLmNvbnRlbnRIZWlnaHQ7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKGkuc2V0dGluZ3Muc3VwcHJlc3NTY3JvbGxYICYmIGRlbHRhWCAhPT0gMCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKGkuc2V0dGluZ3Muc3VwcHJlc3NTY3JvbGxZICYmIGRlbHRhWSAhPT0gMCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgZWxlbWVudC5zY3JvbGxUb3AgLT0gZGVsdGFZOwogICAgICBlbGVtZW50LnNjcm9sbExlZnQgKz0gZGVsdGFYOwogICAgICB1cGRhdGVHZW9tZXRyeShpKTsKCiAgICAgIGlmIChzaG91bGRQcmV2ZW50RGVmYXVsdChkZWx0YVgsIGRlbHRhWSkpIHsKICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgIH0KICAgIH0pOwogIH0KCiAgZnVuY3Rpb24gd2hlZWwoaSkgewogICAgdmFyIGVsZW1lbnQgPSBpLmVsZW1lbnQ7CgogICAgZnVuY3Rpb24gc2hvdWxkUHJldmVudERlZmF1bHQoZGVsdGFYLCBkZWx0YVkpIHsKICAgICAgdmFyIHJvdW5kZWRTY3JvbGxUb3AgPSBNYXRoLmZsb29yKGVsZW1lbnQuc2Nyb2xsVG9wKTsKICAgICAgdmFyIGlzVG9wID0gZWxlbWVudC5zY3JvbGxUb3AgPT09IDA7CiAgICAgIHZhciBpc0JvdHRvbSA9IHJvdW5kZWRTY3JvbGxUb3AgKyBlbGVtZW50Lm9mZnNldEhlaWdodCA9PT0gZWxlbWVudC5zY3JvbGxIZWlnaHQ7CiAgICAgIHZhciBpc0xlZnQgPSBlbGVtZW50LnNjcm9sbExlZnQgPT09IDA7CiAgICAgIHZhciBpc1JpZ2h0ID0gZWxlbWVudC5zY3JvbGxMZWZ0ICsgZWxlbWVudC5vZmZzZXRXaWR0aCA9PT0gZWxlbWVudC5zY3JvbGxXaWR0aDsKICAgICAgdmFyIGhpdHNCb3VuZDsgLy8gcGljayBheGlzIHdpdGggcHJpbWFyeSBkaXJlY3Rpb24KCiAgICAgIGlmIChNYXRoLmFicyhkZWx0YVkpID4gTWF0aC5hYnMoZGVsdGFYKSkgewogICAgICAgIGhpdHNCb3VuZCA9IGlzVG9wIHx8IGlzQm90dG9tOwogICAgICB9IGVsc2UgewogICAgICAgIGhpdHNCb3VuZCA9IGlzTGVmdCB8fCBpc1JpZ2h0OwogICAgICB9CgogICAgICByZXR1cm4gaGl0c0JvdW5kID8gIWkuc2V0dGluZ3Mud2hlZWxQcm9wYWdhdGlvbiA6IHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0RGVsdGFGcm9tRXZlbnQoZSkgewogICAgICB2YXIgZGVsdGFYID0gZS5kZWx0YVg7CiAgICAgIHZhciBkZWx0YVkgPSAtMSAqIGUuZGVsdGFZOwoKICAgICAgaWYgKHR5cGVvZiBkZWx0YVggPT09ICd1bmRlZmluZWQnIHx8IHR5cGVvZiBkZWx0YVkgPT09ICd1bmRlZmluZWQnKSB7CiAgICAgICAgLy8gT1MgWCBTYWZhcmkKICAgICAgICBkZWx0YVggPSAtMSAqIGUud2hlZWxEZWx0YVggLyA2OwogICAgICAgIGRlbHRhWSA9IGUud2hlZWxEZWx0YVkgLyA2OwogICAgICB9CgogICAgICBpZiAoZS5kZWx0YU1vZGUgJiYgZS5kZWx0YU1vZGUgPT09IDEpIHsKICAgICAgICAvLyBGaXJlZm94IGluIGRlbHRhTW9kZSAxOiBMaW5lIHNjcm9sbGluZwogICAgICAgIGRlbHRhWCAqPSAxMDsKICAgICAgICBkZWx0YVkgKj0gMTA7CiAgICAgIH0KCiAgICAgIGlmIChkZWx0YVggIT09IGRlbHRhWCAmJiBkZWx0YVkgIT09IGRlbHRhWQogICAgICAvKiBOYU4gY2hlY2tzICovCiAgICAgICkgewogICAgICAgICAgLy8gSUUgaW4gc29tZSBtb3VzZSBkcml2ZXJzCiAgICAgICAgICBkZWx0YVggPSAwOwogICAgICAgICAgZGVsdGFZID0gZS53aGVlbERlbHRhOwogICAgICAgIH0KCiAgICAgIGlmIChlLnNoaWZ0S2V5KSB7CiAgICAgICAgLy8gcmV2ZXJzZSBheGlzIHdpdGggc2hpZnQga2V5CiAgICAgICAgcmV0dXJuIFstZGVsdGFZLCAtZGVsdGFYXTsKICAgICAgfQoKICAgICAgcmV0dXJuIFtkZWx0YVgsIGRlbHRhWV07CiAgICB9CgogICAgZnVuY3Rpb24gc2hvdWxkQmVDb25zdW1lZEJ5Q2hpbGQodGFyZ2V0LCBkZWx0YVgsIGRlbHRhWSkgewogICAgICAvLyBGSVhNRTogdGhpcyBpcyBhIHdvcmthcm91bmQgZm9yIDxzZWxlY3Q+IGlzc3VlIGluIEZGIGFuZCBJRSAjNTcxCiAgICAgIGlmICghZW52LmlzV2ViS2l0ICYmIGVsZW1lbnQucXVlcnlTZWxlY3Rvcignc2VsZWN0OmZvY3VzJykpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgaWYgKCFlbGVtZW50LmNvbnRhaW5zKHRhcmdldCkpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIHZhciBjdXJzb3IgPSB0YXJnZXQ7CgogICAgICB3aGlsZSAoY3Vyc29yICYmIGN1cnNvciAhPT0gZWxlbWVudCkgewogICAgICAgIGlmIChjdXJzb3IuY2xhc3NMaXN0LmNvbnRhaW5zKGNscy5lbGVtZW50LmNvbnN1bWluZykpIHsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KCiAgICAgICAgdmFyIHN0eWxlID0gZ2V0KGN1cnNvcik7IC8vIGlmIGRlbHRhWSAmJiB2ZXJ0aWNhbCBzY3JvbGxhYmxlCgogICAgICAgIGlmIChkZWx0YVkgJiYgc3R5bGUub3ZlcmZsb3dZLm1hdGNoKC8oc2Nyb2xsfGF1dG8pLykpIHsKICAgICAgICAgIHZhciBtYXhTY3JvbGxUb3AgPSBjdXJzb3Iuc2Nyb2xsSGVpZ2h0IC0gY3Vyc29yLmNsaWVudEhlaWdodDsKCiAgICAgICAgICBpZiAobWF4U2Nyb2xsVG9wID4gMCkgewogICAgICAgICAgICBpZiAoY3Vyc29yLnNjcm9sbFRvcCA+IDAgJiYgZGVsdGFZIDwgMCB8fCBjdXJzb3Iuc2Nyb2xsVG9wIDwgbWF4U2Nyb2xsVG9wICYmIGRlbHRhWSA+IDApIHsKICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gLy8gaWYgZGVsdGFYICYmIGhvcml6b250YWwgc2Nyb2xsYWJsZQoKCiAgICAgICAgaWYgKGRlbHRhWCAmJiBzdHlsZS5vdmVyZmxvd1gubWF0Y2goLyhzY3JvbGx8YXV0bykvKSkgewogICAgICAgICAgdmFyIG1heFNjcm9sbExlZnQgPSBjdXJzb3Iuc2Nyb2xsV2lkdGggLSBjdXJzb3IuY2xpZW50V2lkdGg7CgogICAgICAgICAgaWYgKG1heFNjcm9sbExlZnQgPiAwKSB7CiAgICAgICAgICAgIGlmIChjdXJzb3Iuc2Nyb2xsTGVmdCA+IDAgJiYgZGVsdGFYIDwgMCB8fCBjdXJzb3Iuc2Nyb2xsTGVmdCA8IG1heFNjcm9sbExlZnQgJiYgZGVsdGFYID4gMCkgewogICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBjdXJzb3IgPSBjdXJzb3IucGFyZW50Tm9kZTsKICAgICAgfQoKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIGZ1bmN0aW9uIG1vdXNld2hlZWxIYW5kbGVyKGUpIHsKICAgICAgdmFyIHJlZiA9IGdldERlbHRhRnJvbUV2ZW50KGUpOwogICAgICB2YXIgZGVsdGFYID0gcmVmWzBdOwogICAgICB2YXIgZGVsdGFZID0gcmVmWzFdOwoKICAgICAgaWYgKHNob3VsZEJlQ29uc3VtZWRCeUNoaWxkKGUudGFyZ2V0LCBkZWx0YVgsIGRlbHRhWSkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBzaG91bGRQcmV2ZW50ID0gZmFsc2U7CgogICAgICBpZiAoIWkuc2V0dGluZ3MudXNlQm90aFdoZWVsQXhlcykgewogICAgICAgIC8vIGRlbHRhWCB3aWxsIG9ubHkgYmUgdXNlZCBmb3IgaG9yaXpvbnRhbCBzY3JvbGxpbmcgYW5kIGRlbHRhWSB3aWxsCiAgICAgICAgLy8gb25seSBiZSB1c2VkIGZvciB2ZXJ0aWNhbCBzY3JvbGxpbmcgLSB0aGlzIGlzIHRoZSBkZWZhdWx0CiAgICAgICAgZWxlbWVudC5zY3JvbGxUb3AgLT0gZGVsdGFZICogaS5zZXR0aW5ncy53aGVlbFNwZWVkOwogICAgICAgIGVsZW1lbnQuc2Nyb2xsTGVmdCArPSBkZWx0YVggKiBpLnNldHRpbmdzLndoZWVsU3BlZWQ7CiAgICAgIH0gZWxzZSBpZiAoaS5zY3JvbGxiYXJZQWN0aXZlICYmICFpLnNjcm9sbGJhclhBY3RpdmUpIHsKICAgICAgICAvLyBvbmx5IHZlcnRpY2FsIHNjcm9sbGJhciBpcyBhY3RpdmUgYW5kIHVzZUJvdGhXaGVlbEF4ZXMgb3B0aW9uIGlzCiAgICAgICAgLy8gYWN0aXZlLCBzbyBsZXQncyBzY3JvbGwgdmVydGljYWwgYmFyIHVzaW5nIGJvdGggbW91c2Ugd2hlZWwgYXhlcwogICAgICAgIGlmIChkZWx0YVkpIHsKICAgICAgICAgIGVsZW1lbnQuc2Nyb2xsVG9wIC09IGRlbHRhWSAqIGkuc2V0dGluZ3Mud2hlZWxTcGVlZDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZWxlbWVudC5zY3JvbGxUb3AgKz0gZGVsdGFYICogaS5zZXR0aW5ncy53aGVlbFNwZWVkOwogICAgICAgIH0KCiAgICAgICAgc2hvdWxkUHJldmVudCA9IHRydWU7CiAgICAgIH0gZWxzZSBpZiAoaS5zY3JvbGxiYXJYQWN0aXZlICYmICFpLnNjcm9sbGJhcllBY3RpdmUpIHsKICAgICAgICAvLyB1c2VCb3RoV2hlZWxBeGVzIGFuZCBvbmx5IGhvcml6b250YWwgYmFyIGlzIGFjdGl2ZSwgc28gdXNlIGJvdGgKICAgICAgICAvLyB3aGVlbCBheGVzIGZvciBob3Jpem9udGFsIGJhcgogICAgICAgIGlmIChkZWx0YVgpIHsKICAgICAgICAgIGVsZW1lbnQuc2Nyb2xsTGVmdCArPSBkZWx0YVggKiBpLnNldHRpbmdzLndoZWVsU3BlZWQ7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGVsZW1lbnQuc2Nyb2xsTGVmdCAtPSBkZWx0YVkgKiBpLnNldHRpbmdzLndoZWVsU3BlZWQ7CiAgICAgICAgfQoKICAgICAgICBzaG91bGRQcmV2ZW50ID0gdHJ1ZTsKICAgICAgfQoKICAgICAgdXBkYXRlR2VvbWV0cnkoaSk7CiAgICAgIHNob3VsZFByZXZlbnQgPSBzaG91bGRQcmV2ZW50IHx8IHNob3VsZFByZXZlbnREZWZhdWx0KGRlbHRhWCwgZGVsdGFZKTsKCiAgICAgIGlmIChzaG91bGRQcmV2ZW50ICYmICFlLmN0cmxLZXkpIHsKICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgfQogICAgfQoKICAgIGlmICh0eXBlb2Ygd2luZG93Lm9ud2hlZWwgIT09ICd1bmRlZmluZWQnKSB7CiAgICAgIGkuZXZlbnQuYmluZChlbGVtZW50LCAnd2hlZWwnLCBtb3VzZXdoZWVsSGFuZGxlcik7CiAgICB9IGVsc2UgaWYgKHR5cGVvZiB3aW5kb3cub25tb3VzZXdoZWVsICE9PSAndW5kZWZpbmVkJykgewogICAgICBpLmV2ZW50LmJpbmQoZWxlbWVudCwgJ21vdXNld2hlZWwnLCBtb3VzZXdoZWVsSGFuZGxlcik7CiAgICB9CiAgfQoKICBmdW5jdGlvbiB0b3VjaChpKSB7CiAgICBpZiAoIWVudi5zdXBwb3J0c1RvdWNoICYmICFlbnYuc3VwcG9ydHNJZVBvaW50ZXIpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHZhciBlbGVtZW50ID0gaS5lbGVtZW50OwoKICAgIGZ1bmN0aW9uIHNob3VsZFByZXZlbnQoZGVsdGFYLCBkZWx0YVkpIHsKICAgICAgdmFyIHNjcm9sbFRvcCA9IE1hdGguZmxvb3IoZWxlbWVudC5zY3JvbGxUb3ApOwogICAgICB2YXIgc2Nyb2xsTGVmdCA9IGVsZW1lbnQuc2Nyb2xsTGVmdDsKICAgICAgdmFyIG1hZ25pdHVkZVggPSBNYXRoLmFicyhkZWx0YVgpOwogICAgICB2YXIgbWFnbml0dWRlWSA9IE1hdGguYWJzKGRlbHRhWSk7CgogICAgICBpZiAobWFnbml0dWRlWSA+IG1hZ25pdHVkZVgpIHsKICAgICAgICAvLyB1c2VyIGlzIHBlcmhhcHMgdHJ5aW5nIHRvIHN3aXBlIHVwL2Rvd24gdGhlIHBhZ2UKICAgICAgICBpZiAoZGVsdGFZIDwgMCAmJiBzY3JvbGxUb3AgPT09IGkuY29udGVudEhlaWdodCAtIGkuY29udGFpbmVySGVpZ2h0IHx8IGRlbHRhWSA+IDAgJiYgc2Nyb2xsVG9wID09PSAwKSB7CiAgICAgICAgICAvLyBzZXQgcHJldmVudCBmb3IgbW9iaWxlIENocm9tZSByZWZyZXNoCiAgICAgICAgICByZXR1cm4gd2luZG93LnNjcm9sbFkgPT09IDAgJiYgZGVsdGFZID4gMCAmJiBlbnYuaXNDaHJvbWU7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKG1hZ25pdHVkZVggPiBtYWduaXR1ZGVZKSB7CiAgICAgICAgLy8gdXNlciBpcyBwZXJoYXBzIHRyeWluZyB0byBzd2lwZSBsZWZ0L3JpZ2h0IGFjcm9zcyB0aGUgcGFnZQogICAgICAgIGlmIChkZWx0YVggPCAwICYmIHNjcm9sbExlZnQgPT09IGkuY29udGVudFdpZHRoIC0gaS5jb250YWluZXJXaWR0aCB8fCBkZWx0YVggPiAwICYmIHNjcm9sbExlZnQgPT09IDApIHsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gYXBwbHlUb3VjaE1vdmUoZGlmZmVyZW5jZVgsIGRpZmZlcmVuY2VZKSB7CiAgICAgIGVsZW1lbnQuc2Nyb2xsVG9wIC09IGRpZmZlcmVuY2VZOwogICAgICBlbGVtZW50LnNjcm9sbExlZnQgLT0gZGlmZmVyZW5jZVg7CiAgICAgIHVwZGF0ZUdlb21ldHJ5KGkpOwogICAgfQoKICAgIHZhciBzdGFydE9mZnNldCA9IHt9OwogICAgdmFyIHN0YXJ0VGltZSA9IDA7CiAgICB2YXIgc3BlZWQgPSB7fTsKICAgIHZhciBlYXNpbmdMb29wID0gbnVsbDsKCiAgICBmdW5jdGlvbiBnZXRUb3VjaChlKSB7CiAgICAgIGlmIChlLnRhcmdldFRvdWNoZXMpIHsKICAgICAgICByZXR1cm4gZS50YXJnZXRUb3VjaGVzWzBdOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIE1heWJlIElFIHBvaW50ZXIKICAgICAgICByZXR1cm4gZTsKICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHNob3VsZEhhbmRsZShlKSB7CiAgICAgIGlmIChlLnBvaW50ZXJUeXBlICYmIGUucG9pbnRlclR5cGUgPT09ICdwZW4nICYmIGUuYnV0dG9ucyA9PT0gMCkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgaWYgKGUudGFyZ2V0VG91Y2hlcyAmJiBlLnRhcmdldFRvdWNoZXMubGVuZ3RoID09PSAxKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KCiAgICAgIGlmIChlLnBvaW50ZXJUeXBlICYmIGUucG9pbnRlclR5cGUgIT09ICdtb3VzZScgJiYgZS5wb2ludGVyVHlwZSAhPT0gZS5NU1BPSU5URVJfVFlQRV9NT1VTRSkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgZnVuY3Rpb24gdG91Y2hTdGFydChlKSB7CiAgICAgIGlmICghc2hvdWxkSGFuZGxlKGUpKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgdG91Y2ggPSBnZXRUb3VjaChlKTsKICAgICAgc3RhcnRPZmZzZXQucGFnZVggPSB0b3VjaC5wYWdlWDsKICAgICAgc3RhcnRPZmZzZXQucGFnZVkgPSB0b3VjaC5wYWdlWTsKICAgICAgc3RhcnRUaW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7CgogICAgICBpZiAoZWFzaW5nTG9vcCAhPT0gbnVsbCkgewogICAgICAgIGNsZWFySW50ZXJ2YWwoZWFzaW5nTG9vcCk7CiAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBzaG91bGRCZUNvbnN1bWVkQnlDaGlsZCh0YXJnZXQsIGRlbHRhWCwgZGVsdGFZKSB7CiAgICAgIGlmICghZWxlbWVudC5jb250YWlucyh0YXJnZXQpKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICB2YXIgY3Vyc29yID0gdGFyZ2V0OwoKICAgICAgd2hpbGUgKGN1cnNvciAmJiBjdXJzb3IgIT09IGVsZW1lbnQpIHsKICAgICAgICBpZiAoY3Vyc29yLmNsYXNzTGlzdC5jb250YWlucyhjbHMuZWxlbWVudC5jb25zdW1pbmcpKSB7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIHZhciBzdHlsZSA9IGdldChjdXJzb3IpOyAvLyBpZiBkZWx0YVkgJiYgdmVydGljYWwgc2Nyb2xsYWJsZQoKICAgICAgICBpZiAoZGVsdGFZICYmIHN0eWxlLm92ZXJmbG93WS5tYXRjaCgvKHNjcm9sbHxhdXRvKS8pKSB7CiAgICAgICAgICB2YXIgbWF4U2Nyb2xsVG9wID0gY3Vyc29yLnNjcm9sbEhlaWdodCAtIGN1cnNvci5jbGllbnRIZWlnaHQ7CgogICAgICAgICAgaWYgKG1heFNjcm9sbFRvcCA+IDApIHsKICAgICAgICAgICAgaWYgKGN1cnNvci5zY3JvbGxUb3AgPiAwICYmIGRlbHRhWSA8IDAgfHwgY3Vyc29yLnNjcm9sbFRvcCA8IG1heFNjcm9sbFRvcCAmJiBkZWx0YVkgPiAwKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IC8vIGlmIGRlbHRhWCAmJiBob3Jpem9udGFsIHNjcm9sbGFibGUKCgogICAgICAgIGlmIChkZWx0YVggJiYgc3R5bGUub3ZlcmZsb3dYLm1hdGNoKC8oc2Nyb2xsfGF1dG8pLykpIHsKICAgICAgICAgIHZhciBtYXhTY3JvbGxMZWZ0ID0gY3Vyc29yLnNjcm9sbFdpZHRoIC0gY3Vyc29yLmNsaWVudFdpZHRoOwoKICAgICAgICAgIGlmIChtYXhTY3JvbGxMZWZ0ID4gMCkgewogICAgICAgICAgICBpZiAoY3Vyc29yLnNjcm9sbExlZnQgPiAwICYmIGRlbHRhWCA8IDAgfHwgY3Vyc29yLnNjcm9sbExlZnQgPCBtYXhTY3JvbGxMZWZ0ICYmIGRlbHRhWCA+IDApIHsKICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgY3Vyc29yID0gY3Vyc29yLnBhcmVudE5vZGU7CiAgICAgIH0KCiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBmdW5jdGlvbiB0b3VjaE1vdmUoZSkgewogICAgICBpZiAoc2hvdWxkSGFuZGxlKGUpKSB7CiAgICAgICAgdmFyIHRvdWNoID0gZ2V0VG91Y2goZSk7CiAgICAgICAgdmFyIGN1cnJlbnRPZmZzZXQgPSB7CiAgICAgICAgICBwYWdlWDogdG91Y2gucGFnZVgsCiAgICAgICAgICBwYWdlWTogdG91Y2gucGFnZVkKICAgICAgICB9OwogICAgICAgIHZhciBkaWZmZXJlbmNlWCA9IGN1cnJlbnRPZmZzZXQucGFnZVggLSBzdGFydE9mZnNldC5wYWdlWDsKICAgICAgICB2YXIgZGlmZmVyZW5jZVkgPSBjdXJyZW50T2Zmc2V0LnBhZ2VZIC0gc3RhcnRPZmZzZXQucGFnZVk7CgogICAgICAgIGlmIChzaG91bGRCZUNvbnN1bWVkQnlDaGlsZChlLnRhcmdldCwgZGlmZmVyZW5jZVgsIGRpZmZlcmVuY2VZKSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgYXBwbHlUb3VjaE1vdmUoZGlmZmVyZW5jZVgsIGRpZmZlcmVuY2VZKTsKICAgICAgICBzdGFydE9mZnNldCA9IGN1cnJlbnRPZmZzZXQ7CiAgICAgICAgdmFyIGN1cnJlbnRUaW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7CiAgICAgICAgdmFyIHRpbWVHYXAgPSBjdXJyZW50VGltZSAtIHN0YXJ0VGltZTsKCiAgICAgICAgaWYgKHRpbWVHYXAgPiAwKSB7CiAgICAgICAgICBzcGVlZC54ID0gZGlmZmVyZW5jZVggLyB0aW1lR2FwOwogICAgICAgICAgc3BlZWQueSA9IGRpZmZlcmVuY2VZIC8gdGltZUdhcDsKICAgICAgICAgIHN0YXJ0VGltZSA9IGN1cnJlbnRUaW1lOwogICAgICAgIH0KCiAgICAgICAgaWYgKHNob3VsZFByZXZlbnQoZGlmZmVyZW5jZVgsIGRpZmZlcmVuY2VZKSkgewogICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHRvdWNoRW5kKCkgewogICAgICBpZiAoaS5zZXR0aW5ncy5zd2lwZUVhc2luZykgewogICAgICAgIGNsZWFySW50ZXJ2YWwoZWFzaW5nTG9vcCk7CiAgICAgICAgZWFzaW5nTG9vcCA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGlmIChpLmlzSW5pdGlhbGl6ZWQpIHsKICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChlYXNpbmdMb29wKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICghc3BlZWQueCAmJiAhc3BlZWQueSkgewogICAgICAgICAgICBjbGVhckludGVydmFsKGVhc2luZ0xvb3ApOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKE1hdGguYWJzKHNwZWVkLngpIDwgMC4wMSAmJiBNYXRoLmFicyhzcGVlZC55KSA8IDAuMDEpIHsKICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChlYXNpbmdMb29wKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIGFwcGx5VG91Y2hNb3ZlKHNwZWVkLnggKiAzMCwgc3BlZWQueSAqIDMwKTsKICAgICAgICAgIHNwZWVkLnggKj0gMC44OwogICAgICAgICAgc3BlZWQueSAqPSAwLjg7CiAgICAgICAgfSwgMTApOwogICAgICB9CiAgICB9CgogICAgaWYgKGVudi5zdXBwb3J0c1RvdWNoKSB7CiAgICAgIGkuZXZlbnQuYmluZChlbGVtZW50LCAndG91Y2hzdGFydCcsIHRvdWNoU3RhcnQpOwogICAgICBpLmV2ZW50LmJpbmQoZWxlbWVudCwgJ3RvdWNobW92ZScsIHRvdWNoTW92ZSk7CiAgICAgIGkuZXZlbnQuYmluZChlbGVtZW50LCAndG91Y2hlbmQnLCB0b3VjaEVuZCk7CiAgICB9IGVsc2UgaWYgKGVudi5zdXBwb3J0c0llUG9pbnRlcikgewogICAgICBpZiAod2luZG93LlBvaW50ZXJFdmVudCkgewogICAgICAgIGkuZXZlbnQuYmluZChlbGVtZW50LCAncG9pbnRlcmRvd24nLCB0b3VjaFN0YXJ0KTsKICAgICAgICBpLmV2ZW50LmJpbmQoZWxlbWVudCwgJ3BvaW50ZXJtb3ZlJywgdG91Y2hNb3ZlKTsKICAgICAgICBpLmV2ZW50LmJpbmQoZWxlbWVudCwgJ3BvaW50ZXJ1cCcsIHRvdWNoRW5kKTsKICAgICAgfSBlbHNlIGlmICh3aW5kb3cuTVNQb2ludGVyRXZlbnQpIHsKICAgICAgICBpLmV2ZW50LmJpbmQoZWxlbWVudCwgJ01TUG9pbnRlckRvd24nLCB0b3VjaFN0YXJ0KTsKICAgICAgICBpLmV2ZW50LmJpbmQoZWxlbWVudCwgJ01TUG9pbnRlck1vdmUnLCB0b3VjaE1vdmUpOwogICAgICAgIGkuZXZlbnQuYmluZChlbGVtZW50LCAnTVNQb2ludGVyVXAnLCB0b3VjaEVuZCk7CiAgICAgIH0KICAgIH0KICB9CgogIHZhciBkZWZhdWx0U2V0dGluZ3MgPSBmdW5jdGlvbiBkZWZhdWx0U2V0dGluZ3MoKSB7CiAgICByZXR1cm4gewogICAgICBoYW5kbGVyczogWydjbGljay1yYWlsJywgJ2RyYWctdGh1bWInLCAna2V5Ym9hcmQnLCAnd2hlZWwnLCAndG91Y2gnXSwKICAgICAgbWF4U2Nyb2xsYmFyTGVuZ3RoOiBudWxsLAogICAgICBtaW5TY3JvbGxiYXJMZW5ndGg6IG51bGwsCiAgICAgIHNjcm9sbGluZ1RocmVzaG9sZDogMTAwMCwKICAgICAgc2Nyb2xsWE1hcmdpbk9mZnNldDogMCwKICAgICAgc2Nyb2xsWU1hcmdpbk9mZnNldDogMCwKICAgICAgc3VwcHJlc3NTY3JvbGxYOiBmYWxzZSwKICAgICAgc3VwcHJlc3NTY3JvbGxZOiBmYWxzZSwKICAgICAgc3dpcGVFYXNpbmc6IHRydWUsCiAgICAgIHVzZUJvdGhXaGVlbEF4ZXM6IGZhbHNlLAogICAgICB3aGVlbFByb3BhZ2F0aW9uOiB0cnVlLAogICAgICB3aGVlbFNwZWVkOiAxCiAgICB9OwogIH07CgogIHZhciBoYW5kbGVycyA9IHsKICAgICdjbGljay1yYWlsJzogY2xpY2tSYWlsLAogICAgJ2RyYWctdGh1bWInOiBkcmFnVGh1bWIsCiAgICBrZXlib2FyZDoga2V5Ym9hcmQsCiAgICB3aGVlbDogd2hlZWwsCiAgICB0b3VjaDogdG91Y2gKICB9OwoKICB2YXIgUGVyZmVjdFNjcm9sbGJhciA9IGZ1bmN0aW9uIFBlcmZlY3RTY3JvbGxiYXIoZWxlbWVudCwgdXNlclNldHRpbmdzKSB7CiAgICB2YXIgdGhpcyQyID0gdGhpczsKICAgIHZhciB0aGlzJDEgPSB0aGlzOwoKICAgIGlmICh1c2VyU2V0dGluZ3MgPT09IHZvaWQgMCkgewogICAgICB1c2VyU2V0dGluZ3MgPSB7fTsKICAgIH0KCiAgICBpZiAodHlwZW9mIGVsZW1lbnQgPT09ICdzdHJpbmcnKSB7CiAgICAgIGVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGVsZW1lbnQpOwogICAgfQoKICAgIGlmICghZWxlbWVudCB8fCAhZWxlbWVudC5ub2RlTmFtZSkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ25vIGVsZW1lbnQgaXMgc3BlY2lmaWVkIHRvIGluaXRpYWxpemUgUGVyZmVjdFNjcm9sbGJhcicpOwogICAgfQoKICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7CiAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoY2xzLm1haW4pOwogICAgdGhpcy5zZXR0aW5ncyA9IGRlZmF1bHRTZXR0aW5ncygpOwoKICAgIGZvciAodmFyIGtleSBpbiB1c2VyU2V0dGluZ3MpIHsKICAgICAgdGhpcyQyLnNldHRpbmdzW2tleV0gPSB1c2VyU2V0dGluZ3Nba2V5XTsKICAgIH0KCiAgICB0aGlzLmNvbnRhaW5lcldpZHRoID0gbnVsbDsKICAgIHRoaXMuY29udGFpbmVySGVpZ2h0ID0gbnVsbDsKICAgIHRoaXMuY29udGVudFdpZHRoID0gbnVsbDsKICAgIHRoaXMuY29udGVudEhlaWdodCA9IG51bGw7CgogICAgdmFyIGZvY3VzID0gZnVuY3Rpb24gZm9jdXMoKSB7CiAgICAgIHJldHVybiBlbGVtZW50LmNsYXNzTGlzdC5hZGQoY2xzLnN0YXRlLmZvY3VzKTsKICAgIH07CgogICAgdmFyIGJsdXIgPSBmdW5jdGlvbiBibHVyKCkgewogICAgICByZXR1cm4gZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGNscy5zdGF0ZS5mb2N1cyk7CiAgICB9OwoKICAgIHRoaXMuaXNSdGwgPSBnZXQoZWxlbWVudCkuZGlyZWN0aW9uID09PSAncnRsJzsKCiAgICBpZiAodGhpcy5pc1J0bCA9PT0gdHJ1ZSkgewogICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoY2xzLnJ0bCk7CiAgICB9CgogICAgdGhpcy5pc05lZ2F0aXZlU2Nyb2xsID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgb3JpZ2luYWxTY3JvbGxMZWZ0ID0gZWxlbWVudC5zY3JvbGxMZWZ0OwogICAgICB2YXIgcmVzdWx0ID0gbnVsbDsKICAgICAgZWxlbWVudC5zY3JvbGxMZWZ0ID0gLTE7CiAgICAgIHJlc3VsdCA9IGVsZW1lbnQuc2Nyb2xsTGVmdCA8IDA7CiAgICAgIGVsZW1lbnQuc2Nyb2xsTGVmdCA9IG9yaWdpbmFsU2Nyb2xsTGVmdDsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0oKTsKCiAgICB0aGlzLm5lZ2F0aXZlU2Nyb2xsQWRqdXN0bWVudCA9IHRoaXMuaXNOZWdhdGl2ZVNjcm9sbCA/IGVsZW1lbnQuc2Nyb2xsV2lkdGggLSBlbGVtZW50LmNsaWVudFdpZHRoIDogMDsKICAgIHRoaXMuZXZlbnQgPSBuZXcgRXZlbnRNYW5hZ2VyKCk7CiAgICB0aGlzLm93bmVyRG9jdW1lbnQgPSBlbGVtZW50Lm93bmVyRG9jdW1lbnQgfHwgZG9jdW1lbnQ7CiAgICB0aGlzLnNjcm9sbGJhclhSYWlsID0gZGl2KGNscy5lbGVtZW50LnJhaWwoJ3gnKSk7CiAgICBlbGVtZW50LmFwcGVuZENoaWxkKHRoaXMuc2Nyb2xsYmFyWFJhaWwpOwogICAgdGhpcy5zY3JvbGxiYXJYID0gZGl2KGNscy5lbGVtZW50LnRodW1iKCd4JykpOwogICAgdGhpcy5zY3JvbGxiYXJYUmFpbC5hcHBlbmRDaGlsZCh0aGlzLnNjcm9sbGJhclgpOwogICAgdGhpcy5zY3JvbGxiYXJYLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAwKTsKICAgIHRoaXMuZXZlbnQuYmluZCh0aGlzLnNjcm9sbGJhclgsICdmb2N1cycsIGZvY3VzKTsKICAgIHRoaXMuZXZlbnQuYmluZCh0aGlzLnNjcm9sbGJhclgsICdibHVyJywgYmx1cik7CiAgICB0aGlzLnNjcm9sbGJhclhBY3RpdmUgPSBudWxsOwogICAgdGhpcy5zY3JvbGxiYXJYV2lkdGggPSBudWxsOwogICAgdGhpcy5zY3JvbGxiYXJYTGVmdCA9IG51bGw7CiAgICB2YXIgcmFpbFhTdHlsZSA9IGdldCh0aGlzLnNjcm9sbGJhclhSYWlsKTsKICAgIHRoaXMuc2Nyb2xsYmFyWEJvdHRvbSA9IHBhcnNlSW50KHJhaWxYU3R5bGUuYm90dG9tLCAxMCk7CgogICAgaWYgKGlzTmFOKHRoaXMuc2Nyb2xsYmFyWEJvdHRvbSkpIHsKICAgICAgdGhpcy5pc1Njcm9sbGJhclhVc2luZ0JvdHRvbSA9IGZhbHNlOwogICAgICB0aGlzLnNjcm9sbGJhclhUb3AgPSB0b0ludChyYWlsWFN0eWxlLnRvcCk7CiAgICB9IGVsc2UgewogICAgICB0aGlzLmlzU2Nyb2xsYmFyWFVzaW5nQm90dG9tID0gdHJ1ZTsKICAgIH0KCiAgICB0aGlzLnJhaWxCb3JkZXJYV2lkdGggPSB0b0ludChyYWlsWFN0eWxlLmJvcmRlckxlZnRXaWR0aCkgKyB0b0ludChyYWlsWFN0eWxlLmJvcmRlclJpZ2h0V2lkdGgpOyAvLyBTZXQgcmFpbCB0byBkaXNwbGF5OmJsb2NrIHRvIGNhbGN1bGF0ZSBtYXJnaW5zCgogICAgc2V0KHRoaXMuc2Nyb2xsYmFyWFJhaWwsIHsKICAgICAgZGlzcGxheTogJ2Jsb2NrJwogICAgfSk7CiAgICB0aGlzLnJhaWxYTWFyZ2luV2lkdGggPSB0b0ludChyYWlsWFN0eWxlLm1hcmdpbkxlZnQpICsgdG9JbnQocmFpbFhTdHlsZS5tYXJnaW5SaWdodCk7CiAgICBzZXQodGhpcy5zY3JvbGxiYXJYUmFpbCwgewogICAgICBkaXNwbGF5OiAnJwogICAgfSk7CiAgICB0aGlzLnJhaWxYV2lkdGggPSBudWxsOwogICAgdGhpcy5yYWlsWFJhdGlvID0gbnVsbDsKICAgIHRoaXMuc2Nyb2xsYmFyWVJhaWwgPSBkaXYoY2xzLmVsZW1lbnQucmFpbCgneScpKTsKICAgIGVsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy5zY3JvbGxiYXJZUmFpbCk7CiAgICB0aGlzLnNjcm9sbGJhclkgPSBkaXYoY2xzLmVsZW1lbnQudGh1bWIoJ3knKSk7CiAgICB0aGlzLnNjcm9sbGJhcllSYWlsLmFwcGVuZENoaWxkKHRoaXMuc2Nyb2xsYmFyWSk7CiAgICB0aGlzLnNjcm9sbGJhclkuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsIDApOwogICAgdGhpcy5ldmVudC5iaW5kKHRoaXMuc2Nyb2xsYmFyWSwgJ2ZvY3VzJywgZm9jdXMpOwogICAgdGhpcy5ldmVudC5iaW5kKHRoaXMuc2Nyb2xsYmFyWSwgJ2JsdXInLCBibHVyKTsKICAgIHRoaXMuc2Nyb2xsYmFyWUFjdGl2ZSA9IG51bGw7CiAgICB0aGlzLnNjcm9sbGJhcllIZWlnaHQgPSBudWxsOwogICAgdGhpcy5zY3JvbGxiYXJZVG9wID0gbnVsbDsKICAgIHZhciByYWlsWVN0eWxlID0gZ2V0KHRoaXMuc2Nyb2xsYmFyWVJhaWwpOwogICAgdGhpcy5zY3JvbGxiYXJZUmlnaHQgPSBwYXJzZUludChyYWlsWVN0eWxlLnJpZ2h0LCAxMCk7CgogICAgaWYgKGlzTmFOKHRoaXMuc2Nyb2xsYmFyWVJpZ2h0KSkgewogICAgICB0aGlzLmlzU2Nyb2xsYmFyWVVzaW5nUmlnaHQgPSBmYWxzZTsKICAgICAgdGhpcy5zY3JvbGxiYXJZTGVmdCA9IHRvSW50KHJhaWxZU3R5bGUubGVmdCk7CiAgICB9IGVsc2UgewogICAgICB0aGlzLmlzU2Nyb2xsYmFyWVVzaW5nUmlnaHQgPSB0cnVlOwogICAgfQoKICAgIHRoaXMuc2Nyb2xsYmFyWU91dGVyV2lkdGggPSB0aGlzLmlzUnRsID8gb3V0ZXJXaWR0aCh0aGlzLnNjcm9sbGJhclkpIDogbnVsbDsKICAgIHRoaXMucmFpbEJvcmRlcllXaWR0aCA9IHRvSW50KHJhaWxZU3R5bGUuYm9yZGVyVG9wV2lkdGgpICsgdG9JbnQocmFpbFlTdHlsZS5ib3JkZXJCb3R0b21XaWR0aCk7CiAgICBzZXQodGhpcy5zY3JvbGxiYXJZUmFpbCwgewogICAgICBkaXNwbGF5OiAnYmxvY2snCiAgICB9KTsKICAgIHRoaXMucmFpbFlNYXJnaW5IZWlnaHQgPSB0b0ludChyYWlsWVN0eWxlLm1hcmdpblRvcCkgKyB0b0ludChyYWlsWVN0eWxlLm1hcmdpbkJvdHRvbSk7CiAgICBzZXQodGhpcy5zY3JvbGxiYXJZUmFpbCwgewogICAgICBkaXNwbGF5OiAnJwogICAgfSk7CiAgICB0aGlzLnJhaWxZSGVpZ2h0ID0gbnVsbDsKICAgIHRoaXMucmFpbFlSYXRpbyA9IG51bGw7CiAgICB0aGlzLnJlYWNoID0gewogICAgICB4OiBlbGVtZW50LnNjcm9sbExlZnQgPD0gMCA/ICdzdGFydCcgOiBlbGVtZW50LnNjcm9sbExlZnQgPj0gdGhpcy5jb250ZW50V2lkdGggLSB0aGlzLmNvbnRhaW5lcldpZHRoID8gJ2VuZCcgOiBudWxsLAogICAgICB5OiBlbGVtZW50LnNjcm9sbFRvcCA8PSAwID8gJ3N0YXJ0JyA6IGVsZW1lbnQuc2Nyb2xsVG9wID49IHRoaXMuY29udGVudEhlaWdodCAtIHRoaXMuY29udGFpbmVySGVpZ2h0ID8gJ2VuZCcgOiBudWxsCiAgICB9OwogICAgdGhpcy5pc0FsaXZlID0gdHJ1ZTsKICAgIHRoaXMuc2V0dGluZ3MuaGFuZGxlcnMuZm9yRWFjaChmdW5jdGlvbiAoaGFuZGxlck5hbWUpIHsKICAgICAgcmV0dXJuIGhhbmRsZXJzW2hhbmRsZXJOYW1lXSh0aGlzJDEpOwogICAgfSk7CiAgICB0aGlzLmxhc3RTY3JvbGxUb3AgPSBNYXRoLmZsb29yKGVsZW1lbnQuc2Nyb2xsVG9wKTsgLy8gZm9yIG9uU2Nyb2xsIG9ubHkKCiAgICB0aGlzLmxhc3RTY3JvbGxMZWZ0ID0gZWxlbWVudC5zY3JvbGxMZWZ0OyAvLyBmb3Igb25TY3JvbGwgb25seQoKICAgIHRoaXMuZXZlbnQuYmluZCh0aGlzLmVsZW1lbnQsICdzY3JvbGwnLCBmdW5jdGlvbiAoZSkgewogICAgICByZXR1cm4gdGhpcyQxLm9uU2Nyb2xsKGUpOwogICAgfSk7CiAgICB1cGRhdGVHZW9tZXRyeSh0aGlzKTsKICB9OwoKICBQZXJmZWN0U2Nyb2xsYmFyLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiB1cGRhdGUoKSB7CiAgICBpZiAoIXRoaXMuaXNBbGl2ZSkgewogICAgICByZXR1cm47CiAgICB9IC8vIFJlY2FsY3VhdGUgbmVnYXRpdmUgc2Nyb2xsTGVmdCBhZGp1c3RtZW50CgoKICAgIHRoaXMubmVnYXRpdmVTY3JvbGxBZGp1c3RtZW50ID0gdGhpcy5pc05lZ2F0aXZlU2Nyb2xsID8gdGhpcy5lbGVtZW50LnNjcm9sbFdpZHRoIC0gdGhpcy5lbGVtZW50LmNsaWVudFdpZHRoIDogMDsgLy8gUmVjYWxjdWxhdGUgcmFpbCBtYXJnaW5zCgogICAgc2V0KHRoaXMuc2Nyb2xsYmFyWFJhaWwsIHsKICAgICAgZGlzcGxheTogJ2Jsb2NrJwogICAgfSk7CiAgICBzZXQodGhpcy5zY3JvbGxiYXJZUmFpbCwgewogICAgICBkaXNwbGF5OiAnYmxvY2snCiAgICB9KTsKICAgIHRoaXMucmFpbFhNYXJnaW5XaWR0aCA9IHRvSW50KGdldCh0aGlzLnNjcm9sbGJhclhSYWlsKS5tYXJnaW5MZWZ0KSArIHRvSW50KGdldCh0aGlzLnNjcm9sbGJhclhSYWlsKS5tYXJnaW5SaWdodCk7CiAgICB0aGlzLnJhaWxZTWFyZ2luSGVpZ2h0ID0gdG9JbnQoZ2V0KHRoaXMuc2Nyb2xsYmFyWVJhaWwpLm1hcmdpblRvcCkgKyB0b0ludChnZXQodGhpcy5zY3JvbGxiYXJZUmFpbCkubWFyZ2luQm90dG9tKTsgLy8gSGlkZSBzY3JvbGxiYXJzIG5vdCB0byBhZmZlY3Qgc2Nyb2xsV2lkdGggYW5kIHNjcm9sbEhlaWdodAoKICAgIHNldCh0aGlzLnNjcm9sbGJhclhSYWlsLCB7CiAgICAgIGRpc3BsYXk6ICdub25lJwogICAgfSk7CiAgICBzZXQodGhpcy5zY3JvbGxiYXJZUmFpbCwgewogICAgICBkaXNwbGF5OiAnbm9uZScKICAgIH0pOwogICAgdXBkYXRlR2VvbWV0cnkodGhpcyk7CiAgICBwcm9jZXNzU2Nyb2xsRGlmZih0aGlzLCAndG9wJywgMCwgZmFsc2UsIHRydWUpOwogICAgcHJvY2Vzc1Njcm9sbERpZmYodGhpcywgJ2xlZnQnLCAwLCBmYWxzZSwgdHJ1ZSk7CiAgICBzZXQodGhpcy5zY3JvbGxiYXJYUmFpbCwgewogICAgICBkaXNwbGF5OiAnJwogICAgfSk7CiAgICBzZXQodGhpcy5zY3JvbGxiYXJZUmFpbCwgewogICAgICBkaXNwbGF5OiAnJwogICAgfSk7CiAgfTsKCiAgUGVyZmVjdFNjcm9sbGJhci5wcm90b3R5cGUub25TY3JvbGwgPSBmdW5jdGlvbiBvblNjcm9sbChlKSB7CiAgICBpZiAoIXRoaXMuaXNBbGl2ZSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdXBkYXRlR2VvbWV0cnkodGhpcyk7CiAgICBwcm9jZXNzU2Nyb2xsRGlmZih0aGlzLCAndG9wJywgdGhpcy5lbGVtZW50LnNjcm9sbFRvcCAtIHRoaXMubGFzdFNjcm9sbFRvcCk7CiAgICBwcm9jZXNzU2Nyb2xsRGlmZih0aGlzLCAnbGVmdCcsIHRoaXMuZWxlbWVudC5zY3JvbGxMZWZ0IC0gdGhpcy5sYXN0U2Nyb2xsTGVmdCk7CiAgICB0aGlzLmxhc3RTY3JvbGxUb3AgPSBNYXRoLmZsb29yKHRoaXMuZWxlbWVudC5zY3JvbGxUb3ApOwogICAgdGhpcy5sYXN0U2Nyb2xsTGVmdCA9IHRoaXMuZWxlbWVudC5zY3JvbGxMZWZ0OwogIH07CgogIFBlcmZlY3RTY3JvbGxiYXIucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbiBkZXN0cm95KCkgewogICAgaWYgKCF0aGlzLmlzQWxpdmUpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRoaXMuZXZlbnQudW5iaW5kQWxsKCk7CiAgICByZW1vdmUodGhpcy5zY3JvbGxiYXJYKTsKICAgIHJlbW92ZSh0aGlzLnNjcm9sbGJhclkpOwogICAgcmVtb3ZlKHRoaXMuc2Nyb2xsYmFyWFJhaWwpOwogICAgcmVtb3ZlKHRoaXMuc2Nyb2xsYmFyWVJhaWwpOwogICAgdGhpcy5yZW1vdmVQc0NsYXNzZXMoKTsgLy8gdW5zZXQgZWxlbWVudHMKCiAgICB0aGlzLmVsZW1lbnQgPSBudWxsOwogICAgdGhpcy5zY3JvbGxiYXJYID0gbnVsbDsKICAgIHRoaXMuc2Nyb2xsYmFyWSA9IG51bGw7CiAgICB0aGlzLnNjcm9sbGJhclhSYWlsID0gbnVsbDsKICAgIHRoaXMuc2Nyb2xsYmFyWVJhaWwgPSBudWxsOwogICAgdGhpcy5pc0FsaXZlID0gZmFsc2U7CiAgfTsKCiAgUGVyZmVjdFNjcm9sbGJhci5wcm90b3R5cGUucmVtb3ZlUHNDbGFzc2VzID0gZnVuY3Rpb24gcmVtb3ZlUHNDbGFzc2VzKCkgewogICAgdGhpcy5lbGVtZW50LmNsYXNzTmFtZSA9IHRoaXMuZWxlbWVudC5jbGFzc05hbWUuc3BsaXQoJyAnKS5maWx0ZXIoZnVuY3Rpb24gKG5hbWUpIHsKICAgICAgcmV0dXJuICFuYW1lLm1hdGNoKC9ecHMoWy1fXS4rfCkkLyk7CiAgICB9KS5qb2luKCcgJyk7CiAgfTsKCiAgdmFyIFBlcmZlY3RTY3JvbGxiYXIkMSA9IHsKICAgIG5hbWU6ICdQZXJmZWN0U2Nyb2xsYmFyJywKICAgIHByb3BzOiB7CiAgICAgIG9wdGlvbnM6IHsKICAgICAgICB0eXBlOiBPYmplY3QsCiAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLAogICAgICAgIGRlZmF1bHQ6IGZ1bmN0aW9uIF9kZWZhdWx0KCkge30KICAgICAgfSwKICAgICAgdGFnOiB7CiAgICAgICAgdHlwZTogU3RyaW5nLAogICAgICAgIHJlcXVpcmVkOiBmYWxzZSwKICAgICAgICBkZWZhdWx0OiAnZGl2JwogICAgICB9LAogICAgICB3YXRjaE9wdGlvbnM6IHsKICAgICAgICB0eXBlOiBCb29sZWFuLAogICAgICAgIHJlcXVpcmVkOiBmYWxzZSwKICAgICAgICBkZWZhdWx0OiBmYWxzZQogICAgICB9CiAgICB9LAogICAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBwczogbnVsbAogICAgICB9OwogICAgfSwKICAgIHdhdGNoOiB7CiAgICAgIHdhdGNoT3B0aW9uczogZnVuY3Rpb24gd2F0Y2hPcHRpb25zKHNob3VsZFdhdGNoKSB7CiAgICAgICAgaWYgKCFzaG91bGRXYXRjaCAmJiB0aGlzLndhdGNoZXIpIHsKICAgICAgICAgIHRoaXMud2F0Y2hlcigpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLmNyZWF0ZVdhdGNoZXIoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkgewogICAgICB0aGlzLmNyZWF0ZSgpOwoKICAgICAgaWYgKHRoaXMud2F0Y2hPcHRpb25zKSB7CiAgICAgICAgdGhpcy5jcmVhdGVXYXRjaGVyKCk7CiAgICAgIH0KICAgIH0sCiAgICB1cGRhdGVkOiBmdW5jdGlvbiB1cGRhdGVkKCkgewogICAgICB2YXIgdGhpcyQxID0gdGhpczsKICAgICAgdGhpcy4kbmV4dFRpY2soZnVuY3Rpb24gKCkgewogICAgICAgIHRoaXMkMS51cGRhdGUoKTsKICAgICAgfSk7CiAgICB9LAogICAgYmVmb3JlRGVzdHJveTogZnVuY3Rpb24gYmVmb3JlRGVzdHJveSgpIHsKICAgICAgdGhpcy5kZXN0cm95KCk7CiAgICB9LAogICAgbWV0aG9kczogewogICAgICBjcmVhdGU6IGZ1bmN0aW9uIGNyZWF0ZSgpIHsKICAgICAgICBpZiAoISh0aGlzLnBzICYmIHRoaXMuJGlzU2VydmVyKSkgewogICAgICAgICAgdGhpcy5wcyA9IG5ldyBQZXJmZWN0U2Nyb2xsYmFyKHRoaXMuJHJlZnMuY29udGFpbmVyLCB0aGlzLm9wdGlvbnMpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgY3JlYXRlV2F0Y2hlcjogZnVuY3Rpb24gY3JlYXRlV2F0Y2hlcigpIHsKICAgICAgICB2YXIgdGhpcyQxID0gdGhpczsKICAgICAgICB0aGlzLndhdGNoZXIgPSB0aGlzLiR3YXRjaCgnb3B0aW9ucycsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHRoaXMkMS5kZXN0cm95KCk7CiAgICAgICAgICB0aGlzJDEuY3JlYXRlKCk7CiAgICAgICAgfSwgewogICAgICAgICAgZGVlcDogdHJ1ZQogICAgICAgIH0pOwogICAgICB9LAogICAgICB1cGRhdGU6IGZ1bmN0aW9uIHVwZGF0ZSgpIHsKICAgICAgICBpZiAodGhpcy5wcykgewogICAgICAgICAgdGhpcy5wcy51cGRhdGUoKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGRlc3Ryb3k6IGZ1bmN0aW9uIGRlc3Ryb3koKSB7CiAgICAgICAgaWYgKHRoaXMucHMpIHsKICAgICAgICAgIHRoaXMucHMuZGVzdHJveSgpOwogICAgICAgICAgdGhpcy5wcyA9IG51bGw7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIoaCkgewogICAgICByZXR1cm4gaCh0aGlzLnRhZywgewogICAgICAgIHJlZjogJ2NvbnRhaW5lcicsCiAgICAgICAgY2xhc3M6ICdwcycsCiAgICAgICAgb246IHRoaXMuJGxpc3RlbmVycwogICAgICB9LCB0aGlzLiRzbG90cy5kZWZhdWx0KTsKICAgIH0KICB9OwoKICBmdW5jdGlvbiBpbnN0YWxsKFZ1ZSwgc2V0dGluZ3MpIHsKICAgIGlmIChzZXR0aW5ncykgewogICAgICBpZiAoc2V0dGluZ3MubmFtZSAmJiB0eXBlb2Ygc2V0dGluZ3MubmFtZSA9PT0gJ3N0cmluZycpIHsKICAgICAgICBQZXJmZWN0U2Nyb2xsYmFyJDEubmFtZSA9IHNldHRpbmdzLm5hbWU7CiAgICAgIH0KCiAgICAgIGlmIChzZXR0aW5ncy5vcHRpb25zICYmIF90eXBlb2Yoc2V0dGluZ3Mub3B0aW9ucykgPT09ICdvYmplY3QnKSB7CiAgICAgICAgUGVyZmVjdFNjcm9sbGJhciQxLnByb3BzLm9wdGlvbnMuZGVmYXVsdCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBzZXR0aW5ncy5vcHRpb25zOwogICAgICAgIH07CiAgICAgIH0KCiAgICAgIGlmIChzZXR0aW5ncy50YWcgJiYgdHlwZW9mIHNldHRpbmdzLnRhZyA9PT0gJ3N0cmluZycpIHsKICAgICAgICBQZXJmZWN0U2Nyb2xsYmFyJDEucHJvcHMudGFnLmRlZmF1bHQgPSBzZXR0aW5ncy50YWc7CiAgICAgIH0KCiAgICAgIGlmIChzZXR0aW5ncy53YXRjaE9wdGlvbnMgJiYgdHlwZW9mIHNldHRpbmdzLndhdGNoT3B0aW9ucyA9PT0gJ2Jvb2xlYW4nKSB7CiAgICAgICAgUGVyZmVjdFNjcm9sbGJhciQxLnByb3BzLndhdGNoT3B0aW9ucyA9IHNldHRpbmdzLndhdGNoT3B0aW9uczsKICAgICAgfQogICAgfQoKICAgIFZ1ZS5jb21wb25lbnQoUGVyZmVjdFNjcm9sbGJhciQxLm5hbWUsIFBlcmZlY3RTY3JvbGxiYXIkMSk7CiAgfQoKICBleHBvcnRzLmluc3RhbGwgPSBpbnN0YWxsOwogIGV4cG9ydHMuUGVyZmVjdFNjcm9sbGJhciA9IFBlcmZlY3RTY3JvbGxiYXIkMTsKICBleHBvcnRzLmRlZmF1bHQgPSBpbnN0YWxsOwogIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsKICAgIHZhbHVlOiB0cnVlCiAgfSk7Cn0pOw=="},null]}