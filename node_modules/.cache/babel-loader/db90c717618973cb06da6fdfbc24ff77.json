{"remainingRequest":"/media/ernst/63bce43c-5e51-4bf1-a611-3afdf32ac6f6/VueJS/IPTV-Tools/node_modules/thread-loader/dist/cjs.js!/media/ernst/63bce43c-5e51-4bf1-a611-3afdf32ac6f6/VueJS/IPTV-Tools/node_modules/babel-loader/lib/index.js!/media/ernst/63bce43c-5e51-4bf1-a611-3afdf32ac6f6/VueJS/IPTV-Tools/node_modules/vuedraggable/dist/vuedraggable.umd.js","dependencies":[{"path":"/media/ernst/63bce43c-5e51-4bf1-a611-3afdf32ac6f6/VueJS/IPTV-Tools/node_modules/vuedraggable/dist/vuedraggable.umd.js","mtime":499162500000},{"path":"/media/ernst/63bce43c-5e51-4bf1-a611-3afdf32ac6f6/VueJS/IPTV-Tools/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/media/ernst/63bce43c-5e51-4bf1-a611-3afdf32ac6f6/VueJS/IPTV-Tools/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/media/ernst/63bce43c-5e51-4bf1-a611-3afdf32ac6f6/VueJS/IPTV-Tools/node_modules/babel-loader/lib/index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF90eXBlb2YgPSByZXF1aXJlKCIvbWVkaWEvZXJuc3QvNjNiY2U0M2MtNWU1MS00YmYxLWE2MTEtM2FmZGYzMmFjNmY2L1Z1ZUpTL0lQVFYtVG9vbHMvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvdHlwZW9mIikuZGVmYXVsdDsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zeW1ib2wuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zeW1ib2wuZGVzY3JpcHRpb24uanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLnRvLXN0cmluZy10YWcuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5qc29uLnRvLXN0cmluZy10YWcuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5tYXRoLnRvLXN0cmluZy10YWcuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLml0ZXJhdG9yLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNsaWNlLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmtleXMuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5yZXBsYWNlLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnNwbGl0LmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmNvbnN0cnVjdG9yLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLnRvLXN0cmluZy5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmpvaW4uanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZ2V0LXByb3RvdHlwZS1vZi5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5jb25jYXQuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuc3RhcnRzLXdpdGguanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcubWF0Y2guanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zeW1ib2wuaXRlcmF0b3IuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaXRlcmF0b3IuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5mcm9tLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5jbHVkZXMuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zcGxpY2UuanMiKTsKCihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7CiAgaWYgKCh0eXBlb2YgZXhwb3J0cyA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2YoZXhwb3J0cykpID09PSAnb2JqZWN0JyAmJiAodHlwZW9mIG1vZHVsZSA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2YobW9kdWxlKSkgPT09ICdvYmplY3QnKSBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkocmVxdWlyZSgic29ydGFibGVqcyIpKTtlbHNlIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIGRlZmluZShbInNvcnRhYmxlanMiXSwgZmFjdG9yeSk7ZWxzZSBpZiAoKHR5cGVvZiBleHBvcnRzID09PSAidW5kZWZpbmVkIiA/ICJ1bmRlZmluZWQiIDogX3R5cGVvZihleHBvcnRzKSkgPT09ICdvYmplY3QnKSBleHBvcnRzWyJ2dWVkcmFnZ2FibGUiXSA9IGZhY3RvcnkocmVxdWlyZSgic29ydGFibGVqcyIpKTtlbHNlIHJvb3RbInZ1ZWRyYWdnYWJsZSJdID0gZmFjdG9yeShyb290WyJTb3J0YWJsZSJdKTsKfSkodHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnID8gc2VsZiA6IHRoaXMsIGZ1bmN0aW9uIChfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX2EzNTJfXykgewogIHJldHVybiAoCiAgICAvKioqKioqLwogICAgZnVuY3Rpb24gKG1vZHVsZXMpIHsKICAgICAgLy8gd2VicGFja0Jvb3RzdHJhcAoKICAgICAgLyoqKioqKi8KICAgICAgLy8gVGhlIG1vZHVsZSBjYWNoZQoKICAgICAgLyoqKioqKi8KICAgICAgdmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTsKICAgICAgLyoqKioqKi8KCiAgICAgIC8qKioqKiovCiAgICAgIC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uCgogICAgICAvKioqKioqLwoKICAgICAgZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkgewogICAgICAgIC8qKioqKiovCgogICAgICAgIC8qKioqKiovCiAgICAgICAgLy8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlCgogICAgICAgIC8qKioqKiovCiAgICAgICAgaWYgKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7CiAgICAgICAgICAvKioqKioqLwogICAgICAgICAgcmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7CiAgICAgICAgICAvKioqKioqLwogICAgICAgIH0KICAgICAgICAvKioqKioqLwogICAgICAgIC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpCgogICAgICAgIC8qKioqKiovCgoKICAgICAgICB2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7CiAgICAgICAgICAvKioqKioqLwogICAgICAgICAgaTogbW9kdWxlSWQsCgogICAgICAgICAgLyoqKioqKi8KICAgICAgICAgIGw6IGZhbHNlLAoKICAgICAgICAgIC8qKioqKiovCiAgICAgICAgICBleHBvcnRzOiB7fQogICAgICAgICAgLyoqKioqKi8KCiAgICAgICAgfTsKICAgICAgICAvKioqKioqLwoKICAgICAgICAvKioqKioqLwogICAgICAgIC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvbgoKICAgICAgICAvKioqKioqLwoKICAgICAgICBtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTsKICAgICAgICAvKioqKioqLwoKICAgICAgICAvKioqKioqLwogICAgICAgIC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWQKCiAgICAgICAgLyoqKioqKi8KCiAgICAgICAgbW9kdWxlLmwgPSB0cnVlOwogICAgICAgIC8qKioqKiovCgogICAgICAgIC8qKioqKiovCiAgICAgICAgLy8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGUKCiAgICAgICAgLyoqKioqKi8KCiAgICAgICAgcmV0dXJuIG1vZHVsZS5leHBvcnRzOwogICAgICAgIC8qKioqKiovCiAgICAgIH0KICAgICAgLyoqKioqKi8KCiAgICAgIC8qKioqKiovCgogICAgICAvKioqKioqLwogICAgICAvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKQoKICAgICAgLyoqKioqKi8KCgogICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzOwogICAgICAvKioqKioqLwoKICAgICAgLyoqKioqKi8KICAgICAgLy8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGUKCiAgICAgIC8qKioqKiovCgogICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzOwogICAgICAvKioqKioqLwoKICAgICAgLyoqKioqKi8KICAgICAgLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzCgogICAgICAvKioqKioqLwoKICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24gKGV4cG9ydHMsIG5hbWUsIGdldHRlcikgewogICAgICAgIC8qKioqKiovCiAgICAgICAgaWYgKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHsKICAgICAgICAgIC8qKioqKiovCiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBnZXQ6IGdldHRlcgogICAgICAgICAgfSk7CiAgICAgICAgICAvKioqKioqLwogICAgICAgIH0KICAgICAgICAvKioqKioqLwoKICAgICAgfTsKICAgICAgLyoqKioqKi8KCiAgICAgIC8qKioqKiovCiAgICAgIC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHMKCiAgICAgIC8qKioqKiovCgoKICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICAgICAgICAvKioqKioqLwogICAgICAgIGlmICh0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHsKICAgICAgICAgIC8qKioqKiovCiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7CiAgICAgICAgICAgIHZhbHVlOiAnTW9kdWxlJwogICAgICAgICAgfSk7CiAgICAgICAgICAvKioqKioqLwogICAgICAgIH0KICAgICAgICAvKioqKioqLwoKCiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgewogICAgICAgICAgdmFsdWU6IHRydWUKICAgICAgICB9KTsKICAgICAgICAvKioqKioqLwogICAgICB9OwogICAgICAvKioqKioqLwoKICAgICAgLyoqKioqKi8KICAgICAgLy8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0CgogICAgICAvKioqKioqLwogICAgICAvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXQKCiAgICAgIC8qKioqKiovCiAgICAgIC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBucwoKICAgICAgLyoqKioqKi8KICAgICAgLy8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0CgogICAgICAvKioqKioqLwogICAgICAvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlCgogICAgICAvKioqKioqLwoKCiAgICAgIF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uICh2YWx1ZSwgbW9kZSkgewogICAgICAgIC8qKioqKiovCiAgICAgICAgaWYgKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpOwogICAgICAgIC8qKioqKiovCgogICAgICAgIGlmIChtb2RlICYgOCkgcmV0dXJuIHZhbHVlOwogICAgICAgIC8qKioqKiovCgogICAgICAgIGlmIChtb2RlICYgNCAmJiBfdHlwZW9mKHZhbHVlKSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlOwogICAgICAgIC8qKioqKiovCgogICAgICAgIHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgICAgICAgLyoqKioqKi8KCiAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTsKICAgICAgICAvKioqKioqLwoKCiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsKICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICB2YWx1ZTogdmFsdWUKICAgICAgICB9KTsKICAgICAgICAvKioqKioqLwoKICAgICAgICBpZiAobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IgKHZhciBrZXkgaW4gdmFsdWUpIHsKICAgICAgICAgIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgICAgIHJldHVybiB2YWx1ZVtrZXldOwogICAgICAgICAgfS5iaW5kKG51bGwsIGtleSkpOwogICAgICAgIH0KICAgICAgICAvKioqKioqLwoKICAgICAgICByZXR1cm4gbnM7CiAgICAgICAgLyoqKioqKi8KICAgICAgfTsKICAgICAgLyoqKioqKi8KCiAgICAgIC8qKioqKiovCiAgICAgIC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzCgogICAgICAvKioqKioqLwoKCiAgICAgIF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uIChtb2R1bGUpIHsKICAgICAgICAvKioqKioqLwogICAgICAgIHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgPwogICAgICAgIC8qKioqKiovCiAgICAgICAgZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsKICAgICAgICAgIHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsKICAgICAgICB9IDoKICAgICAgICAvKioqKioqLwogICAgICAgIGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7CiAgICAgICAgICByZXR1cm4gbW9kdWxlOwogICAgICAgIH07CiAgICAgICAgLyoqKioqKi8KCiAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpOwogICAgICAgIC8qKioqKiovCgoKICAgICAgICByZXR1cm4gZ2V0dGVyOwogICAgICAgIC8qKioqKiovCiAgICAgIH07CiAgICAgIC8qKioqKiovCgogICAgICAvKioqKioqLwogICAgICAvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwKCiAgICAgIC8qKioqKiovCgoKICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24gKG9iamVjdCwgcHJvcGVydHkpIHsKICAgICAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOwogICAgICB9OwogICAgICAvKioqKioqLwoKICAgICAgLyoqKioqKi8KICAgICAgLy8gX193ZWJwYWNrX3B1YmxpY19wYXRoX18KCiAgICAgIC8qKioqKiovCgoKICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gIiI7CiAgICAgIC8qKioqKiovCgogICAgICAvKioqKioqLwoKICAgICAgLyoqKioqKi8KICAgICAgLy8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzCgogICAgICAvKioqKioqLwoKICAgICAgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gImZiMTUiKTsKICAgICAgLyoqKioqKi8KICAgIH0oCiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwoKICAgIC8qKioqKiovCiAgICB7CiAgICAgIC8qKiovCiAgICAgICIwMWY5IjoKICAgICAgLyoqKi8KICAgICAgZnVuY3Rpb24gZjkobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CiAgICAgICAgInVzZSBzdHJpY3QiOwoKICAgICAgICB2YXIgTElCUkFSWSA9IF9fd2VicGFja19yZXF1aXJlX18oIjJkMDAiKTsKCiAgICAgICAgdmFyICRleHBvcnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCI1Y2ExIik7CgogICAgICAgIHZhciByZWRlZmluZSA9IF9fd2VicGFja19yZXF1aXJlX18oIjJhYmEiKTsKCiAgICAgICAgdmFyIGhpZGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCIzMmU5Iik7CgogICAgICAgIHZhciBJdGVyYXRvcnMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCI4NGYyIik7CgogICAgICAgIHZhciAkaXRlckNyZWF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oIjQxYTAiKTsKCiAgICAgICAgdmFyIHNldFRvU3RyaW5nVGFnID0gX193ZWJwYWNrX3JlcXVpcmVfXygiN2YyMCIpOwoKICAgICAgICB2YXIgZ2V0UHJvdG90eXBlT2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCIzOGZkIik7CgogICAgICAgIHZhciBJVEVSQVRPUiA9IF9fd2VicGFja19yZXF1aXJlX18oIjJiNGMiKSgnaXRlcmF0b3InKTsKCiAgICAgICAgdmFyIEJVR0dZID0gIShbXS5rZXlzICYmICduZXh0JyBpbiBbXS5rZXlzKCkpOyAvLyBTYWZhcmkgaGFzIGJ1Z2d5IGl0ZXJhdG9ycyB3L28gYG5leHRgCgogICAgICAgIHZhciBGRl9JVEVSQVRPUiA9ICdAQGl0ZXJhdG9yJzsKICAgICAgICB2YXIgS0VZUyA9ICdrZXlzJzsKICAgICAgICB2YXIgVkFMVUVTID0gJ3ZhbHVlcyc7CgogICAgICAgIHZhciByZXR1cm5UaGlzID0gZnVuY3Rpb24gcmV0dXJuVGhpcygpIHsKICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgIH07CgogICAgICAgIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKEJhc2UsIE5BTUUsIENvbnN0cnVjdG9yLCBuZXh0LCBERUZBVUxULCBJU19TRVQsIEZPUkNFRCkgewogICAgICAgICAgJGl0ZXJDcmVhdGUoQ29uc3RydWN0b3IsIE5BTUUsIG5leHQpOwoKICAgICAgICAgIHZhciBnZXRNZXRob2QgPSBmdW5jdGlvbiBnZXRNZXRob2Qoa2luZCkgewogICAgICAgICAgICBpZiAoIUJVR0dZICYmIGtpbmQgaW4gcHJvdG8pIHJldHVybiBwcm90b1traW5kXTsKCiAgICAgICAgICAgIHN3aXRjaCAoa2luZCkgewogICAgICAgICAgICAgIGNhc2UgS0VZUzoKICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiBrZXlzKCkgewogICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbnN0cnVjdG9yKHRoaXMsIGtpbmQpOwogICAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgY2FzZSBWQUxVRVM6CiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gdmFsdWVzKCkgewogICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbnN0cnVjdG9yKHRoaXMsIGtpbmQpOwogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIGVudHJpZXMoKSB7CiAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb25zdHJ1Y3Rvcih0aGlzLCBraW5kKTsKICAgICAgICAgICAgfTsKICAgICAgICAgIH07CgogICAgICAgICAgdmFyIFRBRyA9IE5BTUUgKyAnIEl0ZXJhdG9yJzsKICAgICAgICAgIHZhciBERUZfVkFMVUVTID0gREVGQVVMVCA9PSBWQUxVRVM7CiAgICAgICAgICB2YXIgVkFMVUVTX0JVRyA9IGZhbHNlOwogICAgICAgICAgdmFyIHByb3RvID0gQmFzZS5wcm90b3R5cGU7CiAgICAgICAgICB2YXIgJG5hdGl2ZSA9IHByb3RvW0lURVJBVE9SXSB8fCBwcm90b1tGRl9JVEVSQVRPUl0gfHwgREVGQVVMVCAmJiBwcm90b1tERUZBVUxUXTsKICAgICAgICAgIHZhciAkZGVmYXVsdCA9ICRuYXRpdmUgfHwgZ2V0TWV0aG9kKERFRkFVTFQpOwogICAgICAgICAgdmFyICRlbnRyaWVzID0gREVGQVVMVCA/ICFERUZfVkFMVUVTID8gJGRlZmF1bHQgOiBnZXRNZXRob2QoJ2VudHJpZXMnKSA6IHVuZGVmaW5lZDsKICAgICAgICAgIHZhciAkYW55TmF0aXZlID0gTkFNRSA9PSAnQXJyYXknID8gcHJvdG8uZW50cmllcyB8fCAkbmF0aXZlIDogJG5hdGl2ZTsKICAgICAgICAgIHZhciBtZXRob2RzLCBrZXksIEl0ZXJhdG9yUHJvdG90eXBlOyAvLyBGaXggbmF0aXZlCgogICAgICAgICAgaWYgKCRhbnlOYXRpdmUpIHsKICAgICAgICAgICAgSXRlcmF0b3JQcm90b3R5cGUgPSBnZXRQcm90b3R5cGVPZigkYW55TmF0aXZlLmNhbGwobmV3IEJhc2UoKSkpOwoKICAgICAgICAgICAgaWYgKEl0ZXJhdG9yUHJvdG90eXBlICE9PSBPYmplY3QucHJvdG90eXBlICYmIEl0ZXJhdG9yUHJvdG90eXBlLm5leHQpIHsKICAgICAgICAgICAgICAvLyBTZXQgQEB0b1N0cmluZ1RhZyB0byBuYXRpdmUgaXRlcmF0b3JzCiAgICAgICAgICAgICAgc2V0VG9TdHJpbmdUYWcoSXRlcmF0b3JQcm90b3R5cGUsIFRBRywgdHJ1ZSk7IC8vIGZpeCBmb3Igc29tZSBvbGQgZW5naW5lcwoKICAgICAgICAgICAgICBpZiAoIUxJQlJBUlkgJiYgdHlwZW9mIEl0ZXJhdG9yUHJvdG90eXBlW0lURVJBVE9SXSAhPSAnZnVuY3Rpb24nKSBoaWRlKEl0ZXJhdG9yUHJvdG90eXBlLCBJVEVSQVRPUiwgcmV0dXJuVGhpcyk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gLy8gZml4IEFycmF5I3t2YWx1ZXMsIEBAaXRlcmF0b3J9Lm5hbWUgaW4gVjggLyBGRgoKCiAgICAgICAgICBpZiAoREVGX1ZBTFVFUyAmJiAkbmF0aXZlICYmICRuYXRpdmUubmFtZSAhPT0gVkFMVUVTKSB7CiAgICAgICAgICAgIFZBTFVFU19CVUcgPSB0cnVlOwoKICAgICAgICAgICAgJGRlZmF1bHQgPSBmdW5jdGlvbiB2YWx1ZXMoKSB7CiAgICAgICAgICAgICAgcmV0dXJuICRuYXRpdmUuY2FsbCh0aGlzKTsKICAgICAgICAgICAgfTsKICAgICAgICAgIH0gLy8gRGVmaW5lIGl0ZXJhdG9yCgoKICAgICAgICAgIGlmICgoIUxJQlJBUlkgfHwgRk9SQ0VEKSAmJiAoQlVHR1kgfHwgVkFMVUVTX0JVRyB8fCAhcHJvdG9bSVRFUkFUT1JdKSkgewogICAgICAgICAgICBoaWRlKHByb3RvLCBJVEVSQVRPUiwgJGRlZmF1bHQpOwogICAgICAgICAgfSAvLyBQbHVnIGZvciBsaWJyYXJ5CgoKICAgICAgICAgIEl0ZXJhdG9yc1tOQU1FXSA9ICRkZWZhdWx0OwogICAgICAgICAgSXRlcmF0b3JzW1RBR10gPSByZXR1cm5UaGlzOwoKICAgICAgICAgIGlmIChERUZBVUxUKSB7CiAgICAgICAgICAgIG1ldGhvZHMgPSB7CiAgICAgICAgICAgICAgdmFsdWVzOiBERUZfVkFMVUVTID8gJGRlZmF1bHQgOiBnZXRNZXRob2QoVkFMVUVTKSwKICAgICAgICAgICAgICBrZXlzOiBJU19TRVQgPyAkZGVmYXVsdCA6IGdldE1ldGhvZChLRVlTKSwKICAgICAgICAgICAgICBlbnRyaWVzOiAkZW50cmllcwogICAgICAgICAgICB9OwogICAgICAgICAgICBpZiAoRk9SQ0VEKSBmb3IgKGtleSBpbiBtZXRob2RzKSB7CiAgICAgICAgICAgICAgaWYgKCEoa2V5IGluIHByb3RvKSkgcmVkZWZpbmUocHJvdG8sIGtleSwgbWV0aG9kc1trZXldKTsKICAgICAgICAgICAgfSBlbHNlICRleHBvcnQoJGV4cG9ydC5QICsgJGV4cG9ydC5GICogKEJVR0dZIHx8IFZBTFVFU19CVUcpLCBOQU1FLCBtZXRob2RzKTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gbWV0aG9kczsKICAgICAgICB9OwogICAgICAgIC8qKiovCgogICAgICB9LAoKICAgICAgLyoqKi8KICAgICAgIjAyZjQiOgogICAgICAvKioqLwogICAgICBmdW5jdGlvbiBmNChtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKICAgICAgICB2YXIgdG9JbnRlZ2VyID0gX193ZWJwYWNrX3JlcXVpcmVfXygiNDU4OCIpOwoKICAgICAgICB2YXIgZGVmaW5lZCA9IF9fd2VicGFja19yZXF1aXJlX18oImJlMTMiKTsgLy8gdHJ1ZSAgLT4gU3RyaW5nI2F0CiAgICAgICAgLy8gZmFsc2UgLT4gU3RyaW5nI2NvZGVQb2ludEF0CgoKICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChUT19TVFJJTkcpIHsKICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAodGhhdCwgcG9zKSB7CiAgICAgICAgICAgIHZhciBzID0gU3RyaW5nKGRlZmluZWQodGhhdCkpOwogICAgICAgICAgICB2YXIgaSA9IHRvSW50ZWdlcihwb3MpOwogICAgICAgICAgICB2YXIgbCA9IHMubGVuZ3RoOwogICAgICAgICAgICB2YXIgYSwgYjsKICAgICAgICAgICAgaWYgKGkgPCAwIHx8IGkgPj0gbCkgcmV0dXJuIFRPX1NUUklORyA/ICcnIDogdW5kZWZpbmVkOwogICAgICAgICAgICBhID0gcy5jaGFyQ29kZUF0KGkpOwogICAgICAgICAgICByZXR1cm4gYSA8IDB4ZDgwMCB8fCBhID4gMHhkYmZmIHx8IGkgKyAxID09PSBsIHx8IChiID0gcy5jaGFyQ29kZUF0KGkgKyAxKSkgPCAweGRjMDAgfHwgYiA+IDB4ZGZmZiA/IFRPX1NUUklORyA/IHMuY2hhckF0KGkpIDogYSA6IFRPX1NUUklORyA/IHMuc2xpY2UoaSwgaSArIDIpIDogKGEgLSAweGQ4MDAgPDwgMTApICsgKGIgLSAweGRjMDApICsgMHgxMDAwMDsKICAgICAgICAgIH07CiAgICAgICAgfTsKICAgICAgICAvKioqLwoKICAgICAgfSwKCiAgICAgIC8qKiovCiAgICAgICIwMzkwIjoKICAgICAgLyoqKi8KICAgICAgZnVuY3Rpb24gXyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKICAgICAgICAidXNlIHN0cmljdCI7CgogICAgICAgIHZhciBhdCA9IF9fd2VicGFja19yZXF1aXJlX18oIjAyZjQiKSh0cnVlKTsgLy8gYEFkdmFuY2VTdHJpbmdJbmRleGAgYWJzdHJhY3Qgb3BlcmF0aW9uCiAgICAgICAgLy8gaHR0cHM6Ly90YzM5LmdpdGh1Yi5pby9lY21hMjYyLyNzZWMtYWR2YW5jZXN0cmluZ2luZGV4CgoKICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChTLCBpbmRleCwgdW5pY29kZSkgewogICAgICAgICAgcmV0dXJuIGluZGV4ICsgKHVuaWNvZGUgPyBhdChTLCBpbmRleCkubGVuZ3RoIDogMSk7CiAgICAgICAgfTsKICAgICAgICAvKioqLwoKICAgICAgfSwKCiAgICAgIC8qKiovCiAgICAgICIwYmZiIjoKICAgICAgLyoqKi8KICAgICAgZnVuY3Rpb24gYmZiKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewogICAgICAgICJ1c2Ugc3RyaWN0IjsgLy8gMjEuMi41LjMgZ2V0IFJlZ0V4cC5wcm90b3R5cGUuZmxhZ3MKCiAgICAgICAgdmFyIGFuT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygiY2I3YyIpOwoKICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciB0aGF0ID0gYW5PYmplY3QodGhpcyk7CiAgICAgICAgICB2YXIgcmVzdWx0ID0gJyc7CiAgICAgICAgICBpZiAodGhhdC5nbG9iYWwpIHJlc3VsdCArPSAnZyc7CiAgICAgICAgICBpZiAodGhhdC5pZ25vcmVDYXNlKSByZXN1bHQgKz0gJ2knOwogICAgICAgICAgaWYgKHRoYXQubXVsdGlsaW5lKSByZXN1bHQgKz0gJ20nOwogICAgICAgICAgaWYgKHRoYXQudW5pY29kZSkgcmVzdWx0ICs9ICd1JzsKICAgICAgICAgIGlmICh0aGF0LnN0aWNreSkgcmVzdWx0ICs9ICd5JzsKICAgICAgICAgIHJldHVybiByZXN1bHQ7CiAgICAgICAgfTsKICAgICAgICAvKioqLwoKICAgICAgfSwKCiAgICAgIC8qKiovCiAgICAgICIwZDU4IjoKICAgICAgLyoqKi8KICAgICAgZnVuY3Rpb24gZDU4KG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewogICAgICAgIC8vIDE5LjEuMi4xNCAvIDE1LjIuMy4xNCBPYmplY3Qua2V5cyhPKQogICAgICAgIHZhciAka2V5cyA9IF9fd2VicGFja19yZXF1aXJlX18oImNlMTAiKTsKCiAgICAgICAgdmFyIGVudW1CdWdLZXlzID0gX193ZWJwYWNrX3JlcXVpcmVfXygiZTExZSIpOwoKICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IE9iamVjdC5rZXlzIHx8IGZ1bmN0aW9uIGtleXMoTykgewogICAgICAgICAgcmV0dXJuICRrZXlzKE8sIGVudW1CdWdLZXlzKTsKICAgICAgICB9OwogICAgICAgIC8qKiovCgogICAgICB9LAoKICAgICAgLyoqKi8KICAgICAgIjE0OTUiOgogICAgICAvKioqLwogICAgICBmdW5jdGlvbiBfKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewogICAgICAgIHZhciBkUCA9IF9fd2VicGFja19yZXF1aXJlX18oIjg2Y2MiKTsKCiAgICAgICAgdmFyIGFuT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygiY2I3YyIpOwoKICAgICAgICB2YXIgZ2V0S2V5cyA9IF9fd2VicGFja19yZXF1aXJlX18oIjBkNTgiKTsKCiAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCI5ZTFlIikgPyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyA6IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXMoTywgUHJvcGVydGllcykgewogICAgICAgICAgYW5PYmplY3QoTyk7CiAgICAgICAgICB2YXIga2V5cyA9IGdldEtleXMoUHJvcGVydGllcyk7CiAgICAgICAgICB2YXIgbGVuZ3RoID0ga2V5cy5sZW5ndGg7CiAgICAgICAgICB2YXIgaSA9IDA7CiAgICAgICAgICB2YXIgUDsKCiAgICAgICAgICB3aGlsZSAobGVuZ3RoID4gaSkgewogICAgICAgICAgICBkUC5mKE8sIFAgPSBrZXlzW2krK10sIFByb3BlcnRpZXNbUF0pOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBPOwogICAgICAgIH07CiAgICAgICAgLyoqKi8KICAgICAgfSwKCiAgICAgIC8qKiovCiAgICAgICIyMTRmIjoKICAgICAgLyoqKi8KICAgICAgZnVuY3Rpb24gZihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKICAgICAgICAidXNlIHN0cmljdCI7CgogICAgICAgIF9fd2VicGFja19yZXF1aXJlX18oImIwYzUiKTsKCiAgICAgICAgdmFyIHJlZGVmaW5lID0gX193ZWJwYWNrX3JlcXVpcmVfXygiMmFiYSIpOwoKICAgICAgICB2YXIgaGlkZSA9IF9fd2VicGFja19yZXF1aXJlX18oIjMyZTkiKTsKCiAgICAgICAgdmFyIGZhaWxzID0gX193ZWJwYWNrX3JlcXVpcmVfXygiNzllNSIpOwoKICAgICAgICB2YXIgZGVmaW5lZCA9IF9fd2VicGFja19yZXF1aXJlX18oImJlMTMiKTsKCiAgICAgICAgdmFyIHdrcyA9IF9fd2VicGFja19yZXF1aXJlX18oIjJiNGMiKTsKCiAgICAgICAgdmFyIHJlZ2V4cEV4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCI1MjBhIik7CgogICAgICAgIHZhciBTUEVDSUVTID0gd2tzKCdzcGVjaWVzJyk7CiAgICAgICAgdmFyIFJFUExBQ0VfU1VQUE9SVFNfTkFNRURfR1JPVVBTID0gIWZhaWxzKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIC8vICNyZXBsYWNlIG5lZWRzIGJ1aWx0LWluIHN1cHBvcnQgZm9yIG5hbWVkIGdyb3Vwcy4KICAgICAgICAgIC8vICNtYXRjaCB3b3JrcyBmaW5lIGJlY2F1c2UgaXQganVzdCByZXR1cm4gdGhlIGV4ZWMgcmVzdWx0cywgZXZlbiBpZiBpdCBoYXMKICAgICAgICAgIC8vIGEgImdyb3BzIiBwcm9wZXJ0eS4KICAgICAgICAgIHZhciByZSA9IC8uLzsKCiAgICAgICAgICByZS5leGVjID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgcmVzdWx0ID0gW107CiAgICAgICAgICAgIHJlc3VsdC5ncm91cHMgPSB7CiAgICAgICAgICAgICAgYTogJzcnCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7CiAgICAgICAgICB9OwoKICAgICAgICAgIHJldHVybiAnJy5yZXBsYWNlKHJlLCAnJDxhPicpICE9PSAnNyc7CiAgICAgICAgfSk7CgogICAgICAgIHZhciBTUExJVF9XT1JLU19XSVRIX09WRVJXUklUVEVOX0VYRUMgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAvLyBDaHJvbWUgNTEgaGFzIGEgYnVnZ3kgInNwbGl0IiBpbXBsZW1lbnRhdGlvbiB3aGVuIFJlZ0V4cCNleGVjICE9PSBuYXRpdmVFeGVjCiAgICAgICAgICB2YXIgcmUgPSAvKD86KS87CiAgICAgICAgICB2YXIgb3JpZ2luYWxFeGVjID0gcmUuZXhlYzsKCiAgICAgICAgICByZS5leGVjID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gb3JpZ2luYWxFeGVjLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICB9OwoKICAgICAgICAgIHZhciByZXN1bHQgPSAnYWInLnNwbGl0KHJlKTsKICAgICAgICAgIHJldHVybiByZXN1bHQubGVuZ3RoID09PSAyICYmIHJlc3VsdFswXSA9PT0gJ2EnICYmIHJlc3VsdFsxXSA9PT0gJ2InOwogICAgICAgIH0oKTsKCiAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoS0VZLCBsZW5ndGgsIGV4ZWMpIHsKICAgICAgICAgIHZhciBTWU1CT0wgPSB3a3MoS0VZKTsKICAgICAgICAgIHZhciBERUxFR0FURVNfVE9fU1lNQk9MID0gIWZhaWxzKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgLy8gU3RyaW5nIG1ldGhvZHMgY2FsbCBzeW1ib2wtbmFtZWQgUmVnRXAgbWV0aG9kcwogICAgICAgICAgICB2YXIgTyA9IHt9OwoKICAgICAgICAgICAgT1tTWU1CT0xdID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHJldHVybiA3OwogICAgICAgICAgICB9OwoKICAgICAgICAgICAgcmV0dXJuICcnW0tFWV0oTykgIT0gNzsKICAgICAgICAgIH0pOwogICAgICAgICAgdmFyIERFTEVHQVRFU19UT19FWEVDID0gREVMRUdBVEVTX1RPX1NZTUJPTCA/ICFmYWlscyhmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIC8vIFN5bWJvbC1uYW1lZCBSZWdFeHAgbWV0aG9kcyBjYWxsIC5leGVjCiAgICAgICAgICAgIHZhciBleGVjQ2FsbGVkID0gZmFsc2U7CiAgICAgICAgICAgIHZhciByZSA9IC9hLzsKCiAgICAgICAgICAgIHJlLmV4ZWMgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgZXhlY0NhbGxlZCA9IHRydWU7CiAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgIH07CgogICAgICAgICAgICBpZiAoS0VZID09PSAnc3BsaXQnKSB7CiAgICAgICAgICAgICAgLy8gUmVnRXhwW0BAc3BsaXRdIGRvZXNuJ3QgY2FsbCB0aGUgcmVnZXgncyBleGVjIG1ldGhvZCwgYnV0IGZpcnN0IGNyZWF0ZXMKICAgICAgICAgICAgICAvLyBhIG5ldyBvbmUuIFdlIG5lZWQgdG8gcmV0dXJuIHRoZSBwYXRjaGVkIHJlZ2V4IHdoZW4gY3JlYXRpbmcgdGhlIG5ldyBvbmUuCiAgICAgICAgICAgICAgcmUuY29uc3RydWN0b3IgPSB7fTsKCiAgICAgICAgICAgICAgcmUuY29uc3RydWN0b3JbU1BFQ0lFU10gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gcmU7CiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmVbU1lNQk9MXSgnJyk7CiAgICAgICAgICAgIHJldHVybiAhZXhlY0NhbGxlZDsKICAgICAgICAgIH0pIDogdW5kZWZpbmVkOwoKICAgICAgICAgIGlmICghREVMRUdBVEVTX1RPX1NZTUJPTCB8fCAhREVMRUdBVEVTX1RPX0VYRUMgfHwgS0VZID09PSAncmVwbGFjZScgJiYgIVJFUExBQ0VfU1VQUE9SVFNfTkFNRURfR1JPVVBTIHx8IEtFWSA9PT0gJ3NwbGl0JyAmJiAhU1BMSVRfV09SS1NfV0lUSF9PVkVSV1JJVFRFTl9FWEVDKSB7CiAgICAgICAgICAgIHZhciBuYXRpdmVSZWdFeHBNZXRob2QgPSAvLi9bU1lNQk9MXTsKICAgICAgICAgICAgdmFyIGZucyA9IGV4ZWMoZGVmaW5lZCwgU1lNQk9MLCAnJ1tLRVldLCBmdW5jdGlvbiBtYXliZUNhbGxOYXRpdmUobmF0aXZlTWV0aG9kLCByZWdleHAsIHN0ciwgYXJnMiwgZm9yY2VTdHJpbmdNZXRob2QpIHsKICAgICAgICAgICAgICBpZiAocmVnZXhwLmV4ZWMgPT09IHJlZ2V4cEV4ZWMpIHsKICAgICAgICAgICAgICAgIGlmIChERUxFR0FURVNfVE9fU1lNQk9MICYmICFmb3JjZVN0cmluZ01ldGhvZCkgewogICAgICAgICAgICAgICAgICAvLyBUaGUgbmF0aXZlIFN0cmluZyBtZXRob2QgYWxyZWFkeSBkZWxlZ2F0ZXMgdG8gQEBtZXRob2QgKHRoaXMKICAgICAgICAgICAgICAgICAgLy8gcG9seWZpbGxlZCBmdW5jdGlvbiksIGxlYXNpbmcgdG8gaW5maW5pdGUgcmVjdXJzaW9uLgogICAgICAgICAgICAgICAgICAvLyBXZSBhdm9pZCBpdCBieSBkaXJlY3RseSBjYWxsaW5nIHRoZSBuYXRpdmUgQEBtZXRob2QgbWV0aG9kLgogICAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICAgIGRvbmU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IG5hdGl2ZVJlZ0V4cE1ldGhvZC5jYWxsKHJlZ2V4cCwgc3RyLCBhcmcyKQogICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgIGRvbmU6IHRydWUsCiAgICAgICAgICAgICAgICAgIHZhbHVlOiBuYXRpdmVNZXRob2QuY2FsbChzdHIsIHJlZ2V4cCwgYXJnMikKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgZG9uZTogZmFsc2UKICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgdmFyIHN0cmZuID0gZm5zWzBdOwogICAgICAgICAgICB2YXIgcnhmbiA9IGZuc1sxXTsKICAgICAgICAgICAgcmVkZWZpbmUoU3RyaW5nLnByb3RvdHlwZSwgS0VZLCBzdHJmbik7CiAgICAgICAgICAgIGhpZGUoUmVnRXhwLnByb3RvdHlwZSwgU1lNQk9MLCBsZW5ndGggPT0gMiAvLyAyMS4yLjUuOCBSZWdFeHAucHJvdG90eXBlW0BAcmVwbGFjZV0oc3RyaW5nLCByZXBsYWNlVmFsdWUpCiAgICAgICAgICAgIC8vIDIxLjIuNS4xMSBSZWdFeHAucHJvdG90eXBlW0BAc3BsaXRdKHN0cmluZywgbGltaXQpCiAgICAgICAgICAgID8gZnVuY3Rpb24gKHN0cmluZywgYXJnKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHJ4Zm4uY2FsbChzdHJpbmcsIHRoaXMsIGFyZyk7CiAgICAgICAgICAgIH0gLy8gMjEuMi41LjYgUmVnRXhwLnByb3RvdHlwZVtAQG1hdGNoXShzdHJpbmcpCiAgICAgICAgICAgIC8vIDIxLjIuNS45IFJlZ0V4cC5wcm90b3R5cGVbQEBzZWFyY2hdKHN0cmluZykKICAgICAgICAgICAgOiBmdW5jdGlvbiAoc3RyaW5nKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHJ4Zm4uY2FsbChzdHJpbmcsIHRoaXMpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIC8qKiovCgogICAgICB9LAoKICAgICAgLyoqKi8KICAgICAgIjIzMGUiOgogICAgICAvKioqLwogICAgICBmdW5jdGlvbiBlKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewogICAgICAgIHZhciBpc09iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oImQzZjQiKTsKCiAgICAgICAgdmFyIGRvY3VtZW50ID0gX193ZWJwYWNrX3JlcXVpcmVfXygiNzcyNiIpLmRvY3VtZW50OyAvLyB0eXBlb2YgZG9jdW1lbnQuY3JlYXRlRWxlbWVudCBpcyAnb2JqZWN0JyBpbiBvbGQgSUUKCgogICAgICAgIHZhciBpcyA9IGlzT2JqZWN0KGRvY3VtZW50KSAmJiBpc09iamVjdChkb2N1bWVudC5jcmVhdGVFbGVtZW50KTsKCiAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXQpIHsKICAgICAgICAgIHJldHVybiBpcyA/IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoaXQpIDoge307CiAgICAgICAgfTsKICAgICAgICAvKioqLwoKICAgICAgfSwKCiAgICAgIC8qKiovCiAgICAgICIyM2M2IjoKICAgICAgLyoqKi8KICAgICAgZnVuY3Rpb24gYzYobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CiAgICAgICAgLy8gZ2V0dGluZyB0YWcgZnJvbSAxOS4xLjMuNiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nKCkKICAgICAgICB2YXIgY29mID0gX193ZWJwYWNrX3JlcXVpcmVfXygiMmQ5NSIpOwoKICAgICAgICB2YXIgVEFHID0gX193ZWJwYWNrX3JlcXVpcmVfXygiMmI0YyIpKCd0b1N0cmluZ1RhZycpOyAvLyBFUzMgd3JvbmcgaGVyZQoKCiAgICAgICAgdmFyIEFSRyA9IGNvZihmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gYXJndW1lbnRzOwogICAgICAgIH0oKSkgPT0gJ0FyZ3VtZW50cyc7IC8vIGZhbGxiYWNrIGZvciBJRTExIFNjcmlwdCBBY2Nlc3MgRGVuaWVkIGVycm9yCgogICAgICAgIHZhciB0cnlHZXQgPSBmdW5jdGlvbiB0cnlHZXQoaXQsIGtleSkgewogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgcmV0dXJuIGl0W2tleV07CiAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgIC8qIGVtcHR5ICovCiAgICAgICAgICB9CiAgICAgICAgfTsKCiAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXQpIHsKICAgICAgICAgIHZhciBPLCBULCBCOwogICAgICAgICAgcmV0dXJuIGl0ID09PSB1bmRlZmluZWQgPyAnVW5kZWZpbmVkJyA6IGl0ID09PSBudWxsID8gJ051bGwnIC8vIEBAdG9TdHJpbmdUYWcgY2FzZQogICAgICAgICAgOiB0eXBlb2YgKFQgPSB0cnlHZXQoTyA9IE9iamVjdChpdCksIFRBRykpID09ICdzdHJpbmcnID8gVCAvLyBidWlsdGluVGFnIGNhc2UKICAgICAgICAgIDogQVJHID8gY29mKE8pIC8vIEVTMyBhcmd1bWVudHMgZmFsbGJhY2sKICAgICAgICAgIDogKEIgPSBjb2YoTykpID09ICdPYmplY3QnICYmIHR5cGVvZiBPLmNhbGxlZSA9PSAnZnVuY3Rpb24nID8gJ0FyZ3VtZW50cycgOiBCOwogICAgICAgIH07CiAgICAgICAgLyoqKi8KCiAgICAgIH0sCgogICAgICAvKioqLwogICAgICAiMjYyMSI6CiAgICAgIC8qKiovCiAgICAgIGZ1bmN0aW9uIF8obW9kdWxlLCBleHBvcnRzKSB7CiAgICAgICAgZXhwb3J0cy5mID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9sczsKICAgICAgICAvKioqLwogICAgICB9LAoKICAgICAgLyoqKi8KICAgICAgIjJhYmEiOgogICAgICAvKioqLwogICAgICBmdW5jdGlvbiBhYmEobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CiAgICAgICAgdmFyIGdsb2JhbCA9IF9fd2VicGFja19yZXF1aXJlX18oIjc3MjYiKTsKCiAgICAgICAgdmFyIGhpZGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCIzMmU5Iik7CgogICAgICAgIHZhciBoYXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCI2OWE4Iik7CgogICAgICAgIHZhciBTUkMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCJjYTVhIikoJ3NyYycpOwoKICAgICAgICB2YXIgJHRvU3RyaW5nID0gX193ZWJwYWNrX3JlcXVpcmVfXygiZmE1YiIpOwoKICAgICAgICB2YXIgVE9fU1RSSU5HID0gJ3RvU3RyaW5nJzsKICAgICAgICB2YXIgVFBMID0gKCcnICsgJHRvU3RyaW5nKS5zcGxpdChUT19TVFJJTkcpOwoKICAgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKCI4Mzc4IikuaW5zcGVjdFNvdXJjZSA9IGZ1bmN0aW9uIChpdCkgewogICAgICAgICAgcmV0dXJuICR0b1N0cmluZy5jYWxsKGl0KTsKICAgICAgICB9OwoKICAgICAgICAobW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoTywga2V5LCB2YWwsIHNhZmUpIHsKICAgICAgICAgIHZhciBpc0Z1bmN0aW9uID0gdHlwZW9mIHZhbCA9PSAnZnVuY3Rpb24nOwogICAgICAgICAgaWYgKGlzRnVuY3Rpb24pIGhhcyh2YWwsICduYW1lJykgfHwgaGlkZSh2YWwsICduYW1lJywga2V5KTsKICAgICAgICAgIGlmIChPW2tleV0gPT09IHZhbCkgcmV0dXJuOwogICAgICAgICAgaWYgKGlzRnVuY3Rpb24pIGhhcyh2YWwsIFNSQykgfHwgaGlkZSh2YWwsIFNSQywgT1trZXldID8gJycgKyBPW2tleV0gOiBUUEwuam9pbihTdHJpbmcoa2V5KSkpOwoKICAgICAgICAgIGlmIChPID09PSBnbG9iYWwpIHsKICAgICAgICAgICAgT1trZXldID0gdmFsOwogICAgICAgICAgfSBlbHNlIGlmICghc2FmZSkgewogICAgICAgICAgICBkZWxldGUgT1trZXldOwogICAgICAgICAgICBoaWRlKE8sIGtleSwgdmFsKTsKICAgICAgICAgIH0gZWxzZSBpZiAoT1trZXldKSB7CiAgICAgICAgICAgIE9ba2V5XSA9IHZhbDsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGhpZGUoTywga2V5LCB2YWwpOwogICAgICAgICAgfSAvLyBhZGQgZmFrZSBGdW5jdGlvbiN0b1N0cmluZyBmb3IgY29ycmVjdCB3b3JrIHdyYXBwZWQgbWV0aG9kcyAvIGNvbnN0cnVjdG9ycyB3aXRoIG1ldGhvZHMgbGlrZSBMb0Rhc2ggaXNOYXRpdmUKCiAgICAgICAgfSkoRnVuY3Rpb24ucHJvdG90eXBlLCBUT19TVFJJTkcsIGZ1bmN0aW9uIHRvU3RyaW5nKCkgewogICAgICAgICAgcmV0dXJuIHR5cGVvZiB0aGlzID09ICdmdW5jdGlvbicgJiYgdGhpc1tTUkNdIHx8ICR0b1N0cmluZy5jYWxsKHRoaXMpOwogICAgICAgIH0pOwogICAgICAgIC8qKiovCiAgICAgIH0sCgogICAgICAvKioqLwogICAgICAiMmFlYiI6CiAgICAgIC8qKiovCiAgICAgIGZ1bmN0aW9uIGFlYihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKICAgICAgICAvLyAxOS4xLjIuMiAvIDE1LjIuMy41IE9iamVjdC5jcmVhdGUoTyBbLCBQcm9wZXJ0aWVzXSkKICAgICAgICB2YXIgYW5PYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCJjYjdjIik7CgogICAgICAgIHZhciBkUHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCIxNDk1Iik7CgogICAgICAgIHZhciBlbnVtQnVnS2V5cyA9IF9fd2VicGFja19yZXF1aXJlX18oImUxMWUiKTsKCiAgICAgICAgdmFyIElFX1BST1RPID0gX193ZWJwYWNrX3JlcXVpcmVfXygiNjEzYiIpKCdJRV9QUk9UTycpOwoKICAgICAgICB2YXIgRW1wdHkgPSBmdW5jdGlvbiBFbXB0eSgpIHsKICAgICAgICAgIC8qIGVtcHR5ICovCiAgICAgICAgfTsKCiAgICAgICAgdmFyIFBST1RPVFlQRSA9ICdwcm90b3R5cGUnOyAvLyBDcmVhdGUgb2JqZWN0IHdpdGggZmFrZSBgbnVsbGAgcHJvdG90eXBlOiB1c2UgaWZyYW1lIE9iamVjdCB3aXRoIGNsZWFyZWQgcHJvdG90eXBlCgogICAgICAgIHZhciBfY3JlYXRlRGljdCA9IGZ1bmN0aW9uIGNyZWF0ZURpY3QoKSB7CiAgICAgICAgICAvLyBUaHJhc2gsIHdhc3RlIGFuZCBzb2RvbXk6IElFIEdDIGJ1ZwogICAgICAgICAgdmFyIGlmcmFtZSA9IF9fd2VicGFja19yZXF1aXJlX18oIjIzMGUiKSgnaWZyYW1lJyk7CgogICAgICAgICAgdmFyIGkgPSBlbnVtQnVnS2V5cy5sZW5ndGg7CiAgICAgICAgICB2YXIgbHQgPSAnPCc7CiAgICAgICAgICB2YXIgZ3QgPSAnPic7CiAgICAgICAgICB2YXIgaWZyYW1lRG9jdW1lbnQ7CiAgICAgICAgICBpZnJhbWUuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKCiAgICAgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKCJmYWIyIikuYXBwZW5kQ2hpbGQoaWZyYW1lKTsKCiAgICAgICAgICBpZnJhbWUuc3JjID0gJ2phdmFzY3JpcHQ6JzsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1zY3JpcHQtdXJsCiAgICAgICAgICAvLyBjcmVhdGVEaWN0ID0gaWZyYW1lLmNvbnRlbnRXaW5kb3cuT2JqZWN0OwogICAgICAgICAgLy8gaHRtbC5yZW1vdmVDaGlsZChpZnJhbWUpOwoKICAgICAgICAgIGlmcmFtZURvY3VtZW50ID0gaWZyYW1lLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQ7CiAgICAgICAgICBpZnJhbWVEb2N1bWVudC5vcGVuKCk7CiAgICAgICAgICBpZnJhbWVEb2N1bWVudC53cml0ZShsdCArICdzY3JpcHQnICsgZ3QgKyAnZG9jdW1lbnQuRj1PYmplY3QnICsgbHQgKyAnL3NjcmlwdCcgKyBndCk7CiAgICAgICAgICBpZnJhbWVEb2N1bWVudC5jbG9zZSgpOwogICAgICAgICAgX2NyZWF0ZURpY3QgPSBpZnJhbWVEb2N1bWVudC5GOwoKICAgICAgICAgIHdoaWxlIChpLS0pIHsKICAgICAgICAgICAgZGVsZXRlIF9jcmVhdGVEaWN0W1BST1RPVFlQRV1bZW51bUJ1Z0tleXNbaV1dOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBfY3JlYXRlRGljdCgpOwogICAgICAgIH07CgogICAgICAgIG1vZHVsZS5leHBvcnRzID0gT2JqZWN0LmNyZWF0ZSB8fCBmdW5jdGlvbiBjcmVhdGUoTywgUHJvcGVydGllcykgewogICAgICAgICAgdmFyIHJlc3VsdDsKCiAgICAgICAgICBpZiAoTyAhPT0gbnVsbCkgewogICAgICAgICAgICBFbXB0eVtQUk9UT1RZUEVdID0gYW5PYmplY3QoTyk7CiAgICAgICAgICAgIHJlc3VsdCA9IG5ldyBFbXB0eSgpOwogICAgICAgICAgICBFbXB0eVtQUk9UT1RZUEVdID0gbnVsbDsgLy8gYWRkICJfX3Byb3RvX18iIGZvciBPYmplY3QuZ2V0UHJvdG90eXBlT2YgcG9seWZpbGwKCiAgICAgICAgICAgIHJlc3VsdFtJRV9QUk9UT10gPSBPOwogICAgICAgICAgfSBlbHNlIHJlc3VsdCA9IF9jcmVhdGVEaWN0KCk7CgogICAgICAgICAgcmV0dXJuIFByb3BlcnRpZXMgPT09IHVuZGVmaW5lZCA/IHJlc3VsdCA6IGRQcyhyZXN1bHQsIFByb3BlcnRpZXMpOwogICAgICAgIH07CiAgICAgICAgLyoqKi8KCiAgICAgIH0sCgogICAgICAvKioqLwogICAgICAiMmI0YyI6CiAgICAgIC8qKiovCiAgICAgIGZ1bmN0aW9uIGI0Yyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKICAgICAgICB2YXIgc3RvcmUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCI1NTM3IikoJ3drcycpOwoKICAgICAgICB2YXIgdWlkID0gX193ZWJwYWNrX3JlcXVpcmVfXygiY2E1YSIpOwoKICAgICAgICB2YXIgX1N5bWJvbCA9IF9fd2VicGFja19yZXF1aXJlX18oIjc3MjYiKS5TeW1ib2w7CgogICAgICAgIHZhciBVU0VfU1lNQk9MID0gdHlwZW9mIF9TeW1ib2wgPT0gJ2Z1bmN0aW9uJzsKCiAgICAgICAgdmFyICRleHBvcnRzID0gbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAobmFtZSkgewogICAgICAgICAgcmV0dXJuIHN0b3JlW25hbWVdIHx8IChzdG9yZVtuYW1lXSA9IFVTRV9TWU1CT0wgJiYgX1N5bWJvbFtuYW1lXSB8fCAoVVNFX1NZTUJPTCA/IF9TeW1ib2wgOiB1aWQpKCdTeW1ib2wuJyArIG5hbWUpKTsKICAgICAgICB9OwoKICAgICAgICAkZXhwb3J0cy5zdG9yZSA9IHN0b3JlOwogICAgICAgIC8qKiovCiAgICAgIH0sCgogICAgICAvKioqLwogICAgICAiMmQwMCI6CiAgICAgIC8qKiovCiAgICAgIGZ1bmN0aW9uIGQwMChtb2R1bGUsIGV4cG9ydHMpIHsKICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGZhbHNlOwogICAgICAgIC8qKiovCiAgICAgIH0sCgogICAgICAvKioqLwogICAgICAiMmQ5NSI6CiAgICAgIC8qKiovCiAgICAgIGZ1bmN0aW9uIGQ5NShtb2R1bGUsIGV4cG9ydHMpIHsKICAgICAgICB2YXIgdG9TdHJpbmcgPSB7fS50b1N0cmluZzsKCiAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXQpIHsKICAgICAgICAgIHJldHVybiB0b1N0cmluZy5jYWxsKGl0KS5zbGljZSg4LCAtMSk7CiAgICAgICAgfTsKICAgICAgICAvKioqLwoKICAgICAgfSwKCiAgICAgIC8qKiovCiAgICAgICIyZmRiIjoKICAgICAgLyoqKi8KICAgICAgZnVuY3Rpb24gZmRiKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewogICAgICAgICJ1c2Ugc3RyaWN0IjsgLy8gMjEuMS4zLjcgU3RyaW5nLnByb3RvdHlwZS5pbmNsdWRlcyhzZWFyY2hTdHJpbmcsIHBvc2l0aW9uID0gMCkKCiAgICAgICAgdmFyICRleHBvcnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCI1Y2ExIik7CgogICAgICAgIHZhciBjb250ZXh0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygiZDJjOCIpOwoKICAgICAgICB2YXIgSU5DTFVERVMgPSAnaW5jbHVkZXMnOwogICAgICAgICRleHBvcnQoJGV4cG9ydC5QICsgJGV4cG9ydC5GICogX193ZWJwYWNrX3JlcXVpcmVfXygiNTE0NyIpKElOQ0xVREVTKSwgJ1N0cmluZycsIHsKICAgICAgICAgIGluY2x1ZGVzOiBmdW5jdGlvbiBpbmNsdWRlcyhzZWFyY2hTdHJpbmcKICAgICAgICAgIC8qICwgcG9zaXRpb24gPSAwICovCiAgICAgICAgICApIHsKICAgICAgICAgICAgcmV0dXJuICEhfmNvbnRleHQodGhpcywgc2VhcmNoU3RyaW5nLCBJTkNMVURFUykuaW5kZXhPZihzZWFyY2hTdHJpbmcsIGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICAvKioqLwogICAgICB9LAoKICAgICAgLyoqKi8KICAgICAgIjMyZTkiOgogICAgICAvKioqLwogICAgICBmdW5jdGlvbiBlOShtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKICAgICAgICB2YXIgZFAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCI4NmNjIik7CgogICAgICAgIHZhciBjcmVhdGVEZXNjID0gX193ZWJwYWNrX3JlcXVpcmVfXygiNDYzMCIpOwoKICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oIjllMWUiKSA/IGZ1bmN0aW9uIChvYmplY3QsIGtleSwgdmFsdWUpIHsKICAgICAgICAgIHJldHVybiBkUC5mKG9iamVjdCwga2V5LCBjcmVhdGVEZXNjKDEsIHZhbHVlKSk7CiAgICAgICAgfSA6IGZ1bmN0aW9uIChvYmplY3QsIGtleSwgdmFsdWUpIHsKICAgICAgICAgIG9iamVjdFtrZXldID0gdmFsdWU7CiAgICAgICAgICByZXR1cm4gb2JqZWN0OwogICAgICAgIH07CiAgICAgICAgLyoqKi8KICAgICAgfSwKCiAgICAgIC8qKiovCiAgICAgICIzOGZkIjoKICAgICAgLyoqKi8KICAgICAgZnVuY3Rpb24gZmQobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CiAgICAgICAgLy8gMTkuMS4yLjkgLyAxNS4yLjMuMiBPYmplY3QuZ2V0UHJvdG90eXBlT2YoTykKICAgICAgICB2YXIgaGFzID0gX193ZWJwYWNrX3JlcXVpcmVfXygiNjlhOCIpOwoKICAgICAgICB2YXIgdG9PYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCI0YmY4Iik7CgogICAgICAgIHZhciBJRV9QUk9UTyA9IF9fd2VicGFja19yZXF1aXJlX18oIjYxM2IiKSgnSUVfUFJPVE8nKTsKCiAgICAgICAgdmFyIE9iamVjdFByb3RvID0gT2JqZWN0LnByb3RvdHlwZTsKCiAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gKE8pIHsKICAgICAgICAgIE8gPSB0b09iamVjdChPKTsKICAgICAgICAgIGlmIChoYXMoTywgSUVfUFJPVE8pKSByZXR1cm4gT1tJRV9QUk9UT107CgogICAgICAgICAgaWYgKHR5cGVvZiBPLmNvbnN0cnVjdG9yID09ICdmdW5jdGlvbicgJiYgTyBpbnN0YW5jZW9mIE8uY29uc3RydWN0b3IpIHsKICAgICAgICAgICAgcmV0dXJuIE8uY29uc3RydWN0b3IucHJvdG90eXBlOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBPIGluc3RhbmNlb2YgT2JqZWN0ID8gT2JqZWN0UHJvdG8gOiBudWxsOwogICAgICAgIH07CiAgICAgICAgLyoqKi8KCiAgICAgIH0sCgogICAgICAvKioqLwogICAgICAiNDFhMCI6CiAgICAgIC8qKiovCiAgICAgIGZ1bmN0aW9uIGEwKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewogICAgICAgICJ1c2Ugc3RyaWN0IjsKCiAgICAgICAgdmFyIGNyZWF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oIjJhZWIiKTsKCiAgICAgICAgdmFyIGRlc2NyaXB0b3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCI0NjMwIik7CgogICAgICAgIHZhciBzZXRUb1N0cmluZ1RhZyA9IF9fd2VicGFja19yZXF1aXJlX18oIjdmMjAiKTsKCiAgICAgICAgdmFyIEl0ZXJhdG9yUHJvdG90eXBlID0ge307IC8vIDI1LjEuMi4xLjEgJUl0ZXJhdG9yUHJvdG90eXBlJVtAQGl0ZXJhdG9yXSgpCgogICAgICAgIF9fd2VicGFja19yZXF1aXJlX18oIjMyZTkiKShJdGVyYXRvclByb3RvdHlwZSwgX193ZWJwYWNrX3JlcXVpcmVfXygiMmI0YyIpKCdpdGVyYXRvcicpLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICB9KTsKCiAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIE5BTUUsIG5leHQpIHsKICAgICAgICAgIENvbnN0cnVjdG9yLnByb3RvdHlwZSA9IGNyZWF0ZShJdGVyYXRvclByb3RvdHlwZSwgewogICAgICAgICAgICBuZXh0OiBkZXNjcmlwdG9yKDEsIG5leHQpCiAgICAgICAgICB9KTsKICAgICAgICAgIHNldFRvU3RyaW5nVGFnKENvbnN0cnVjdG9yLCBOQU1FICsgJyBJdGVyYXRvcicpOwogICAgICAgIH07CiAgICAgICAgLyoqKi8KCiAgICAgIH0sCgogICAgICAvKioqLwogICAgICAiNDU2ZCI6CiAgICAgIC8qKiovCiAgICAgIGZ1bmN0aW9uIGQobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CiAgICAgICAgLy8gMTkuMS4yLjE0IE9iamVjdC5rZXlzKE8pCiAgICAgICAgdmFyIHRvT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygiNGJmOCIpOwoKICAgICAgICB2YXIgJGtleXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCIwZDU4Iik7CgogICAgICAgIF9fd2VicGFja19yZXF1aXJlX18oIjVlZGEiKSgna2V5cycsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBmdW5jdGlvbiBrZXlzKGl0KSB7CiAgICAgICAgICAgIHJldHVybiAka2V5cyh0b09iamVjdChpdCkpOwogICAgICAgICAgfTsKICAgICAgICB9KTsKICAgICAgICAvKioqLwoKICAgICAgfSwKCiAgICAgIC8qKiovCiAgICAgICI0NTg4IjoKICAgICAgLyoqKi8KICAgICAgZnVuY3Rpb24gXyhtb2R1bGUsIGV4cG9ydHMpIHsKICAgICAgICAvLyA3LjEuNCBUb0ludGVnZXIKICAgICAgICB2YXIgY2VpbCA9IE1hdGguY2VpbDsKICAgICAgICB2YXIgZmxvb3IgPSBNYXRoLmZsb29yOwoKICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCkgewogICAgICAgICAgcmV0dXJuIGlzTmFOKGl0ID0gK2l0KSA/IDAgOiAoaXQgPiAwID8gZmxvb3IgOiBjZWlsKShpdCk7CiAgICAgICAgfTsKICAgICAgICAvKioqLwoKICAgICAgfSwKCiAgICAgIC8qKiovCiAgICAgICI0NjMwIjoKICAgICAgLyoqKi8KICAgICAgZnVuY3Rpb24gXyhtb2R1bGUsIGV4cG9ydHMpIHsKICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChiaXRtYXAsIHZhbHVlKSB7CiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICBlbnVtZXJhYmxlOiAhKGJpdG1hcCAmIDEpLAogICAgICAgICAgICBjb25maWd1cmFibGU6ICEoYml0bWFwICYgMiksCiAgICAgICAgICAgIHdyaXRhYmxlOiAhKGJpdG1hcCAmIDQpLAogICAgICAgICAgICB2YWx1ZTogdmFsdWUKICAgICAgICAgIH07CiAgICAgICAgfTsKICAgICAgICAvKioqLwoKICAgICAgfSwKCiAgICAgIC8qKiovCiAgICAgICI0YmY4IjoKICAgICAgLyoqKi8KICAgICAgZnVuY3Rpb24gYmY4KG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewogICAgICAgIC8vIDcuMS4xMyBUb09iamVjdChhcmd1bWVudCkKICAgICAgICB2YXIgZGVmaW5lZCA9IF9fd2VicGFja19yZXF1aXJlX18oImJlMTMiKTsKCiAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXQpIHsKICAgICAgICAgIHJldHVybiBPYmplY3QoZGVmaW5lZChpdCkpOwogICAgICAgIH07CiAgICAgICAgLyoqKi8KCiAgICAgIH0sCgogICAgICAvKioqLwogICAgICAiNTE0NyI6CiAgICAgIC8qKiovCiAgICAgIGZ1bmN0aW9uIF8obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CiAgICAgICAgdmFyIE1BVENIID0gX193ZWJwYWNrX3JlcXVpcmVfXygiMmI0YyIpKCdtYXRjaCcpOwoKICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChLRVkpIHsKICAgICAgICAgIHZhciByZSA9IC8uLzsKCiAgICAgICAgICB0cnkgewogICAgICAgICAgICAnLy4vJ1tLRVldKHJlKTsKICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICByZVtNQVRDSF0gPSBmYWxzZTsKICAgICAgICAgICAgICByZXR1cm4gIScvLi8nW0tFWV0ocmUpOwogICAgICAgICAgICB9IGNhdGNoIChmKSB7CiAgICAgICAgICAgICAgLyogZW1wdHkgKi8KICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH07CiAgICAgICAgLyoqKi8KCiAgICAgIH0sCgogICAgICAvKioqLwogICAgICAiNTIwYSI6CiAgICAgIC8qKiovCiAgICAgIGZ1bmN0aW9uIGEobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CiAgICAgICAgInVzZSBzdHJpY3QiOwoKICAgICAgICB2YXIgcmVnZXhwRmxhZ3MgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCIwYmZiIik7CgogICAgICAgIHZhciBuYXRpdmVFeGVjID0gUmVnRXhwLnByb3RvdHlwZS5leGVjOyAvLyBUaGlzIGFsd2F5cyByZWZlcnMgdG8gdGhlIG5hdGl2ZSBpbXBsZW1lbnRhdGlvbiwgYmVjYXVzZSB0aGUKICAgICAgICAvLyBTdHJpbmcjcmVwbGFjZSBwb2x5ZmlsbCB1c2VzIC4vZml4LXJlZ2V4cC13ZWxsLWtub3duLXN5bWJvbC1sb2dpYy5qcywKICAgICAgICAvLyB3aGljaCBsb2FkcyB0aGlzIGZpbGUgYmVmb3JlIHBhdGNoaW5nIHRoZSBtZXRob2QuCgogICAgICAgIHZhciBuYXRpdmVSZXBsYWNlID0gU3RyaW5nLnByb3RvdHlwZS5yZXBsYWNlOwogICAgICAgIHZhciBwYXRjaGVkRXhlYyA9IG5hdGl2ZUV4ZWM7CiAgICAgICAgdmFyIExBU1RfSU5ERVggPSAnbGFzdEluZGV4JzsKCiAgICAgICAgdmFyIFVQREFURVNfTEFTVF9JTkRFWF9XUk9ORyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciByZTEgPSAvYS8sCiAgICAgICAgICAgICAgcmUyID0gL2IqL2c7CiAgICAgICAgICBuYXRpdmVFeGVjLmNhbGwocmUxLCAnYScpOwogICAgICAgICAgbmF0aXZlRXhlYy5jYWxsKHJlMiwgJ2EnKTsKICAgICAgICAgIHJldHVybiByZTFbTEFTVF9JTkRFWF0gIT09IDAgfHwgcmUyW0xBU1RfSU5ERVhdICE9PSAwOwogICAgICAgIH0oKTsgLy8gbm9ucGFydGljaXBhdGluZyBjYXB0dXJpbmcgZ3JvdXAsIGNvcGllZCBmcm9tIGVzNS1zaGltJ3MgU3RyaW5nI3NwbGl0IHBhdGNoLgoKCiAgICAgICAgdmFyIE5QQ0dfSU5DTFVERUQgPSAvKCk/Py8uZXhlYygnJylbMV0gIT09IHVuZGVmaW5lZDsKICAgICAgICB2YXIgUEFUQ0ggPSBVUERBVEVTX0xBU1RfSU5ERVhfV1JPTkcgfHwgTlBDR19JTkNMVURFRDsKCiAgICAgICAgaWYgKFBBVENIKSB7CiAgICAgICAgICBwYXRjaGVkRXhlYyA9IGZ1bmN0aW9uIGV4ZWMoc3RyKSB7CiAgICAgICAgICAgIHZhciByZSA9IHRoaXM7CiAgICAgICAgICAgIHZhciBsYXN0SW5kZXgsIHJlQ29weSwgbWF0Y2gsIGk7CgogICAgICAgICAgICBpZiAoTlBDR19JTkNMVURFRCkgewogICAgICAgICAgICAgIHJlQ29weSA9IG5ldyBSZWdFeHAoJ14nICsgcmUuc291cmNlICsgJyQoPyFcXHMpJywgcmVnZXhwRmxhZ3MuY2FsbChyZSkpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoVVBEQVRFU19MQVNUX0lOREVYX1dST05HKSBsYXN0SW5kZXggPSByZVtMQVNUX0lOREVYXTsKICAgICAgICAgICAgbWF0Y2ggPSBuYXRpdmVFeGVjLmNhbGwocmUsIHN0cik7CgogICAgICAgICAgICBpZiAoVVBEQVRFU19MQVNUX0lOREVYX1dST05HICYmIG1hdGNoKSB7CiAgICAgICAgICAgICAgcmVbTEFTVF9JTkRFWF0gPSByZS5nbG9iYWwgPyBtYXRjaC5pbmRleCArIG1hdGNoWzBdLmxlbmd0aCA6IGxhc3RJbmRleDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKE5QQ0dfSU5DTFVERUQgJiYgbWF0Y2ggJiYgbWF0Y2gubGVuZ3RoID4gMSkgewogICAgICAgICAgICAgIC8vIEZpeCBicm93c2VycyB3aG9zZSBgZXhlY2AgbWV0aG9kcyBkb24ndCBjb25zaXN0ZW50bHkgcmV0dXJuIGB1bmRlZmluZWRgCiAgICAgICAgICAgICAgLy8gZm9yIE5QQ0csIGxpa2UgSUU4LiBOT1RFOiBUaGlzIGRvZXNuJyB3b3JrIGZvciAvKC4/KT8vCiAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWxvb3AtZnVuYwogICAgICAgICAgICAgIG5hdGl2ZVJlcGxhY2UuY2FsbChtYXRjaFswXSwgcmVDb3B5LCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICBmb3IgKGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aCAtIDI7IGkrKykgewogICAgICAgICAgICAgICAgICBpZiAoYXJndW1lbnRzW2ldID09PSB1bmRlZmluZWQpIG1hdGNoW2ldID0gdW5kZWZpbmVkOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gbWF0Y2g7CiAgICAgICAgICB9OwogICAgICAgIH0KCiAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSBwYXRjaGVkRXhlYzsKICAgICAgICAvKioqLwogICAgICB9LAoKICAgICAgLyoqKi8KICAgICAgIjUyYTciOgogICAgICAvKioqLwogICAgICBmdW5jdGlvbiBhNyhtb2R1bGUsIGV4cG9ydHMpIHsKICAgICAgICBleHBvcnRzLmYgPSB7fS5wcm9wZXJ0eUlzRW51bWVyYWJsZTsKICAgICAgICAvKioqLwogICAgICB9LAoKICAgICAgLyoqKi8KICAgICAgIjU1MzciOgogICAgICAvKioqLwogICAgICBmdW5jdGlvbiBfKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewogICAgICAgIHZhciBjb3JlID0gX193ZWJwYWNrX3JlcXVpcmVfXygiODM3OCIpOwoKICAgICAgICB2YXIgZ2xvYmFsID0gX193ZWJwYWNrX3JlcXVpcmVfXygiNzcyNiIpOwoKICAgICAgICB2YXIgU0hBUkVEID0gJ19fY29yZS1qc19zaGFyZWRfXyc7CiAgICAgICAgdmFyIHN0b3JlID0gZ2xvYmFsW1NIQVJFRF0gfHwgKGdsb2JhbFtTSEFSRURdID0ge30pOwogICAgICAgIChtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7CiAgICAgICAgICByZXR1cm4gc3RvcmVba2V5XSB8fCAoc3RvcmVba2V5XSA9IHZhbHVlICE9PSB1bmRlZmluZWQgPyB2YWx1ZSA6IHt9KTsKICAgICAgICB9KSgndmVyc2lvbnMnLCBbXSkucHVzaCh7CiAgICAgICAgICB2ZXJzaW9uOiBjb3JlLnZlcnNpb24sCiAgICAgICAgICBtb2RlOiBfX3dlYnBhY2tfcmVxdWlyZV9fKCIyZDAwIikgPyAncHVyZScgOiAnZ2xvYmFsJywKICAgICAgICAgIGNvcHlyaWdodDogJ8KpIDIwMTkgRGVuaXMgUHVzaGthcmV2ICh6bG9pcm9jay5ydSknCiAgICAgICAgfSk7CiAgICAgICAgLyoqKi8KICAgICAgfSwKCiAgICAgIC8qKiovCiAgICAgICI1Y2ExIjoKICAgICAgLyoqKi8KICAgICAgZnVuY3Rpb24gY2ExKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewogICAgICAgIHZhciBnbG9iYWwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCI3NzI2Iik7CgogICAgICAgIHZhciBjb3JlID0gX193ZWJwYWNrX3JlcXVpcmVfXygiODM3OCIpOwoKICAgICAgICB2YXIgaGlkZSA9IF9fd2VicGFja19yZXF1aXJlX18oIjMyZTkiKTsKCiAgICAgICAgdmFyIHJlZGVmaW5lID0gX193ZWJwYWNrX3JlcXVpcmVfXygiMmFiYSIpOwoKICAgICAgICB2YXIgY3R4ID0gX193ZWJwYWNrX3JlcXVpcmVfXygiOWI0MyIpOwoKICAgICAgICB2YXIgUFJPVE9UWVBFID0gJ3Byb3RvdHlwZSc7CgogICAgICAgIHZhciAkZXhwb3J0ID0gZnVuY3Rpb24gJGV4cG9ydCh0eXBlLCBuYW1lLCBzb3VyY2UpIHsKICAgICAgICAgIHZhciBJU19GT1JDRUQgPSB0eXBlICYgJGV4cG9ydC5GOwogICAgICAgICAgdmFyIElTX0dMT0JBTCA9IHR5cGUgJiAkZXhwb3J0Lkc7CiAgICAgICAgICB2YXIgSVNfU1RBVElDID0gdHlwZSAmICRleHBvcnQuUzsKICAgICAgICAgIHZhciBJU19QUk9UTyA9IHR5cGUgJiAkZXhwb3J0LlA7CiAgICAgICAgICB2YXIgSVNfQklORCA9IHR5cGUgJiAkZXhwb3J0LkI7CiAgICAgICAgICB2YXIgdGFyZ2V0ID0gSVNfR0xPQkFMID8gZ2xvYmFsIDogSVNfU1RBVElDID8gZ2xvYmFsW25hbWVdIHx8IChnbG9iYWxbbmFtZV0gPSB7fSkgOiAoZ2xvYmFsW25hbWVdIHx8IHt9KVtQUk9UT1RZUEVdOwogICAgICAgICAgdmFyIGV4cG9ydHMgPSBJU19HTE9CQUwgPyBjb3JlIDogY29yZVtuYW1lXSB8fCAoY29yZVtuYW1lXSA9IHt9KTsKICAgICAgICAgIHZhciBleHBQcm90byA9IGV4cG9ydHNbUFJPVE9UWVBFXSB8fCAoZXhwb3J0c1tQUk9UT1RZUEVdID0ge30pOwogICAgICAgICAgdmFyIGtleSwgb3duLCBvdXQsIGV4cDsKICAgICAgICAgIGlmIChJU19HTE9CQUwpIHNvdXJjZSA9IG5hbWU7CgogICAgICAgICAgZm9yIChrZXkgaW4gc291cmNlKSB7CiAgICAgICAgICAgIC8vIGNvbnRhaW5zIGluIG5hdGl2ZQogICAgICAgICAgICBvd24gPSAhSVNfRk9SQ0VEICYmIHRhcmdldCAmJiB0YXJnZXRba2V5XSAhPT0gdW5kZWZpbmVkOyAvLyBleHBvcnQgbmF0aXZlIG9yIHBhc3NlZAoKICAgICAgICAgICAgb3V0ID0gKG93biA/IHRhcmdldCA6IHNvdXJjZSlba2V5XTsgLy8gYmluZCB0aW1lcnMgdG8gZ2xvYmFsIGZvciBjYWxsIGZyb20gZXhwb3J0IGNvbnRleHQKCiAgICAgICAgICAgIGV4cCA9IElTX0JJTkQgJiYgb3duID8gY3R4KG91dCwgZ2xvYmFsKSA6IElTX1BST1RPICYmIHR5cGVvZiBvdXQgPT0gJ2Z1bmN0aW9uJyA/IGN0eChGdW5jdGlvbi5jYWxsLCBvdXQpIDogb3V0OyAvLyBleHRlbmQgZ2xvYmFsCgogICAgICAgICAgICBpZiAodGFyZ2V0KSByZWRlZmluZSh0YXJnZXQsIGtleSwgb3V0LCB0eXBlICYgJGV4cG9ydC5VKTsgLy8gZXhwb3J0CgogICAgICAgICAgICBpZiAoZXhwb3J0c1trZXldICE9IG91dCkgaGlkZShleHBvcnRzLCBrZXksIGV4cCk7CiAgICAgICAgICAgIGlmIChJU19QUk9UTyAmJiBleHBQcm90b1trZXldICE9IG91dCkgZXhwUHJvdG9ba2V5XSA9IG91dDsKICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICBnbG9iYWwuY29yZSA9IGNvcmU7IC8vIHR5cGUgYml0bWFwCgogICAgICAgICRleHBvcnQuRiA9IDE7IC8vIGZvcmNlZAoKICAgICAgICAkZXhwb3J0LkcgPSAyOyAvLyBnbG9iYWwKCiAgICAgICAgJGV4cG9ydC5TID0gNDsgLy8gc3RhdGljCgogICAgICAgICRleHBvcnQuUCA9IDg7IC8vIHByb3RvCgogICAgICAgICRleHBvcnQuQiA9IDE2OyAvLyBiaW5kCgogICAgICAgICRleHBvcnQuVyA9IDMyOyAvLyB3cmFwCgogICAgICAgICRleHBvcnQuVSA9IDY0OyAvLyBzYWZlCgogICAgICAgICRleHBvcnQuUiA9IDEyODsgLy8gcmVhbCBwcm90byBtZXRob2QgZm9yIGBsaWJyYXJ5YAoKICAgICAgICBtb2R1bGUuZXhwb3J0cyA9ICRleHBvcnQ7CiAgICAgICAgLyoqKi8KICAgICAgfSwKCiAgICAgIC8qKiovCiAgICAgICI1ZWRhIjoKICAgICAgLyoqKi8KICAgICAgZnVuY3Rpb24gZWRhKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewogICAgICAgIC8vIG1vc3QgT2JqZWN0IG1ldGhvZHMgYnkgRVM2IHNob3VsZCBhY2NlcHQgcHJpbWl0aXZlcwogICAgICAgIHZhciAkZXhwb3J0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygiNWNhMSIpOwoKICAgICAgICB2YXIgY29yZSA9IF9fd2VicGFja19yZXF1aXJlX18oIjgzNzgiKTsKCiAgICAgICAgdmFyIGZhaWxzID0gX193ZWJwYWNrX3JlcXVpcmVfXygiNzllNSIpOwoKICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChLRVksIGV4ZWMpIHsKICAgICAgICAgIHZhciBmbiA9IChjb3JlLk9iamVjdCB8fCB7fSlbS0VZXSB8fCBPYmplY3RbS0VZXTsKICAgICAgICAgIHZhciBleHAgPSB7fTsKICAgICAgICAgIGV4cFtLRVldID0gZXhlYyhmbik7CiAgICAgICAgICAkZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqIGZhaWxzKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgZm4oMSk7CiAgICAgICAgICB9KSwgJ09iamVjdCcsIGV4cCk7CiAgICAgICAgfTsKICAgICAgICAvKioqLwoKICAgICAgfSwKCiAgICAgIC8qKiovCiAgICAgICI1ZjFiIjoKICAgICAgLyoqKi8KICAgICAgZnVuY3Rpb24gZjFiKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewogICAgICAgICJ1c2Ugc3RyaWN0IjsKCiAgICAgICAgdmFyIGNsYXNzb2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCIyM2M2Iik7CgogICAgICAgIHZhciBidWlsdGluRXhlYyA9IFJlZ0V4cC5wcm90b3R5cGUuZXhlYzsgLy8gYFJlZ0V4cEV4ZWNgIGFic3RyYWN0IG9wZXJhdGlvbgogICAgICAgIC8vIGh0dHBzOi8vdGMzOS5naXRodWIuaW8vZWNtYTI2Mi8jc2VjLXJlZ2V4cGV4ZWMKCiAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoUiwgUykgewogICAgICAgICAgdmFyIGV4ZWMgPSBSLmV4ZWM7CgogICAgICAgICAgaWYgKHR5cGVvZiBleGVjID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICAgIHZhciByZXN1bHQgPSBleGVjLmNhbGwoUiwgUyk7CgogICAgICAgICAgICBpZiAoX3R5cGVvZihyZXN1bHQpICE9PSAnb2JqZWN0JykgewogICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1JlZ0V4cCBleGVjIG1ldGhvZCByZXR1cm5lZCBzb21ldGhpbmcgb3RoZXIgdGhhbiBhbiBPYmplY3Qgb3IgbnVsbCcpOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChjbGFzc29mKFIpICE9PSAnUmVnRXhwJykgewogICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdSZWdFeHAjZXhlYyBjYWxsZWQgb24gaW5jb21wYXRpYmxlIHJlY2VpdmVyJyk7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIGJ1aWx0aW5FeGVjLmNhbGwoUiwgUyk7CiAgICAgICAgfTsKICAgICAgICAvKioqLwoKICAgICAgfSwKCiAgICAgIC8qKiovCiAgICAgICI2MTNiIjoKICAgICAgLyoqKi8KICAgICAgZnVuY3Rpb24gYihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKICAgICAgICB2YXIgc2hhcmVkID0gX193ZWJwYWNrX3JlcXVpcmVfXygiNTUzNyIpKCdrZXlzJyk7CgogICAgICAgIHZhciB1aWQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCJjYTVhIik7CgogICAgICAgIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGtleSkgewogICAgICAgICAgcmV0dXJuIHNoYXJlZFtrZXldIHx8IChzaGFyZWRba2V5XSA9IHVpZChrZXkpKTsKICAgICAgICB9OwogICAgICAgIC8qKiovCgogICAgICB9LAoKICAgICAgLyoqKi8KICAgICAgIjYyNmEiOgogICAgICAvKioqLwogICAgICBmdW5jdGlvbiBhKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewogICAgICAgIC8vIGZhbGxiYWNrIGZvciBub24tYXJyYXktbGlrZSBFUzMgYW5kIG5vbi1lbnVtZXJhYmxlIG9sZCBWOCBzdHJpbmdzCiAgICAgICAgdmFyIGNvZiA9IF9fd2VicGFja19yZXF1aXJlX18oIjJkOTUiKTsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXByb3RvdHlwZS1idWlsdGlucwoKCiAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSBPYmplY3QoJ3onKS5wcm9wZXJ0eUlzRW51bWVyYWJsZSgwKSA/IE9iamVjdCA6IGZ1bmN0aW9uIChpdCkgewogICAgICAgICAgcmV0dXJuIGNvZihpdCkgPT0gJ1N0cmluZycgPyBpdC5zcGxpdCgnJykgOiBPYmplY3QoaXQpOwogICAgICAgIH07CiAgICAgICAgLyoqKi8KICAgICAgfSwKCiAgICAgIC8qKiovCiAgICAgICI2NzYyIjoKICAgICAgLyoqKi8KICAgICAgZnVuY3Rpb24gXyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKICAgICAgICAidXNlIHN0cmljdCI7IC8vIGh0dHBzOi8vZ2l0aHViLmNvbS90YzM5L0FycmF5LnByb3RvdHlwZS5pbmNsdWRlcwoKICAgICAgICB2YXIgJGV4cG9ydCA9IF9fd2VicGFja19yZXF1aXJlX18oIjVjYTEiKTsKCiAgICAgICAgdmFyICRpbmNsdWRlcyA9IF9fd2VicGFja19yZXF1aXJlX18oImMzNjYiKSh0cnVlKTsKCiAgICAgICAgJGV4cG9ydCgkZXhwb3J0LlAsICdBcnJheScsIHsKICAgICAgICAgIGluY2x1ZGVzOiBmdW5jdGlvbiBpbmNsdWRlcyhlbAogICAgICAgICAgLyogLCBmcm9tSW5kZXggPSAwICovCiAgICAgICAgICApIHsKICAgICAgICAgICAgcmV0dXJuICRpbmNsdWRlcyh0aGlzLCBlbCwgYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiB1bmRlZmluZWQpOwogICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKCI5YzZjIikoJ2luY2x1ZGVzJyk7CiAgICAgICAgLyoqKi8KCiAgICAgIH0sCgogICAgICAvKioqLwogICAgICAiNjgyMSI6CiAgICAgIC8qKiovCiAgICAgIGZ1bmN0aW9uIF8obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CiAgICAgICAgLy8gdG8gaW5kZXhlZCBvYmplY3QsIHRvT2JqZWN0IHdpdGggZmFsbGJhY2sgZm9yIG5vbi1hcnJheS1saWtlIEVTMyBzdHJpbmdzCiAgICAgICAgdmFyIElPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCI2MjZhIik7CgogICAgICAgIHZhciBkZWZpbmVkID0gX193ZWJwYWNrX3JlcXVpcmVfXygiYmUxMyIpOwoKICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCkgewogICAgICAgICAgcmV0dXJuIElPYmplY3QoZGVmaW5lZChpdCkpOwogICAgICAgIH07CiAgICAgICAgLyoqKi8KCiAgICAgIH0sCgogICAgICAvKioqLwogICAgICAiNjlhOCI6CiAgICAgIC8qKiovCiAgICAgIGZ1bmN0aW9uIGE4KG1vZHVsZSwgZXhwb3J0cykgewogICAgICAgIHZhciBoYXNPd25Qcm9wZXJ0eSA9IHt9Lmhhc093blByb3BlcnR5OwoKICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCwga2V5KSB7CiAgICAgICAgICByZXR1cm4gaGFzT3duUHJvcGVydHkuY2FsbChpdCwga2V5KTsKICAgICAgICB9OwogICAgICAgIC8qKiovCgogICAgICB9LAoKICAgICAgLyoqKi8KICAgICAgIjZhOTkiOgogICAgICAvKioqLwogICAgICBmdW5jdGlvbiBhOTkobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CiAgICAgICAgLy8gNy4xLjEgVG9QcmltaXRpdmUoaW5wdXQgWywgUHJlZmVycmVkVHlwZV0pCiAgICAgICAgdmFyIGlzT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygiZDNmNCIpOyAvLyBpbnN0ZWFkIG9mIHRoZSBFUzYgc3BlYyB2ZXJzaW9uLCB3ZSBkaWRuJ3QgaW1wbGVtZW50IEBAdG9QcmltaXRpdmUgY2FzZQogICAgICAgIC8vIGFuZCB0aGUgc2Vjb25kIGFyZ3VtZW50IC0gZmxhZyAtIHByZWZlcnJlZCB0eXBlIGlzIGEgc3RyaW5nCgoKICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCwgUykgewogICAgICAgICAgaWYgKCFpc09iamVjdChpdCkpIHJldHVybiBpdDsKICAgICAgICAgIHZhciBmbiwgdmFsOwogICAgICAgICAgaWYgKFMgJiYgdHlwZW9mIChmbiA9IGl0LnRvU3RyaW5nKSA9PSAnZnVuY3Rpb24nICYmICFpc09iamVjdCh2YWwgPSBmbi5jYWxsKGl0KSkpIHJldHVybiB2YWw7CiAgICAgICAgICBpZiAodHlwZW9mIChmbiA9IGl0LnZhbHVlT2YpID09ICdmdW5jdGlvbicgJiYgIWlzT2JqZWN0KHZhbCA9IGZuLmNhbGwoaXQpKSkgcmV0dXJuIHZhbDsKICAgICAgICAgIGlmICghUyAmJiB0eXBlb2YgKGZuID0gaXQudG9TdHJpbmcpID09ICdmdW5jdGlvbicgJiYgIWlzT2JqZWN0KHZhbCA9IGZuLmNhbGwoaXQpKSkgcmV0dXJuIHZhbDsKICAgICAgICAgIHRocm93IFR5cGVFcnJvcigiQ2FuJ3QgY29udmVydCBvYmplY3QgdG8gcHJpbWl0aXZlIHZhbHVlIik7CiAgICAgICAgfTsKICAgICAgICAvKioqLwoKICAgICAgfSwKCiAgICAgIC8qKiovCiAgICAgICI3MzMzIjoKICAgICAgLyoqKi8KICAgICAgZnVuY3Rpb24gXyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKICAgICAgICAidXNlIHN0cmljdCI7IC8vIDE5LjEuMi4xIE9iamVjdC5hc3NpZ24odGFyZ2V0LCBzb3VyY2UsIC4uLikKCiAgICAgICAgdmFyIGdldEtleXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCIwZDU4Iik7CgogICAgICAgIHZhciBnT1BTID0gX193ZWJwYWNrX3JlcXVpcmVfXygiMjYyMSIpOwoKICAgICAgICB2YXIgcElFID0gX193ZWJwYWNrX3JlcXVpcmVfXygiNTJhNyIpOwoKICAgICAgICB2YXIgdG9PYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCI0YmY4Iik7CgogICAgICAgIHZhciBJT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygiNjI2YSIpOwoKICAgICAgICB2YXIgJGFzc2lnbiA9IE9iamVjdC5hc3NpZ247IC8vIHNob3VsZCB3b3JrIHdpdGggc3ltYm9scyBhbmQgc2hvdWxkIGhhdmUgZGV0ZXJtaW5pc3RpYyBwcm9wZXJ0eSBvcmRlciAoVjggYnVnKQoKICAgICAgICBtb2R1bGUuZXhwb3J0cyA9ICEkYXNzaWduIHx8IF9fd2VicGFja19yZXF1aXJlX18oIjc5ZTUiKShmdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgQSA9IHt9OwogICAgICAgICAgdmFyIEIgPSB7fTsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVuZGVmCgogICAgICAgICAgdmFyIFMgPSBTeW1ib2woKTsKICAgICAgICAgIHZhciBLID0gJ2FiY2RlZmdoaWprbG1ub3BxcnN0JzsKICAgICAgICAgIEFbU10gPSA3OwogICAgICAgICAgSy5zcGxpdCgnJykuZm9yRWFjaChmdW5jdGlvbiAoaykgewogICAgICAgICAgICBCW2tdID0gazsKICAgICAgICAgIH0pOwogICAgICAgICAgcmV0dXJuICRhc3NpZ24oe30sIEEpW1NdICE9IDcgfHwgT2JqZWN0LmtleXMoJGFzc2lnbih7fSwgQikpLmpvaW4oJycpICE9IEs7CiAgICAgICAgfSkgPyBmdW5jdGlvbiBhc3NpZ24odGFyZ2V0LCBzb3VyY2UpIHsKICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnMKICAgICAgICAgIHZhciBUID0gdG9PYmplY3QodGFyZ2V0KTsKICAgICAgICAgIHZhciBhTGVuID0gYXJndW1lbnRzLmxlbmd0aDsKICAgICAgICAgIHZhciBpbmRleCA9IDE7CiAgICAgICAgICB2YXIgZ2V0U3ltYm9scyA9IGdPUFMuZjsKICAgICAgICAgIHZhciBpc0VudW0gPSBwSUUuZjsKCiAgICAgICAgICB3aGlsZSAoYUxlbiA+IGluZGV4KSB7CiAgICAgICAgICAgIHZhciBTID0gSU9iamVjdChhcmd1bWVudHNbaW5kZXgrK10pOwogICAgICAgICAgICB2YXIga2V5cyA9IGdldFN5bWJvbHMgPyBnZXRLZXlzKFMpLmNvbmNhdChnZXRTeW1ib2xzKFMpKSA6IGdldEtleXMoUyk7CiAgICAgICAgICAgIHZhciBsZW5ndGggPSBrZXlzLmxlbmd0aDsKICAgICAgICAgICAgdmFyIGogPSAwOwogICAgICAgICAgICB2YXIga2V5OwoKICAgICAgICAgICAgd2hpbGUgKGxlbmd0aCA+IGopIHsKICAgICAgICAgICAgICBpZiAoaXNFbnVtLmNhbGwoUywga2V5ID0ga2V5c1tqKytdKSkgVFtrZXldID0gU1trZXldOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIFQ7CiAgICAgICAgfSA6ICRhc3NpZ247CiAgICAgICAgLyoqKi8KICAgICAgfSwKCiAgICAgIC8qKiovCiAgICAgICI3NzI2IjoKICAgICAgLyoqKi8KICAgICAgZnVuY3Rpb24gXyhtb2R1bGUsIGV4cG9ydHMpIHsKICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vemxvaXJvY2svY29yZS1qcy9pc3N1ZXMvODYjaXNzdWVjb21tZW50LTExNTc1OTAyOAogICAgICAgIHZhciBnbG9iYWwgPSBtb2R1bGUuZXhwb3J0cyA9IHR5cGVvZiB3aW5kb3cgIT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93Lk1hdGggPT0gTWF0aCA/IHdpbmRvdyA6IHR5cGVvZiBzZWxmICE9ICd1bmRlZmluZWQnICYmIHNlbGYuTWF0aCA9PSBNYXRoID8gc2VsZiAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tbmV3LWZ1bmMKICAgICAgICA6IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKCk7CiAgICAgICAgaWYgKHR5cGVvZiBfX2cgPT0gJ251bWJlcicpIF9fZyA9IGdsb2JhbDsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bmRlZgoKICAgICAgICAvKioqLwogICAgICB9LAoKICAgICAgLyoqKi8KICAgICAgIjc3ZjEiOgogICAgICAvKioqLwogICAgICBmdW5jdGlvbiBmMShtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKICAgICAgICB2YXIgdG9JbnRlZ2VyID0gX193ZWJwYWNrX3JlcXVpcmVfXygiNDU4OCIpOwoKICAgICAgICB2YXIgbWF4ID0gTWF0aC5tYXg7CiAgICAgICAgdmFyIG1pbiA9IE1hdGgubWluOwoKICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpbmRleCwgbGVuZ3RoKSB7CiAgICAgICAgICBpbmRleCA9IHRvSW50ZWdlcihpbmRleCk7CiAgICAgICAgICByZXR1cm4gaW5kZXggPCAwID8gbWF4KGluZGV4ICsgbGVuZ3RoLCAwKSA6IG1pbihpbmRleCwgbGVuZ3RoKTsKICAgICAgICB9OwogICAgICAgIC8qKiovCgogICAgICB9LAoKICAgICAgLyoqKi8KICAgICAgIjc5ZTUiOgogICAgICAvKioqLwogICAgICBmdW5jdGlvbiBlNShtb2R1bGUsIGV4cG9ydHMpIHsKICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChleGVjKSB7CiAgICAgICAgICB0cnkgewogICAgICAgICAgICByZXR1cm4gISFleGVjKCk7CiAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgfQogICAgICAgIH07CiAgICAgICAgLyoqKi8KCiAgICAgIH0sCgogICAgICAvKioqLwogICAgICAiN2YyMCI6CiAgICAgIC8qKiovCiAgICAgIGZ1bmN0aW9uIGYyMChtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKICAgICAgICB2YXIgZGVmID0gX193ZWJwYWNrX3JlcXVpcmVfXygiODZjYyIpLmY7CgogICAgICAgIHZhciBoYXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCI2OWE4Iik7CgogICAgICAgIHZhciBUQUcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCIyYjRjIikoJ3RvU3RyaW5nVGFnJyk7CgogICAgICAgIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGl0LCB0YWcsIHN0YXQpIHsKICAgICAgICAgIGlmIChpdCAmJiAhaGFzKGl0ID0gc3RhdCA/IGl0IDogaXQucHJvdG90eXBlLCBUQUcpKSBkZWYoaXQsIFRBRywgewogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB0YWcKICAgICAgICAgIH0pOwogICAgICAgIH07CiAgICAgICAgLyoqKi8KCiAgICAgIH0sCgogICAgICAvKioqLwogICAgICAiODM3OCI6CiAgICAgIC8qKiovCiAgICAgIGZ1bmN0aW9uIF8obW9kdWxlLCBleHBvcnRzKSB7CiAgICAgICAgdmFyIGNvcmUgPSBtb2R1bGUuZXhwb3J0cyA9IHsKICAgICAgICAgIHZlcnNpb246ICcyLjYuNScKICAgICAgICB9OwogICAgICAgIGlmICh0eXBlb2YgX19lID09ICdudW1iZXInKSBfX2UgPSBjb3JlOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVuZGVmCgogICAgICAgIC8qKiovCiAgICAgIH0sCgogICAgICAvKioqLwogICAgICAiODRmMiI6CiAgICAgIC8qKiovCiAgICAgIGZ1bmN0aW9uIGYyKG1vZHVsZSwgZXhwb3J0cykgewogICAgICAgIG1vZHVsZS5leHBvcnRzID0ge307CiAgICAgICAgLyoqKi8KICAgICAgfSwKCiAgICAgIC8qKiovCiAgICAgICI4NmNjIjoKICAgICAgLyoqKi8KICAgICAgZnVuY3Rpb24gY2MobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CiAgICAgICAgdmFyIGFuT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygiY2I3YyIpOwoKICAgICAgICB2YXIgSUU4X0RPTV9ERUZJTkUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCJjNjlhIik7CgogICAgICAgIHZhciB0b1ByaW1pdGl2ZSA9IF9fd2VicGFja19yZXF1aXJlX18oIjZhOTkiKTsKCiAgICAgICAgdmFyIGRQID0gT2JqZWN0LmRlZmluZVByb3BlcnR5OwogICAgICAgIGV4cG9ydHMuZiA9IF9fd2VicGFja19yZXF1aXJlX18oIjllMWUiKSA/IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSA6IGZ1bmN0aW9uIGRlZmluZVByb3BlcnR5KE8sIFAsIEF0dHJpYnV0ZXMpIHsKICAgICAgICAgIGFuT2JqZWN0KE8pOwogICAgICAgICAgUCA9IHRvUHJpbWl0aXZlKFAsIHRydWUpOwogICAgICAgICAgYW5PYmplY3QoQXR0cmlidXRlcyk7CiAgICAgICAgICBpZiAoSUU4X0RPTV9ERUZJTkUpIHRyeSB7CiAgICAgICAgICAgIHJldHVybiBkUChPLCBQLCBBdHRyaWJ1dGVzKTsKICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgLyogZW1wdHkgKi8KICAgICAgICAgIH0KICAgICAgICAgIGlmICgnZ2V0JyBpbiBBdHRyaWJ1dGVzIHx8ICdzZXQnIGluIEF0dHJpYnV0ZXMpIHRocm93IFR5cGVFcnJvcignQWNjZXNzb3JzIG5vdCBzdXBwb3J0ZWQhJyk7CiAgICAgICAgICBpZiAoJ3ZhbHVlJyBpbiBBdHRyaWJ1dGVzKSBPW1BdID0gQXR0cmlidXRlcy52YWx1ZTsKICAgICAgICAgIHJldHVybiBPOwogICAgICAgIH07CiAgICAgICAgLyoqKi8KICAgICAgfSwKCiAgICAgIC8qKiovCiAgICAgICI5YjQzIjoKICAgICAgLyoqKi8KICAgICAgZnVuY3Rpb24gYjQzKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewogICAgICAgIC8vIG9wdGlvbmFsIC8gc2ltcGxlIGNvbnRleHQgYmluZGluZwogICAgICAgIHZhciBhRnVuY3Rpb24gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCJkOGU4Iik7CgogICAgICAgIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGZuLCB0aGF0LCBsZW5ndGgpIHsKICAgICAgICAgIGFGdW5jdGlvbihmbik7CiAgICAgICAgICBpZiAodGhhdCA9PT0gdW5kZWZpbmVkKSByZXR1cm4gZm47CgogICAgICAgICAgc3dpdGNoIChsZW5ndGgpIHsKICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGZuLmNhbGwodGhhdCwgYSk7CiAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgICAgICAgICAgIHJldHVybiBmbi5jYWxsKHRoYXQsIGEsIGIpOwogICAgICAgICAgICAgIH07CgogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhLCBiLCBjKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZm4uY2FsbCh0aGF0LCBhLCBiLCBjKTsKICAgICAgICAgICAgICB9OwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKQogICAgICAgICAgLyogLi4uYXJncyAqLwogICAgICAgICAgewogICAgICAgICAgICByZXR1cm4gZm4uYXBwbHkodGhhdCwgYXJndW1lbnRzKTsKICAgICAgICAgIH07CiAgICAgICAgfTsKICAgICAgICAvKioqLwoKICAgICAgfSwKCiAgICAgIC8qKiovCiAgICAgICI5YzZjIjoKICAgICAgLyoqKi8KICAgICAgZnVuY3Rpb24gYzZjKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewogICAgICAgIC8vIDIyLjEuMy4zMSBBcnJheS5wcm90b3R5cGVbQEB1bnNjb3BhYmxlc10KICAgICAgICB2YXIgVU5TQ09QQUJMRVMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCIyYjRjIikoJ3Vuc2NvcGFibGVzJyk7CgogICAgICAgIHZhciBBcnJheVByb3RvID0gQXJyYXkucHJvdG90eXBlOwogICAgICAgIGlmIChBcnJheVByb3RvW1VOU0NPUEFCTEVTXSA9PSB1bmRlZmluZWQpIF9fd2VicGFja19yZXF1aXJlX18oIjMyZTkiKShBcnJheVByb3RvLCBVTlNDT1BBQkxFUywge30pOwoKICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICAgIEFycmF5UHJvdG9bVU5TQ09QQUJMRVNdW2tleV0gPSB0cnVlOwogICAgICAgIH07CiAgICAgICAgLyoqKi8KCiAgICAgIH0sCgogICAgICAvKioqLwogICAgICAiOWRlZiI6CiAgICAgIC8qKiovCiAgICAgIGZ1bmN0aW9uIGRlZihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKICAgICAgICAvLyA3LjEuMTUgVG9MZW5ndGgKICAgICAgICB2YXIgdG9JbnRlZ2VyID0gX193ZWJwYWNrX3JlcXVpcmVfXygiNDU4OCIpOwoKICAgICAgICB2YXIgbWluID0gTWF0aC5taW47CgogICAgICAgIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGl0KSB7CiAgICAgICAgICByZXR1cm4gaXQgPiAwID8gbWluKHRvSW50ZWdlcihpdCksIDB4MWZmZmZmZmZmZmZmZmYpIDogMDsgLy8gcG93KDIsIDUzKSAtIDEgPT0gOTAwNzE5OTI1NDc0MDk5MQogICAgICAgIH07CiAgICAgICAgLyoqKi8KCiAgICAgIH0sCgogICAgICAvKioqLwogICAgICAiOWUxZSI6CiAgICAgIC8qKiovCiAgICAgIGZ1bmN0aW9uIGUxZShtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKICAgICAgICAvLyBUaGFuaydzIElFOCBmb3IgaGlzIGZ1bm55IGRlZmluZVByb3BlcnR5CiAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSAhX193ZWJwYWNrX3JlcXVpcmVfXygiNzllNSIpKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkoe30sICdhJywgewogICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICAgICAgICByZXR1cm4gNzsKICAgICAgICAgICAgfQogICAgICAgICAgfSkuYSAhPSA3OwogICAgICAgIH0pOwogICAgICAgIC8qKiovCiAgICAgIH0sCgogICAgICAvKioqLwogICAgICAiYTM1MiI6CiAgICAgIC8qKiovCiAgICAgIGZ1bmN0aW9uIGEzNTIobW9kdWxlLCBleHBvcnRzKSB7CiAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX2EzNTJfXzsKICAgICAgICAvKioqLwogICAgICB9LAoKICAgICAgLyoqKi8KICAgICAgImE0ODEiOgogICAgICAvKioqLwogICAgICBmdW5jdGlvbiBhNDgxKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewogICAgICAgICJ1c2Ugc3RyaWN0IjsKCiAgICAgICAgdmFyIGFuT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygiY2I3YyIpOwoKICAgICAgICB2YXIgdG9PYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCI0YmY4Iik7CgogICAgICAgIHZhciB0b0xlbmd0aCA9IF9fd2VicGFja19yZXF1aXJlX18oIjlkZWYiKTsKCiAgICAgICAgdmFyIHRvSW50ZWdlciA9IF9fd2VicGFja19yZXF1aXJlX18oIjQ1ODgiKTsKCiAgICAgICAgdmFyIGFkdmFuY2VTdHJpbmdJbmRleCA9IF9fd2VicGFja19yZXF1aXJlX18oIjAzOTAiKTsKCiAgICAgICAgdmFyIHJlZ0V4cEV4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCI1ZjFiIik7CgogICAgICAgIHZhciBtYXggPSBNYXRoLm1heDsKICAgICAgICB2YXIgbWluID0gTWF0aC5taW47CiAgICAgICAgdmFyIGZsb29yID0gTWF0aC5mbG9vcjsKICAgICAgICB2YXIgU1VCU1RJVFVUSU9OX1NZTUJPTFMgPSAvXCQoWyQmYCddfFxkXGQ/fDxbXj5dKj4pL2c7CiAgICAgICAgdmFyIFNVQlNUSVRVVElPTl9TWU1CT0xTX05PX05BTUVEID0gL1wkKFskJmAnXXxcZFxkPykvZzsKCiAgICAgICAgdmFyIG1heWJlVG9TdHJpbmcgPSBmdW5jdGlvbiBtYXliZVRvU3RyaW5nKGl0KSB7CiAgICAgICAgICByZXR1cm4gaXQgPT09IHVuZGVmaW5lZCA/IGl0IDogU3RyaW5nKGl0KTsKICAgICAgICB9OyAvLyBAQHJlcGxhY2UgbG9naWMKCgogICAgICAgIF9fd2VicGFja19yZXF1aXJlX18oIjIxNGYiKSgncmVwbGFjZScsIDIsIGZ1bmN0aW9uIChkZWZpbmVkLCBSRVBMQUNFLCAkcmVwbGFjZSwgbWF5YmVDYWxsTmF0aXZlKSB7CiAgICAgICAgICByZXR1cm4gWy8vIGBTdHJpbmcucHJvdG90eXBlLnJlcGxhY2VgIG1ldGhvZAogICAgICAgICAgLy8gaHR0cHM6Ly90YzM5LmdpdGh1Yi5pby9lY21hMjYyLyNzZWMtc3RyaW5nLnByb3RvdHlwZS5yZXBsYWNlCiAgICAgICAgICBmdW5jdGlvbiByZXBsYWNlKHNlYXJjaFZhbHVlLCByZXBsYWNlVmFsdWUpIHsKICAgICAgICAgICAgdmFyIE8gPSBkZWZpbmVkKHRoaXMpOwogICAgICAgICAgICB2YXIgZm4gPSBzZWFyY2hWYWx1ZSA9PSB1bmRlZmluZWQgPyB1bmRlZmluZWQgOiBzZWFyY2hWYWx1ZVtSRVBMQUNFXTsKICAgICAgICAgICAgcmV0dXJuIGZuICE9PSB1bmRlZmluZWQgPyBmbi5jYWxsKHNlYXJjaFZhbHVlLCBPLCByZXBsYWNlVmFsdWUpIDogJHJlcGxhY2UuY2FsbChTdHJpbmcoTyksIHNlYXJjaFZhbHVlLCByZXBsYWNlVmFsdWUpOwogICAgICAgICAgfSwgLy8gYFJlZ0V4cC5wcm90b3R5cGVbQEByZXBsYWNlXWAgbWV0aG9kCiAgICAgICAgICAvLyBodHRwczovL3RjMzkuZ2l0aHViLmlvL2VjbWEyNjIvI3NlYy1yZWdleHAucHJvdG90eXBlLUBAcmVwbGFjZQogICAgICAgICAgZnVuY3Rpb24gKHJlZ2V4cCwgcmVwbGFjZVZhbHVlKSB7CiAgICAgICAgICAgIHZhciByZXMgPSBtYXliZUNhbGxOYXRpdmUoJHJlcGxhY2UsIHJlZ2V4cCwgdGhpcywgcmVwbGFjZVZhbHVlKTsKICAgICAgICAgICAgaWYgKHJlcy5kb25lKSByZXR1cm4gcmVzLnZhbHVlOwogICAgICAgICAgICB2YXIgcnggPSBhbk9iamVjdChyZWdleHApOwogICAgICAgICAgICB2YXIgUyA9IFN0cmluZyh0aGlzKTsKICAgICAgICAgICAgdmFyIGZ1bmN0aW9uYWxSZXBsYWNlID0gdHlwZW9mIHJlcGxhY2VWYWx1ZSA9PT0gJ2Z1bmN0aW9uJzsKICAgICAgICAgICAgaWYgKCFmdW5jdGlvbmFsUmVwbGFjZSkgcmVwbGFjZVZhbHVlID0gU3RyaW5nKHJlcGxhY2VWYWx1ZSk7CiAgICAgICAgICAgIHZhciBnbG9iYWwgPSByeC5nbG9iYWw7CgogICAgICAgICAgICBpZiAoZ2xvYmFsKSB7CiAgICAgICAgICAgICAgdmFyIGZ1bGxVbmljb2RlID0gcngudW5pY29kZTsKICAgICAgICAgICAgICByeC5sYXN0SW5kZXggPSAwOwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgcmVzdWx0cyA9IFtdOwoKICAgICAgICAgICAgd2hpbGUgKHRydWUpIHsKICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gcmVnRXhwRXhlYyhyeCwgUyk7CiAgICAgICAgICAgICAgaWYgKHJlc3VsdCA9PT0gbnVsbCkgYnJlYWs7CiAgICAgICAgICAgICAgcmVzdWx0cy5wdXNoKHJlc3VsdCk7CiAgICAgICAgICAgICAgaWYgKCFnbG9iYWwpIGJyZWFrOwogICAgICAgICAgICAgIHZhciBtYXRjaFN0ciA9IFN0cmluZyhyZXN1bHRbMF0pOwogICAgICAgICAgICAgIGlmIChtYXRjaFN0ciA9PT0gJycpIHJ4Lmxhc3RJbmRleCA9IGFkdmFuY2VTdHJpbmdJbmRleChTLCB0b0xlbmd0aChyeC5sYXN0SW5kZXgpLCBmdWxsVW5pY29kZSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHZhciBhY2N1bXVsYXRlZFJlc3VsdCA9ICcnOwogICAgICAgICAgICB2YXIgbmV4dFNvdXJjZVBvc2l0aW9uID0gMDsKCiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVzdWx0cy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdHNbaV07CiAgICAgICAgICAgICAgdmFyIG1hdGNoZWQgPSBTdHJpbmcocmVzdWx0WzBdKTsKICAgICAgICAgICAgICB2YXIgcG9zaXRpb24gPSBtYXgobWluKHRvSW50ZWdlcihyZXN1bHQuaW5kZXgpLCBTLmxlbmd0aCksIDApOwogICAgICAgICAgICAgIHZhciBjYXB0dXJlcyA9IFtdOyAvLyBOT1RFOiBUaGlzIGlzIGVxdWl2YWxlbnQgdG8KICAgICAgICAgICAgICAvLyAgIGNhcHR1cmVzID0gcmVzdWx0LnNsaWNlKDEpLm1hcChtYXliZVRvU3RyaW5nKQogICAgICAgICAgICAgIC8vIGJ1dCBmb3Igc29tZSByZWFzb24gYG5hdGl2ZVNsaWNlLmNhbGwocmVzdWx0LCAxLCByZXN1bHQubGVuZ3RoKWAgKGNhbGxlZCBpbgogICAgICAgICAgICAgIC8vIHRoZSBzbGljZSBwb2x5ZmlsbCB3aGVuIHNsaWNpbmcgbmF0aXZlIGFycmF5cykgImRvZXNuJ3Qgd29yayIgaW4gc2FmYXJpIDkgYW5kCiAgICAgICAgICAgICAgLy8gY2F1c2VzIGEgY3Jhc2ggKGh0dHBzOi8vcGFzdGViaW4uY29tL04yMVF6ZVFBKSB3aGVuIHRyeWluZyB0byBkZWJ1ZyBpdC4KCiAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDE7IGogPCByZXN1bHQubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgIGNhcHR1cmVzLnB1c2gobWF5YmVUb1N0cmluZyhyZXN1bHRbal0pKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHZhciBuYW1lZENhcHR1cmVzID0gcmVzdWx0Lmdyb3VwczsKCiAgICAgICAgICAgICAgaWYgKGZ1bmN0aW9uYWxSZXBsYWNlKSB7CiAgICAgICAgICAgICAgICB2YXIgcmVwbGFjZXJBcmdzID0gW21hdGNoZWRdLmNvbmNhdChjYXB0dXJlcywgcG9zaXRpb24sIFMpOwogICAgICAgICAgICAgICAgaWYgKG5hbWVkQ2FwdHVyZXMgIT09IHVuZGVmaW5lZCkgcmVwbGFjZXJBcmdzLnB1c2gobmFtZWRDYXB0dXJlcyk7CiAgICAgICAgICAgICAgICB2YXIgcmVwbGFjZW1lbnQgPSBTdHJpbmcocmVwbGFjZVZhbHVlLmFwcGx5KHVuZGVmaW5lZCwgcmVwbGFjZXJBcmdzKSk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHJlcGxhY2VtZW50ID0gZ2V0U3Vic3RpdHV0aW9uKG1hdGNoZWQsIFMsIHBvc2l0aW9uLCBjYXB0dXJlcywgbmFtZWRDYXB0dXJlcywgcmVwbGFjZVZhbHVlKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGlmIChwb3NpdGlvbiA+PSBuZXh0U291cmNlUG9zaXRpb24pIHsKICAgICAgICAgICAgICAgIGFjY3VtdWxhdGVkUmVzdWx0ICs9IFMuc2xpY2UobmV4dFNvdXJjZVBvc2l0aW9uLCBwb3NpdGlvbikgKyByZXBsYWNlbWVudDsKICAgICAgICAgICAgICAgIG5leHRTb3VyY2VQb3NpdGlvbiA9IHBvc2l0aW9uICsgbWF0Y2hlZC5sZW5ndGg7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gYWNjdW11bGF0ZWRSZXN1bHQgKyBTLnNsaWNlKG5leHRTb3VyY2VQb3NpdGlvbik7CiAgICAgICAgICB9XTsgLy8gaHR0cHM6Ly90YzM5LmdpdGh1Yi5pby9lY21hMjYyLyNzZWMtZ2V0c3Vic3RpdHV0aW9uCgogICAgICAgICAgZnVuY3Rpb24gZ2V0U3Vic3RpdHV0aW9uKG1hdGNoZWQsIHN0ciwgcG9zaXRpb24sIGNhcHR1cmVzLCBuYW1lZENhcHR1cmVzLCByZXBsYWNlbWVudCkgewogICAgICAgICAgICB2YXIgdGFpbFBvcyA9IHBvc2l0aW9uICsgbWF0Y2hlZC5sZW5ndGg7CiAgICAgICAgICAgIHZhciBtID0gY2FwdHVyZXMubGVuZ3RoOwogICAgICAgICAgICB2YXIgc3ltYm9scyA9IFNVQlNUSVRVVElPTl9TWU1CT0xTX05PX05BTUVEOwoKICAgICAgICAgICAgaWYgKG5hbWVkQ2FwdHVyZXMgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgIG5hbWVkQ2FwdHVyZXMgPSB0b09iamVjdChuYW1lZENhcHR1cmVzKTsKICAgICAgICAgICAgICBzeW1ib2xzID0gU1VCU1RJVFVUSU9OX1NZTUJPTFM7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiAkcmVwbGFjZS5jYWxsKHJlcGxhY2VtZW50LCBzeW1ib2xzLCBmdW5jdGlvbiAobWF0Y2gsIGNoKSB7CiAgICAgICAgICAgICAgdmFyIGNhcHR1cmU7CgogICAgICAgICAgICAgIHN3aXRjaCAoY2guY2hhckF0KDApKSB7CiAgICAgICAgICAgICAgICBjYXNlICckJzoKICAgICAgICAgICAgICAgICAgcmV0dXJuICckJzsKCiAgICAgICAgICAgICAgICBjYXNlICcmJzoKICAgICAgICAgICAgICAgICAgcmV0dXJuIG1hdGNoZWQ7CgogICAgICAgICAgICAgICAgY2FzZSAnYCc6CiAgICAgICAgICAgICAgICAgIHJldHVybiBzdHIuc2xpY2UoMCwgcG9zaXRpb24pOwoKICAgICAgICAgICAgICAgIGNhc2UgIiciOgogICAgICAgICAgICAgICAgICByZXR1cm4gc3RyLnNsaWNlKHRhaWxQb3MpOwoKICAgICAgICAgICAgICAgIGNhc2UgJzwnOgogICAgICAgICAgICAgICAgICBjYXB0dXJlID0gbmFtZWRDYXB0dXJlc1tjaC5zbGljZSgxLCAtMSldOwogICAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAvLyBcZFxkPwogICAgICAgICAgICAgICAgICB2YXIgbiA9ICtjaDsKICAgICAgICAgICAgICAgICAgaWYgKG4gPT09IDApIHJldHVybiBtYXRjaDsKCiAgICAgICAgICAgICAgICAgIGlmIChuID4gbSkgewogICAgICAgICAgICAgICAgICAgIHZhciBmID0gZmxvb3IobiAvIDEwKTsKICAgICAgICAgICAgICAgICAgICBpZiAoZiA9PT0gMCkgcmV0dXJuIG1hdGNoOwogICAgICAgICAgICAgICAgICAgIGlmIChmIDw9IG0pIHJldHVybiBjYXB0dXJlc1tmIC0gMV0gPT09IHVuZGVmaW5lZCA/IGNoLmNoYXJBdCgxKSA6IGNhcHR1cmVzW2YgLSAxXSArIGNoLmNoYXJBdCgxKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWF0Y2g7CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIGNhcHR1cmUgPSBjYXB0dXJlc1tuIC0gMV07CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICByZXR1cm4gY2FwdHVyZSA9PT0gdW5kZWZpbmVkID8gJycgOiBjYXB0dXJlOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICAvKioqLwoKICAgICAgfSwKCiAgICAgIC8qKiovCiAgICAgICJhYWUzIjoKICAgICAgLyoqKi8KICAgICAgZnVuY3Rpb24gYWFlMyhtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKICAgICAgICAvLyA3LjIuOCBJc1JlZ0V4cChhcmd1bWVudCkKICAgICAgICB2YXIgaXNPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCJkM2Y0Iik7CgogICAgICAgIHZhciBjb2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCIyZDk1Iik7CgogICAgICAgIHZhciBNQVRDSCA9IF9fd2VicGFja19yZXF1aXJlX18oIjJiNGMiKSgnbWF0Y2gnKTsKCiAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXQpIHsKICAgICAgICAgIHZhciBpc1JlZ0V4cDsKICAgICAgICAgIHJldHVybiBpc09iamVjdChpdCkgJiYgKChpc1JlZ0V4cCA9IGl0W01BVENIXSkgIT09IHVuZGVmaW5lZCA/ICEhaXNSZWdFeHAgOiBjb2YoaXQpID09ICdSZWdFeHAnKTsKICAgICAgICB9OwogICAgICAgIC8qKiovCgogICAgICB9LAoKICAgICAgLyoqKi8KICAgICAgImFjNmEiOgogICAgICAvKioqLwogICAgICBmdW5jdGlvbiBhYzZhKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewogICAgICAgIHZhciAkaXRlcmF0b3JzID0gX193ZWJwYWNrX3JlcXVpcmVfXygiY2FkZiIpOwoKICAgICAgICB2YXIgZ2V0S2V5cyA9IF9fd2VicGFja19yZXF1aXJlX18oIjBkNTgiKTsKCiAgICAgICAgdmFyIHJlZGVmaW5lID0gX193ZWJwYWNrX3JlcXVpcmVfXygiMmFiYSIpOwoKICAgICAgICB2YXIgZ2xvYmFsID0gX193ZWJwYWNrX3JlcXVpcmVfXygiNzcyNiIpOwoKICAgICAgICB2YXIgaGlkZSA9IF9fd2VicGFja19yZXF1aXJlX18oIjMyZTkiKTsKCiAgICAgICAgdmFyIEl0ZXJhdG9ycyA9IF9fd2VicGFja19yZXF1aXJlX18oIjg0ZjIiKTsKCiAgICAgICAgdmFyIHdrcyA9IF9fd2VicGFja19yZXF1aXJlX18oIjJiNGMiKTsKCiAgICAgICAgdmFyIElURVJBVE9SID0gd2tzKCdpdGVyYXRvcicpOwogICAgICAgIHZhciBUT19TVFJJTkdfVEFHID0gd2tzKCd0b1N0cmluZ1RhZycpOwogICAgICAgIHZhciBBcnJheVZhbHVlcyA9IEl0ZXJhdG9ycy5BcnJheTsKICAgICAgICB2YXIgRE9NSXRlcmFibGVzID0gewogICAgICAgICAgQ1NTUnVsZUxpc3Q6IHRydWUsCiAgICAgICAgICAvLyBUT0RPOiBOb3Qgc3BlYyBjb21wbGlhbnQsIHNob3VsZCBiZSBmYWxzZS4KICAgICAgICAgIENTU1N0eWxlRGVjbGFyYXRpb246IGZhbHNlLAogICAgICAgICAgQ1NTVmFsdWVMaXN0OiBmYWxzZSwKICAgICAgICAgIENsaWVudFJlY3RMaXN0OiBmYWxzZSwKICAgICAgICAgIERPTVJlY3RMaXN0OiBmYWxzZSwKICAgICAgICAgIERPTVN0cmluZ0xpc3Q6IGZhbHNlLAogICAgICAgICAgRE9NVG9rZW5MaXN0OiB0cnVlLAogICAgICAgICAgRGF0YVRyYW5zZmVySXRlbUxpc3Q6IGZhbHNlLAogICAgICAgICAgRmlsZUxpc3Q6IGZhbHNlLAogICAgICAgICAgSFRNTEFsbENvbGxlY3Rpb246IGZhbHNlLAogICAgICAgICAgSFRNTENvbGxlY3Rpb246IGZhbHNlLAogICAgICAgICAgSFRNTEZvcm1FbGVtZW50OiBmYWxzZSwKICAgICAgICAgIEhUTUxTZWxlY3RFbGVtZW50OiBmYWxzZSwKICAgICAgICAgIE1lZGlhTGlzdDogdHJ1ZSwKICAgICAgICAgIC8vIFRPRE86IE5vdCBzcGVjIGNvbXBsaWFudCwgc2hvdWxkIGJlIGZhbHNlLgogICAgICAgICAgTWltZVR5cGVBcnJheTogZmFsc2UsCiAgICAgICAgICBOYW1lZE5vZGVNYXA6IGZhbHNlLAogICAgICAgICAgTm9kZUxpc3Q6IHRydWUsCiAgICAgICAgICBQYWludFJlcXVlc3RMaXN0OiBmYWxzZSwKICAgICAgICAgIFBsdWdpbjogZmFsc2UsCiAgICAgICAgICBQbHVnaW5BcnJheTogZmFsc2UsCiAgICAgICAgICBTVkdMZW5ndGhMaXN0OiBmYWxzZSwKICAgICAgICAgIFNWR051bWJlckxpc3Q6IGZhbHNlLAogICAgICAgICAgU1ZHUGF0aFNlZ0xpc3Q6IGZhbHNlLAogICAgICAgICAgU1ZHUG9pbnRMaXN0OiBmYWxzZSwKICAgICAgICAgIFNWR1N0cmluZ0xpc3Q6IGZhbHNlLAogICAgICAgICAgU1ZHVHJhbnNmb3JtTGlzdDogZmFsc2UsCiAgICAgICAgICBTb3VyY2VCdWZmZXJMaXN0OiBmYWxzZSwKICAgICAgICAgIFN0eWxlU2hlZXRMaXN0OiB0cnVlLAogICAgICAgICAgLy8gVE9ETzogTm90IHNwZWMgY29tcGxpYW50LCBzaG91bGQgYmUgZmFsc2UuCiAgICAgICAgICBUZXh0VHJhY2tDdWVMaXN0OiBmYWxzZSwKICAgICAgICAgIFRleHRUcmFja0xpc3Q6IGZhbHNlLAogICAgICAgICAgVG91Y2hMaXN0OiBmYWxzZQogICAgICAgIH07CgogICAgICAgIGZvciAodmFyIGNvbGxlY3Rpb25zID0gZ2V0S2V5cyhET01JdGVyYWJsZXMpLCBpID0gMDsgaSA8IGNvbGxlY3Rpb25zLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICB2YXIgTkFNRSA9IGNvbGxlY3Rpb25zW2ldOwogICAgICAgICAgdmFyIGV4cGxpY2l0ID0gRE9NSXRlcmFibGVzW05BTUVdOwogICAgICAgICAgdmFyIENvbGxlY3Rpb24gPSBnbG9iYWxbTkFNRV07CiAgICAgICAgICB2YXIgcHJvdG8gPSBDb2xsZWN0aW9uICYmIENvbGxlY3Rpb24ucHJvdG90eXBlOwogICAgICAgICAgdmFyIGtleTsKCiAgICAgICAgICBpZiAocHJvdG8pIHsKICAgICAgICAgICAgaWYgKCFwcm90b1tJVEVSQVRPUl0pIGhpZGUocHJvdG8sIElURVJBVE9SLCBBcnJheVZhbHVlcyk7CiAgICAgICAgICAgIGlmICghcHJvdG9bVE9fU1RSSU5HX1RBR10pIGhpZGUocHJvdG8sIFRPX1NUUklOR19UQUcsIE5BTUUpOwogICAgICAgICAgICBJdGVyYXRvcnNbTkFNRV0gPSBBcnJheVZhbHVlczsKICAgICAgICAgICAgaWYgKGV4cGxpY2l0KSBmb3IgKGtleSBpbiAkaXRlcmF0b3JzKSB7CiAgICAgICAgICAgICAgaWYgKCFwcm90b1trZXldKSByZWRlZmluZShwcm90bywga2V5LCAkaXRlcmF0b3JzW2tleV0sIHRydWUpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIC8qKiovCgogICAgICB9LAoKICAgICAgLyoqKi8KICAgICAgImIwYzUiOgogICAgICAvKioqLwogICAgICBmdW5jdGlvbiBiMGM1KG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewogICAgICAgICJ1c2Ugc3RyaWN0IjsKCiAgICAgICAgdmFyIHJlZ2V4cEV4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCI1MjBhIik7CgogICAgICAgIF9fd2VicGFja19yZXF1aXJlX18oIjVjYTEiKSh7CiAgICAgICAgICB0YXJnZXQ6ICdSZWdFeHAnLAogICAgICAgICAgcHJvdG86IHRydWUsCiAgICAgICAgICBmb3JjZWQ6IHJlZ2V4cEV4ZWMgIT09IC8uLy5leGVjCiAgICAgICAgfSwgewogICAgICAgICAgZXhlYzogcmVnZXhwRXhlYwogICAgICAgIH0pOwogICAgICAgIC8qKiovCgogICAgICB9LAoKICAgICAgLyoqKi8KICAgICAgImJlMTMiOgogICAgICAvKioqLwogICAgICBmdW5jdGlvbiBiZTEzKG1vZHVsZSwgZXhwb3J0cykgewogICAgICAgIC8vIDcuMi4xIFJlcXVpcmVPYmplY3RDb2VyY2libGUoYXJndW1lbnQpCiAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXQpIHsKICAgICAgICAgIGlmIChpdCA9PSB1bmRlZmluZWQpIHRocm93IFR5cGVFcnJvcigiQ2FuJ3QgY2FsbCBtZXRob2Qgb24gICIgKyBpdCk7CiAgICAgICAgICByZXR1cm4gaXQ7CiAgICAgICAgfTsKICAgICAgICAvKioqLwoKICAgICAgfSwKCiAgICAgIC8qKiovCiAgICAgICJjMzY2IjoKICAgICAgLyoqKi8KICAgICAgZnVuY3Rpb24gYzM2Nihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKICAgICAgICAvLyBmYWxzZSAtPiBBcnJheSNpbmRleE9mCiAgICAgICAgLy8gdHJ1ZSAgLT4gQXJyYXkjaW5jbHVkZXMKICAgICAgICB2YXIgdG9JT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygiNjgyMSIpOwoKICAgICAgICB2YXIgdG9MZW5ndGggPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCI5ZGVmIik7CgogICAgICAgIHZhciB0b0Fic29sdXRlSW5kZXggPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCI3N2YxIik7CgogICAgICAgIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKElTX0lOQ0xVREVTKSB7CiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCR0aGlzLCBlbCwgZnJvbUluZGV4KSB7CiAgICAgICAgICAgIHZhciBPID0gdG9JT2JqZWN0KCR0aGlzKTsKICAgICAgICAgICAgdmFyIGxlbmd0aCA9IHRvTGVuZ3RoKE8ubGVuZ3RoKTsKICAgICAgICAgICAgdmFyIGluZGV4ID0gdG9BYnNvbHV0ZUluZGV4KGZyb21JbmRleCwgbGVuZ3RoKTsKICAgICAgICAgICAgdmFyIHZhbHVlOyAvLyBBcnJheSNpbmNsdWRlcyB1c2VzIFNhbWVWYWx1ZVplcm8gZXF1YWxpdHkgYWxnb3JpdGhtCiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1zZWxmLWNvbXBhcmUKCiAgICAgICAgICAgIGlmIChJU19JTkNMVURFUyAmJiBlbCAhPSBlbCkgd2hpbGUgKGxlbmd0aCA+IGluZGV4KSB7CiAgICAgICAgICAgICAgdmFsdWUgPSBPW2luZGV4KytdOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tc2VsZi1jb21wYXJlCgogICAgICAgICAgICAgIGlmICh2YWx1ZSAhPSB2YWx1ZSkgcmV0dXJuIHRydWU7IC8vIEFycmF5I2luZGV4T2YgaWdub3JlcyBob2xlcywgQXJyYXkjaW5jbHVkZXMgLSBub3QKICAgICAgICAgICAgfSBlbHNlIGZvciAoOyBsZW5ndGggPiBpbmRleDsgaW5kZXgrKykgewogICAgICAgICAgICAgIGlmIChJU19JTkNMVURFUyB8fCBpbmRleCBpbiBPKSB7CiAgICAgICAgICAgICAgICBpZiAoT1tpbmRleF0gPT09IGVsKSByZXR1cm4gSVNfSU5DTFVERVMgfHwgaW5kZXggfHwgMDsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuICFJU19JTkNMVURFUyAmJiAtMTsKICAgICAgICAgIH07CiAgICAgICAgfTsKICAgICAgICAvKioqLwoKICAgICAgfSwKCiAgICAgIC8qKiovCiAgICAgICJjNjQ5IjoKICAgICAgLyoqKi8KICAgICAgZnVuY3Rpb24gYzY0OShtb2R1bGUsIF9fd2VicGFja19leHBvcnRzX18sIF9fd2VicGFja19yZXF1aXJlX18pIHsKICAgICAgICAidXNlIHN0cmljdCI7CiAgICAgICAgLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovCgogICAgICAgIChmdW5jdGlvbiAoZ2xvYmFsKSB7CiAgICAgICAgICAvKiBoYXJtb255IGV4cG9ydCAoYmluZGluZykgKi8KICAgICAgICAgIF9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCAiYyIsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcmV0dXJuIGluc2VydE5vZGVBdDsKICAgICAgICAgIH0pOwogICAgICAgICAgLyogaGFybW9ueSBleHBvcnQgKGJpbmRpbmcpICovCgoKICAgICAgICAgIF9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCAiYSIsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcmV0dXJuIGNhbWVsaXplOwogICAgICAgICAgfSk7CiAgICAgICAgICAvKiBoYXJtb255IGV4cG9ydCAoYmluZGluZykgKi8KCgogICAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sICJiIiwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gY29uc29sZTsKICAgICAgICAgIH0pOwogICAgICAgICAgLyogaGFybW9ueSBleHBvcnQgKGJpbmRpbmcpICovCgoKICAgICAgICAgIF9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCAiZCIsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcmV0dXJuIHJlbW92ZU5vZGU7CiAgICAgICAgICB9KTsKICAgICAgICAgIC8qIGhhcm1vbnkgaW1wb3J0ICovCgoKICAgICAgICAgIHZhciBjb3JlX2pzX21vZHVsZXNfZXM2X3JlZ2V4cF9yZXBsYWNlX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCJhNDgxIik7CiAgICAgICAgICAvKiBoYXJtb255IGltcG9ydCAqLwoKCiAgICAgICAgICB2YXIgY29yZV9qc19tb2R1bGVzX2VzNl9yZWdleHBfcmVwbGFjZV9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fX2RlZmF1bHQgPSAvKiNfX1BVUkVfXyovX193ZWJwYWNrX3JlcXVpcmVfXy5uKGNvcmVfanNfbW9kdWxlc19lczZfcmVnZXhwX3JlcGxhY2VfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfXyk7CgogICAgICAgICAgZnVuY3Rpb24gZ2V0Q29uc29sZSgpIHsKICAgICAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHdpbmRvdy5jb25zb2xlOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gZ2xvYmFsLmNvbnNvbGU7CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIGNvbnNvbGUgPSBnZXRDb25zb2xlKCk7CgogICAgICAgICAgZnVuY3Rpb24gY2FjaGVkKGZuKSB7CiAgICAgICAgICAgIHZhciBjYWNoZSA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiBjYWNoZWRGbihzdHIpIHsKICAgICAgICAgICAgICB2YXIgaGl0ID0gY2FjaGVbc3RyXTsKICAgICAgICAgICAgICByZXR1cm4gaGl0IHx8IChjYWNoZVtzdHJdID0gZm4oc3RyKSk7CiAgICAgICAgICAgIH07CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIHJlZ2V4ID0gLy0oXHcpL2c7CiAgICAgICAgICB2YXIgY2FtZWxpemUgPSBjYWNoZWQoZnVuY3Rpb24gKHN0cikgewogICAgICAgICAgICByZXR1cm4gc3RyLnJlcGxhY2UocmVnZXgsIGZ1bmN0aW9uIChfLCBjKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGMgPyBjLnRvVXBwZXJDYXNlKCkgOiAiIjsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKCiAgICAgICAgICBmdW5jdGlvbiByZW1vdmVOb2RlKG5vZGUpIHsKICAgICAgICAgICAgaWYgKG5vZGUucGFyZW50RWxlbWVudCAhPT0gbnVsbCkgewogICAgICAgICAgICAgIG5vZGUucGFyZW50RWxlbWVudC5yZW1vdmVDaGlsZChub2RlKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGZ1bmN0aW9uIGluc2VydE5vZGVBdChmYXRoZXJOb2RlLCBub2RlLCBwb3NpdGlvbikgewogICAgICAgICAgICB2YXIgcmVmTm9kZSA9IHBvc2l0aW9uID09PSAwID8gZmF0aGVyTm9kZS5jaGlsZHJlblswXSA6IGZhdGhlck5vZGUuY2hpbGRyZW5bcG9zaXRpb24gLSAxXS5uZXh0U2libGluZzsKICAgICAgICAgICAgZmF0aGVyTm9kZS5pbnNlcnRCZWZvcmUobm9kZSwgcmVmTm9kZSk7CiAgICAgICAgICB9CiAgICAgICAgICAvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8KCiAgICAgICAgfSkuY2FsbCh0aGlzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKCJjOGJhIikpOwogICAgICAgIC8qKiovCiAgICAgIH0sCgogICAgICAvKioqLwogICAgICAiYzY5YSI6CiAgICAgIC8qKiovCiAgICAgIGZ1bmN0aW9uIGM2OWEobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CiAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSAhX193ZWJwYWNrX3JlcXVpcmVfXygiOWUxZSIpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fKCI3OWU1IikoZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShfX3dlYnBhY2tfcmVxdWlyZV9fKCIyMzBlIikoJ2RpdicpLCAnYScsIHsKICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgICAgICAgcmV0dXJuIDc7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pLmEgIT0gNzsKICAgICAgICB9KTsKICAgICAgICAvKioqLwogICAgICB9LAoKICAgICAgLyoqKi8KICAgICAgImM4YmEiOgogICAgICAvKioqLwogICAgICBmdW5jdGlvbiBjOGJhKG1vZHVsZSwgZXhwb3J0cykgewogICAgICAgIHZhciBnOyAvLyBUaGlzIHdvcmtzIGluIG5vbi1zdHJpY3QgbW9kZQoKICAgICAgICBnID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgfSgpOwoKICAgICAgICB0cnkgewogICAgICAgICAgLy8gVGhpcyB3b3JrcyBpZiBldmFsIGlzIGFsbG93ZWQgKHNlZSBDU1ApCiAgICAgICAgICBnID0gZyB8fCBuZXcgRnVuY3Rpb24oInJldHVybiB0aGlzIikoKTsKICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAvLyBUaGlzIHdvcmtzIGlmIHRoZSB3aW5kb3cgcmVmZXJlbmNlIGlzIGF2YWlsYWJsZQogICAgICAgICAgaWYgKCh0eXBlb2Ygd2luZG93ID09PSAidW5kZWZpbmVkIiA/ICJ1bmRlZmluZWQiIDogX3R5cGVvZih3aW5kb3cpKSA9PT0gIm9iamVjdCIpIGcgPSB3aW5kb3c7CiAgICAgICAgfSAvLyBnIGNhbiBzdGlsbCBiZSB1bmRlZmluZWQsIGJ1dCBub3RoaW5nIHRvIGRvIGFib3V0IGl0Li4uCiAgICAgICAgLy8gV2UgcmV0dXJuIHVuZGVmaW5lZCwgaW5zdGVhZCBvZiBub3RoaW5nIGhlcmUsIHNvIGl0J3MKICAgICAgICAvLyBlYXNpZXIgdG8gaGFuZGxlIHRoaXMgY2FzZS4gaWYoIWdsb2JhbCkgeyAuLi59CgoKICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGc7CiAgICAgICAgLyoqKi8KICAgICAgfSwKCiAgICAgIC8qKiovCiAgICAgICJjYTVhIjoKICAgICAgLyoqKi8KICAgICAgZnVuY3Rpb24gY2E1YShtb2R1bGUsIGV4cG9ydHMpIHsKICAgICAgICB2YXIgaWQgPSAwOwogICAgICAgIHZhciBweCA9IE1hdGgucmFuZG9tKCk7CgogICAgICAgIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGtleSkgewogICAgICAgICAgcmV0dXJuICdTeW1ib2woJy5jb25jYXQoa2V5ID09PSB1bmRlZmluZWQgPyAnJyA6IGtleSwgJylfJywgKCsraWQgKyBweCkudG9TdHJpbmcoMzYpKTsKICAgICAgICB9OwogICAgICAgIC8qKiovCgogICAgICB9LAoKICAgICAgLyoqKi8KICAgICAgImNhZGYiOgogICAgICAvKioqLwogICAgICBmdW5jdGlvbiBjYWRmKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewogICAgICAgICJ1c2Ugc3RyaWN0IjsKCiAgICAgICAgdmFyIGFkZFRvVW5zY29wYWJsZXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCI5YzZjIik7CgogICAgICAgIHZhciBzdGVwID0gX193ZWJwYWNrX3JlcXVpcmVfXygiZDUzYiIpOwoKICAgICAgICB2YXIgSXRlcmF0b3JzID0gX193ZWJwYWNrX3JlcXVpcmVfXygiODRmMiIpOwoKICAgICAgICB2YXIgdG9JT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygiNjgyMSIpOyAvLyAyMi4xLjMuNCBBcnJheS5wcm90b3R5cGUuZW50cmllcygpCiAgICAgICAgLy8gMjIuMS4zLjEzIEFycmF5LnByb3RvdHlwZS5rZXlzKCkKICAgICAgICAvLyAyMi4xLjMuMjkgQXJyYXkucHJvdG90eXBlLnZhbHVlcygpCiAgICAgICAgLy8gMjIuMS4zLjMwIEFycmF5LnByb3RvdHlwZVtAQGl0ZXJhdG9yXSgpCgoKICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oIjAxZjkiKShBcnJheSwgJ0FycmF5JywgZnVuY3Rpb24gKGl0ZXJhdGVkLCBraW5kKSB7CiAgICAgICAgICB0aGlzLl90ID0gdG9JT2JqZWN0KGl0ZXJhdGVkKTsgLy8gdGFyZ2V0CgogICAgICAgICAgdGhpcy5faSA9IDA7IC8vIG5leHQgaW5kZXgKCiAgICAgICAgICB0aGlzLl9rID0ga2luZDsgLy8ga2luZAogICAgICAgICAgLy8gMjIuMS41LjIuMSAlQXJyYXlJdGVyYXRvclByb3RvdHlwZSUubmV4dCgpCiAgICAgICAgfSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgdmFyIE8gPSB0aGlzLl90OwogICAgICAgICAgdmFyIGtpbmQgPSB0aGlzLl9rOwogICAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5faSsrOwoKICAgICAgICAgIGlmICghTyB8fCBpbmRleCA+PSBPLmxlbmd0aCkgewogICAgICAgICAgICB0aGlzLl90ID0gdW5kZWZpbmVkOwogICAgICAgICAgICByZXR1cm4gc3RlcCgxKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoa2luZCA9PSAna2V5cycpIHJldHVybiBzdGVwKDAsIGluZGV4KTsKICAgICAgICAgIGlmIChraW5kID09ICd2YWx1ZXMnKSByZXR1cm4gc3RlcCgwLCBPW2luZGV4XSk7CiAgICAgICAgICByZXR1cm4gc3RlcCgwLCBbaW5kZXgsIE9baW5kZXhdXSk7CiAgICAgICAgfSwgJ3ZhbHVlcycpOyAvLyBhcmd1bWVudHNMaXN0W0BAaXRlcmF0b3JdIGlzICVBcnJheVByb3RvX3ZhbHVlcyUgKDkuNC40LjYsIDkuNC40LjcpCgogICAgICAgIEl0ZXJhdG9ycy5Bcmd1bWVudHMgPSBJdGVyYXRvcnMuQXJyYXk7CiAgICAgICAgYWRkVG9VbnNjb3BhYmxlcygna2V5cycpOwogICAgICAgIGFkZFRvVW5zY29wYWJsZXMoJ3ZhbHVlcycpOwogICAgICAgIGFkZFRvVW5zY29wYWJsZXMoJ2VudHJpZXMnKTsKICAgICAgICAvKioqLwogICAgICB9LAoKICAgICAgLyoqKi8KICAgICAgImNiN2MiOgogICAgICAvKioqLwogICAgICBmdW5jdGlvbiBjYjdjKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewogICAgICAgIHZhciBpc09iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oImQzZjQiKTsKCiAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXQpIHsKICAgICAgICAgIGlmICghaXNPYmplY3QoaXQpKSB0aHJvdyBUeXBlRXJyb3IoaXQgKyAnIGlzIG5vdCBhbiBvYmplY3QhJyk7CiAgICAgICAgICByZXR1cm4gaXQ7CiAgICAgICAgfTsKICAgICAgICAvKioqLwoKICAgICAgfSwKCiAgICAgIC8qKiovCiAgICAgICJjZTEwIjoKICAgICAgLyoqKi8KICAgICAgZnVuY3Rpb24gY2UxMChtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKICAgICAgICB2YXIgaGFzID0gX193ZWJwYWNrX3JlcXVpcmVfXygiNjlhOCIpOwoKICAgICAgICB2YXIgdG9JT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygiNjgyMSIpOwoKICAgICAgICB2YXIgYXJyYXlJbmRleE9mID0gX193ZWJwYWNrX3JlcXVpcmVfXygiYzM2NiIpKGZhbHNlKTsKCiAgICAgICAgdmFyIElFX1BST1RPID0gX193ZWJwYWNrX3JlcXVpcmVfXygiNjEzYiIpKCdJRV9QUk9UTycpOwoKICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChvYmplY3QsIG5hbWVzKSB7CiAgICAgICAgICB2YXIgTyA9IHRvSU9iamVjdChvYmplY3QpOwogICAgICAgICAgdmFyIGkgPSAwOwogICAgICAgICAgdmFyIHJlc3VsdCA9IFtdOwogICAgICAgICAgdmFyIGtleTsKCiAgICAgICAgICBmb3IgKGtleSBpbiBPKSB7CiAgICAgICAgICAgIGlmIChrZXkgIT0gSUVfUFJPVE8pIGhhcyhPLCBrZXkpICYmIHJlc3VsdC5wdXNoKGtleSk7CiAgICAgICAgICB9IC8vIERvbid0IGVudW0gYnVnICYgaGlkZGVuIGtleXMKCgogICAgICAgICAgd2hpbGUgKG5hbWVzLmxlbmd0aCA+IGkpIHsKICAgICAgICAgICAgaWYgKGhhcyhPLCBrZXkgPSBuYW1lc1tpKytdKSkgewogICAgICAgICAgICAgIH5hcnJheUluZGV4T2YocmVzdWx0LCBrZXkpIHx8IHJlc3VsdC5wdXNoKGtleSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICAgIH07CiAgICAgICAgLyoqKi8KCiAgICAgIH0sCgogICAgICAvKioqLwogICAgICAiZDJjOCI6CiAgICAgIC8qKiovCiAgICAgIGZ1bmN0aW9uIGQyYzgobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CiAgICAgICAgLy8gaGVscGVyIGZvciBTdHJpbmcje3N0YXJ0c1dpdGgsIGVuZHNXaXRoLCBpbmNsdWRlc30KICAgICAgICB2YXIgaXNSZWdFeHAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCJhYWUzIik7CgogICAgICAgIHZhciBkZWZpbmVkID0gX193ZWJwYWNrX3JlcXVpcmVfXygiYmUxMyIpOwoKICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uICh0aGF0LCBzZWFyY2hTdHJpbmcsIE5BTUUpIHsKICAgICAgICAgIGlmIChpc1JlZ0V4cChzZWFyY2hTdHJpbmcpKSB0aHJvdyBUeXBlRXJyb3IoJ1N0cmluZyMnICsgTkFNRSArICIgZG9lc24ndCBhY2NlcHQgcmVnZXghIik7CiAgICAgICAgICByZXR1cm4gU3RyaW5nKGRlZmluZWQodGhhdCkpOwogICAgICAgIH07CiAgICAgICAgLyoqKi8KCiAgICAgIH0sCgogICAgICAvKioqLwogICAgICAiZDNmNCI6CiAgICAgIC8qKiovCiAgICAgIGZ1bmN0aW9uIGQzZjQobW9kdWxlLCBleHBvcnRzKSB7CiAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXQpIHsKICAgICAgICAgIHJldHVybiBfdHlwZW9mKGl0KSA9PT0gJ29iamVjdCcgPyBpdCAhPT0gbnVsbCA6IHR5cGVvZiBpdCA9PT0gJ2Z1bmN0aW9uJzsKICAgICAgICB9OwogICAgICAgIC8qKiovCgogICAgICB9LAoKICAgICAgLyoqKi8KICAgICAgImQ1M2IiOgogICAgICAvKioqLwogICAgICBmdW5jdGlvbiBkNTNiKG1vZHVsZSwgZXhwb3J0cykgewogICAgICAgIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGRvbmUsIHZhbHVlKSB7CiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICB2YWx1ZTogdmFsdWUsCiAgICAgICAgICAgIGRvbmU6ICEhZG9uZQogICAgICAgICAgfTsKICAgICAgICB9OwogICAgICAgIC8qKiovCgogICAgICB9LAoKICAgICAgLyoqKi8KICAgICAgImQ4ZTgiOgogICAgICAvKioqLwogICAgICBmdW5jdGlvbiBkOGU4KG1vZHVsZSwgZXhwb3J0cykgewogICAgICAgIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGl0KSB7CiAgICAgICAgICBpZiAodHlwZW9mIGl0ICE9ICdmdW5jdGlvbicpIHRocm93IFR5cGVFcnJvcihpdCArICcgaXMgbm90IGEgZnVuY3Rpb24hJyk7CiAgICAgICAgICByZXR1cm4gaXQ7CiAgICAgICAgfTsKICAgICAgICAvKioqLwoKICAgICAgfSwKCiAgICAgIC8qKiovCiAgICAgICJlMTFlIjoKICAgICAgLyoqKi8KICAgICAgZnVuY3Rpb24gZTExZShtb2R1bGUsIGV4cG9ydHMpIHsKICAgICAgICAvLyBJRSA4LSBkb24ndCBlbnVtIGJ1ZyBrZXlzCiAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSAnY29uc3RydWN0b3IsaGFzT3duUHJvcGVydHksaXNQcm90b3R5cGVPZixwcm9wZXJ0eUlzRW51bWVyYWJsZSx0b0xvY2FsZVN0cmluZyx0b1N0cmluZyx2YWx1ZU9mJy5zcGxpdCgnLCcpOwogICAgICAgIC8qKiovCiAgICAgIH0sCgogICAgICAvKioqLwogICAgICAiZjU1OSI6CiAgICAgIC8qKiovCiAgICAgIGZ1bmN0aW9uIGY1NTkobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CiAgICAgICAgInVzZSBzdHJpY3QiOyAvLyAyMS4xLjMuMTggU3RyaW5nLnByb3RvdHlwZS5zdGFydHNXaXRoKHNlYXJjaFN0cmluZyBbLCBwb3NpdGlvbiBdKQoKICAgICAgICB2YXIgJGV4cG9ydCA9IF9fd2VicGFja19yZXF1aXJlX18oIjVjYTEiKTsKCiAgICAgICAgdmFyIHRvTGVuZ3RoID0gX193ZWJwYWNrX3JlcXVpcmVfXygiOWRlZiIpOwoKICAgICAgICB2YXIgY29udGV4dCA9IF9fd2VicGFja19yZXF1aXJlX18oImQyYzgiKTsKCiAgICAgICAgdmFyIFNUQVJUU19XSVRIID0gJ3N0YXJ0c1dpdGgnOwogICAgICAgIHZhciAkc3RhcnRzV2l0aCA9ICcnW1NUQVJUU19XSVRIXTsKICAgICAgICAkZXhwb3J0KCRleHBvcnQuUCArICRleHBvcnQuRiAqIF9fd2VicGFja19yZXF1aXJlX18oIjUxNDciKShTVEFSVFNfV0lUSCksICdTdHJpbmcnLCB7CiAgICAgICAgICBzdGFydHNXaXRoOiBmdW5jdGlvbiBzdGFydHNXaXRoKHNlYXJjaFN0cmluZwogICAgICAgICAgLyogLCBwb3NpdGlvbiA9IDAgKi8KICAgICAgICAgICkgewogICAgICAgICAgICB2YXIgdGhhdCA9IGNvbnRleHQodGhpcywgc2VhcmNoU3RyaW5nLCBTVEFSVFNfV0lUSCk7CiAgICAgICAgICAgIHZhciBpbmRleCA9IHRvTGVuZ3RoKE1hdGgubWluKGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkLCB0aGF0Lmxlbmd0aCkpOwogICAgICAgICAgICB2YXIgc2VhcmNoID0gU3RyaW5nKHNlYXJjaFN0cmluZyk7CiAgICAgICAgICAgIHJldHVybiAkc3RhcnRzV2l0aCA/ICRzdGFydHNXaXRoLmNhbGwodGhhdCwgc2VhcmNoLCBpbmRleCkgOiB0aGF0LnNsaWNlKGluZGV4LCBpbmRleCArIHNlYXJjaC5sZW5ndGgpID09PSBzZWFyY2g7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgLyoqKi8KICAgICAgfSwKCiAgICAgIC8qKiovCiAgICAgICJmNmZkIjoKICAgICAgLyoqKi8KICAgICAgZnVuY3Rpb24gZjZmZChtb2R1bGUsIGV4cG9ydHMpIHsKICAgICAgICAvLyBkb2N1bWVudC5jdXJyZW50U2NyaXB0IHBvbHlmaWxsIGJ5IEFkYW0gTWlsbGVyCiAgICAgICAgLy8gTUlUIGxpY2Vuc2UKICAgICAgICAoZnVuY3Rpb24gKGRvY3VtZW50KSB7CiAgICAgICAgICB2YXIgY3VycmVudFNjcmlwdCA9ICJjdXJyZW50U2NyaXB0IiwKICAgICAgICAgICAgICBzY3JpcHRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3NjcmlwdCcpOyAvLyBMaXZlIE5vZGVMaXN0IGNvbGxlY3Rpb24KICAgICAgICAgIC8vIElmIGJyb3dzZXIgbmVlZHMgY3VycmVudFNjcmlwdCBwb2x5ZmlsbCwgYWRkIGdldCBjdXJyZW50U2NyaXB0KCkgdG8gdGhlIGRvY3VtZW50IG9iamVjdAoKICAgICAgICAgIGlmICghKGN1cnJlbnRTY3JpcHQgaW4gZG9jdW1lbnQpKSB7CiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShkb2N1bWVudCwgY3VycmVudFNjcmlwdCwgewogICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgICAgICAgICAgLy8gSUUgNi0xMCBzdXBwb3J0cyBzY3JpcHQgcmVhZHlTdGF0ZQogICAgICAgICAgICAgICAgLy8gSUUgMTArIHN1cHBvcnQgc3RhY2sgdHJhY2UKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigpOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgICAgICAgIC8vIEZpbmQgdGhlIHNlY29uZCBtYXRjaCBmb3IgdGhlICJhdCIgc3RyaW5nIHRvIGdldCBmaWxlIHNyYyB1cmwgZnJvbSBzdGFjay4KICAgICAgICAgICAgICAgICAgLy8gU3BlY2lmaWNhbGx5IHdvcmtzIHdpdGggdGhlIGZvcm1hdCBvZiBzdGFjayB0cmFjZXMgaW4gSUUuCiAgICAgICAgICAgICAgICAgIHZhciBpLAogICAgICAgICAgICAgICAgICAgICAgcmVzID0gKC8uKmF0IFteXChdKlwoKC4qKTouKzouK1wpJC9pZy5leGVjKGVyci5zdGFjaykgfHwgW2ZhbHNlXSlbMV07IC8vIEZvciBhbGwgc2NyaXB0cyBvbiB0aGUgcGFnZSwgaWYgc3JjIG1hdGNoZXMgb3IgaWYgcmVhZHkgc3RhdGUgaXMgaW50ZXJhY3RpdmUsIHJldHVybiB0aGUgc2NyaXB0IHRhZwoKICAgICAgICAgICAgICAgICAgZm9yIChpIGluIHNjcmlwdHMpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoc2NyaXB0c1tpXS5zcmMgPT0gcmVzIHx8IHNjcmlwdHNbaV0ucmVhZHlTdGF0ZSA9PSAiaW50ZXJhY3RpdmUiKSB7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2NyaXB0c1tpXTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0gLy8gSWYgbm8gbWF0Y2gsIHJldHVybiBudWxsCgoKICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9KShkb2N1bWVudCk7CiAgICAgICAgLyoqKi8KCiAgICAgIH0sCgogICAgICAvKioqLwogICAgICAiZjc1MSI6CiAgICAgIC8qKiovCiAgICAgIGZ1bmN0aW9uIGY3NTEobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CiAgICAgICAgLy8gMTkuMS4zLjEgT2JqZWN0LmFzc2lnbih0YXJnZXQsIHNvdXJjZSkKICAgICAgICB2YXIgJGV4cG9ydCA9IF9fd2VicGFja19yZXF1aXJlX18oIjVjYTEiKTsKCiAgICAgICAgJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYsICdPYmplY3QnLCB7CiAgICAgICAgICBhc3NpZ246IF9fd2VicGFja19yZXF1aXJlX18oIjczMzMiKQogICAgICAgIH0pOwogICAgICAgIC8qKiovCiAgICAgIH0sCgogICAgICAvKioqLwogICAgICAiZmE1YiI6CiAgICAgIC8qKiovCiAgICAgIGZ1bmN0aW9uIGZhNWIobW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CiAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCI1NTM3IikoJ25hdGl2ZS1mdW5jdGlvbi10by1zdHJpbmcnLCBGdW5jdGlvbi50b1N0cmluZyk7CiAgICAgICAgLyoqKi8KICAgICAgfSwKCiAgICAgIC8qKiovCiAgICAgICJmYWIyIjoKICAgICAgLyoqKi8KICAgICAgZnVuY3Rpb24gZmFiMihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKICAgICAgICB2YXIgZG9jdW1lbnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCI3NzI2IikuZG9jdW1lbnQ7CgogICAgICAgIG1vZHVsZS5leHBvcnRzID0gZG9jdW1lbnQgJiYgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50OwogICAgICAgIC8qKiovCiAgICAgIH0sCgogICAgICAvKioqLwogICAgICAiZmIxNSI6CiAgICAgIC8qKiovCiAgICAgIGZ1bmN0aW9uIGZiMTUobW9kdWxlLCBfX3dlYnBhY2tfZXhwb3J0c19fLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CiAgICAgICAgInVzZSBzdHJpY3QiOyAvLyBFU00gQ09NUEFUIEZMQUcKCiAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5yKF9fd2VicGFja19leHBvcnRzX18pOyAvLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL25vZGVfbW9kdWxlcy9AdnVlL2NsaS1zZXJ2aWNlL2xpYi9jb21tYW5kcy9idWlsZC9zZXRQdWJsaWNQYXRoLmpzCiAgICAgICAgLy8gVGhpcyBmaWxlIGlzIGltcG9ydGVkIGludG8gbGliL3djIGNsaWVudCBidW5kbGVzLgoKCiAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7CiAgICAgICAgICBpZiAodHJ1ZSkgewogICAgICAgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKCJmNmZkIik7CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIHNldFB1YmxpY1BhdGhfaTsKCiAgICAgICAgICBpZiAoKHNldFB1YmxpY1BhdGhfaSA9IHdpbmRvdy5kb2N1bWVudC5jdXJyZW50U2NyaXB0KSAmJiAoc2V0UHVibGljUGF0aF9pID0gc2V0UHVibGljUGF0aF9pLnNyYy5tYXRjaCgvKC4rXC8pW14vXStcLmpzKFw/LiopPyQvKSkpIHsKICAgICAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gc2V0UHVibGljUGF0aF9pWzFdOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lCiAgICAgICAgICB9CiAgICAgICAgfSAvLyBJbmRpY2F0ZSB0byB3ZWJwYWNrIHRoYXQgdGhpcyBmaWxlIGNhbiBiZSBjb25jYXRlbmF0ZWQKCiAgICAgICAgLyogaGFybW9ueSBkZWZhdWx0IGV4cG9ydCAqLwoKCiAgICAgICAgdmFyIHNldFB1YmxpY1BhdGggPSBudWxsOyAvLyBFWFRFUk5BTCBNT0RVTEU6IC4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYub2JqZWN0LmFzc2lnbi5qcwoKICAgICAgICB2YXIgZXM2X29iamVjdF9hc3NpZ24gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCJmNzUxIik7IC8vIEVYVEVSTkFMIE1PRFVMRTogLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL2VzNi5zdHJpbmcuc3RhcnRzLXdpdGguanMKCgogICAgICAgIHZhciBlczZfc3RyaW5nX3N0YXJ0c193aXRoID0gX193ZWJwYWNrX3JlcXVpcmVfXygiZjU1OSIpOyAvLyBFWFRFUk5BTCBNT0RVTEU6IC4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy93ZWIuZG9tLml0ZXJhYmxlLmpzCgoKICAgICAgICB2YXIgd2ViX2RvbV9pdGVyYWJsZSA9IF9fd2VicGFja19yZXF1aXJlX18oImFjNmEiKTsgLy8gRVhURVJOQUwgTU9EVUxFOiAuL25vZGVfbW9kdWxlcy9jb3JlLWpzL21vZHVsZXMvZXM2LmFycmF5Lml0ZXJhdG9yLmpzCgoKICAgICAgICB2YXIgZXM2X2FycmF5X2l0ZXJhdG9yID0gX193ZWJwYWNrX3JlcXVpcmVfXygiY2FkZiIpOyAvLyBFWFRFUk5BTCBNT0RVTEU6IC4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczYub2JqZWN0LmtleXMuanMKCgogICAgICAgIHZhciBlczZfb2JqZWN0X2tleXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCI0NTZkIik7IC8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FycmF5V2l0aEhvbGVzLmpzCgoKICAgICAgICBmdW5jdGlvbiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB7CiAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSByZXR1cm4gYXJyOwogICAgICAgIH0gLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vaXRlcmFibGVUb0FycmF5TGltaXQuanMKCgogICAgICAgIGZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHsKICAgICAgICAgIGlmICh0eXBlb2YgU3ltYm9sID09PSAidW5kZWZpbmVkIiB8fCAhKFN5bWJvbC5pdGVyYXRvciBpbiBPYmplY3QoYXJyKSkpIHJldHVybjsKICAgICAgICAgIHZhciBfYXJyID0gW107CiAgICAgICAgICB2YXIgX24gPSB0cnVlOwogICAgICAgICAgdmFyIF9kID0gZmFsc2U7CiAgICAgICAgICB2YXIgX2UgPSB1bmRlZmluZWQ7CgogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgZm9yICh2YXIgX2kgPSBhcnJbU3ltYm9sLml0ZXJhdG9yXSgpLCBfczsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSk7IF9uID0gdHJ1ZSkgewogICAgICAgICAgICAgIF9hcnIucHVzaChfcy52YWx1ZSk7CgogICAgICAgICAgICAgIGlmIChpICYmIF9hcnIubGVuZ3RoID09PSBpKSBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgIF9kID0gdHJ1ZTsKICAgICAgICAgICAgX2UgPSBlcnI7CiAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIGlmICghX24gJiYgX2lbInJldHVybiJdICE9IG51bGwpIF9pWyJyZXR1cm4iXSgpOwogICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgIGlmIChfZCkgdGhyb3cgX2U7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gX2FycjsKICAgICAgICB9IC8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FycmF5TGlrZVRvQXJyYXkuanMKCgogICAgICAgIGZ1bmN0aW9uIF9hcnJheUxpa2VUb0FycmF5KGFyciwgbGVuKSB7CiAgICAgICAgICBpZiAobGVuID09IG51bGwgfHwgbGVuID4gYXJyLmxlbmd0aCkgbGVuID0gYXJyLmxlbmd0aDsKCiAgICAgICAgICBmb3IgKHZhciBpID0gMCwgYXJyMiA9IG5ldyBBcnJheShsZW4pOyBpIDwgbGVuOyBpKyspIHsKICAgICAgICAgICAgYXJyMltpXSA9IGFycltpXTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gYXJyMjsKICAgICAgICB9IC8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5LmpzCgoKICAgICAgICBmdW5jdGlvbiBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkobywgbWluTGVuKSB7CiAgICAgICAgICBpZiAoIW8pIHJldHVybjsKICAgICAgICAgIGlmICh0eXBlb2YgbyA9PT0gInN0cmluZyIpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pOwogICAgICAgICAgdmFyIG4gPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobykuc2xpY2UoOCwgLTEpOwogICAgICAgICAgaWYgKG4gPT09ICJPYmplY3QiICYmIG8uY29uc3RydWN0b3IpIG4gPSBvLmNvbnN0cnVjdG9yLm5hbWU7CiAgICAgICAgICBpZiAobiA9PT0gIk1hcCIgfHwgbiA9PT0gIlNldCIpIHJldHVybiBBcnJheS5mcm9tKG8pOwogICAgICAgICAgaWYgKG4gPT09ICJBcmd1bWVudHMiIHx8IC9eKD86VWl8SSludCg/Ojh8MTZ8MzIpKD86Q2xhbXBlZCk/QXJyYXkkLy50ZXN0KG4pKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTsKICAgICAgICB9IC8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL25vbkl0ZXJhYmxlUmVzdC5qcwoKCiAgICAgICAgZnVuY3Rpb24gX25vbkl0ZXJhYmxlUmVzdCgpIHsKICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2UuXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuIik7CiAgICAgICAgfSAvLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9zbGljZWRUb0FycmF5LmpzCgoKICAgICAgICBmdW5jdGlvbiBfc2xpY2VkVG9BcnJheShhcnIsIGkpIHsKICAgICAgICAgIHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB8fCBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkoYXJyLCBpKSB8fCBfbm9uSXRlcmFibGVSZXN0KCk7CiAgICAgICAgfSAvLyBFWFRFUk5BTCBNT0RVTEU6IC4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbW9kdWxlcy9lczcuYXJyYXkuaW5jbHVkZXMuanMKCgogICAgICAgIHZhciBlczdfYXJyYXlfaW5jbHVkZXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCI2NzYyIik7IC8vIEVYVEVSTkFMIE1PRFVMRTogLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL2VzNi5zdHJpbmcuaW5jbHVkZXMuanMKCgogICAgICAgIHZhciBlczZfc3RyaW5nX2luY2x1ZGVzID0gX193ZWJwYWNrX3JlcXVpcmVfXygiMmZkYiIpOyAvLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hcnJheVdpdGhvdXRIb2xlcy5qcwoKCiAgICAgICAgZnVuY3Rpb24gX2FycmF5V2l0aG91dEhvbGVzKGFycikgewogICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KGFycik7CiAgICAgICAgfSAvLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9pdGVyYWJsZVRvQXJyYXkuanMKCgogICAgICAgIGZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXkoaXRlcikgewogICAgICAgICAgaWYgKHR5cGVvZiBTeW1ib2wgIT09ICJ1bmRlZmluZWQiICYmIFN5bWJvbC5pdGVyYXRvciBpbiBPYmplY3QoaXRlcikpIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpOwogICAgICAgIH0gLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vbm9uSXRlcmFibGVTcHJlYWQuanMKCgogICAgICAgIGZ1bmN0aW9uIF9ub25JdGVyYWJsZVNwcmVhZCgpIHsKICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBzcHJlYWQgbm9uLWl0ZXJhYmxlIGluc3RhbmNlLlxuSW4gb3JkZXIgdG8gYmUgaXRlcmFibGUsIG5vbi1hcnJheSBvYmplY3RzIG11c3QgaGF2ZSBhIFtTeW1ib2wuaXRlcmF0b3JdKCkgbWV0aG9kLiIpOwogICAgICAgIH0gLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdG9Db25zdW1hYmxlQXJyYXkuanMKCgogICAgICAgIGZ1bmN0aW9uIF90b0NvbnN1bWFibGVBcnJheShhcnIpIHsKICAgICAgICAgIHJldHVybiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5KGFycikgfHwgX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KGFycikgfHwgX25vbkl0ZXJhYmxlU3ByZWFkKCk7CiAgICAgICAgfSAvLyBFWFRFUk5BTCBNT0RVTEU6IGV4dGVybmFsIHsiY29tbW9uanMiOiJzb3J0YWJsZWpzIiwiY29tbW9uanMyIjoic29ydGFibGVqcyIsImFtZCI6InNvcnRhYmxlanMiLCJyb290IjoiU29ydGFibGUifQoKCiAgICAgICAgdmFyIGV4dGVybmFsX2NvbW1vbmpzX3NvcnRhYmxlanNfY29tbW9uanMyX3NvcnRhYmxlanNfYW1kX3NvcnRhYmxlanNfcm9vdF9Tb3J0YWJsZV8gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCJhMzUyIik7CgogICAgICAgIHZhciBleHRlcm5hbF9jb21tb25qc19zb3J0YWJsZWpzX2NvbW1vbmpzMl9zb3J0YWJsZWpzX2FtZF9zb3J0YWJsZWpzX3Jvb3RfU29ydGFibGVfZGVmYXVsdCA9IC8qI19fUFVSRV9fKi9fX3dlYnBhY2tfcmVxdWlyZV9fLm4oZXh0ZXJuYWxfY29tbW9uanNfc29ydGFibGVqc19jb21tb25qczJfc29ydGFibGVqc19hbWRfc29ydGFibGVqc19yb290X1NvcnRhYmxlXyk7IC8vIEVYVEVSTkFMIE1PRFVMRTogLi9zcmMvdXRpbC9oZWxwZXIuanMKCgogICAgICAgIHZhciBoZWxwZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCJjNjQ5Iik7IC8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vc3JjL3Z1ZWRyYWdnYWJsZS5qcwoKCiAgICAgICAgZnVuY3Rpb24gYnVpbGRBdHRyaWJ1dGUob2JqZWN0LCBwcm9wTmFtZSwgdmFsdWUpIHsKICAgICAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgIHJldHVybiBvYmplY3Q7CiAgICAgICAgICB9CgogICAgICAgICAgb2JqZWN0ID0gb2JqZWN0IHx8IHt9OwogICAgICAgICAgb2JqZWN0W3Byb3BOYW1lXSA9IHZhbHVlOwogICAgICAgICAgcmV0dXJuIG9iamVjdDsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGNvbXB1dGVWbUluZGV4KHZub2RlcywgZWxlbWVudCkgewogICAgICAgICAgcmV0dXJuIHZub2Rlcy5tYXAoZnVuY3Rpb24gKGVsdCkgewogICAgICAgICAgICByZXR1cm4gZWx0LmVsbTsKICAgICAgICAgIH0pLmluZGV4T2YoZWxlbWVudCk7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBfY29tcHV0ZUluZGV4ZXMoc2xvdHMsIGNoaWxkcmVuLCBpc1RyYW5zaXRpb24sIGZvb3Rlck9mZnNldCkgewogICAgICAgICAgaWYgKCFzbG90cykgewogICAgICAgICAgICByZXR1cm4gW107CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIGVsbUZyb21Ob2RlcyA9IHNsb3RzLm1hcChmdW5jdGlvbiAoZWx0KSB7CiAgICAgICAgICAgIHJldHVybiBlbHQuZWxtOwogICAgICAgICAgfSk7CiAgICAgICAgICB2YXIgZm9vdGVySW5kZXggPSBjaGlsZHJlbi5sZW5ndGggLSBmb290ZXJPZmZzZXQ7CgogICAgICAgICAgdmFyIHJhd0luZGV4ZXMgPSBfdG9Db25zdW1hYmxlQXJyYXkoY2hpbGRyZW4pLm1hcChmdW5jdGlvbiAoZWx0LCBpZHgpIHsKICAgICAgICAgICAgcmV0dXJuIGlkeCA+PSBmb290ZXJJbmRleCA/IGVsbUZyb21Ob2Rlcy5sZW5ndGggOiBlbG1Gcm9tTm9kZXMuaW5kZXhPZihlbHQpOwogICAgICAgICAgfSk7CgogICAgICAgICAgcmV0dXJuIGlzVHJhbnNpdGlvbiA/IHJhd0luZGV4ZXMuZmlsdGVyKGZ1bmN0aW9uIChpbmQpIHsKICAgICAgICAgICAgcmV0dXJuIGluZCAhPT0gLTE7CiAgICAgICAgICB9KSA6IHJhd0luZGV4ZXM7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBlbWl0KGV2dE5hbWUsIGV2dERhdGEpIHsKICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAgICAgdGhpcy4kbmV4dFRpY2soZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gX3RoaXMuJGVtaXQoZXZ0TmFtZS50b0xvd2VyQ2FzZSgpLCBldnREYXRhKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gZGVsZWdhdGVBbmRFbWl0KGV2dE5hbWUpIHsKICAgICAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoZXZ0RGF0YSkgewogICAgICAgICAgICBpZiAoX3RoaXMyLnJlYWxMaXN0ICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgX3RoaXMyWyJvbkRyYWciICsgZXZ0TmFtZV0oZXZ0RGF0YSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGVtaXQuY2FsbChfdGhpczIsIGV2dE5hbWUsIGV2dERhdGEpOwogICAgICAgICAgfTsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGlzVHJhbnNpdGlvbk5hbWUobmFtZSkgewogICAgICAgICAgcmV0dXJuIFsidHJhbnNpdGlvbi1ncm91cCIsICJUcmFuc2l0aW9uR3JvdXAiXS5pbmNsdWRlcyhuYW1lKTsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIHZ1ZWRyYWdnYWJsZV9pc1RyYW5zaXRpb24oc2xvdHMpIHsKICAgICAgICAgIGlmICghc2xvdHMgfHwgc2xvdHMubGVuZ3RoICE9PSAxKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgX3Nsb3RzID0gX3NsaWNlZFRvQXJyYXkoc2xvdHMsIDEpLAogICAgICAgICAgICAgIGNvbXBvbmVudE9wdGlvbnMgPSBfc2xvdHNbMF0uY29tcG9uZW50T3B0aW9uczsKCiAgICAgICAgICBpZiAoIWNvbXBvbmVudE9wdGlvbnMpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBpc1RyYW5zaXRpb25OYW1lKGNvbXBvbmVudE9wdGlvbnMudGFnKTsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGdldFNsb3Qoc2xvdCwgc2NvcGVkU2xvdCwga2V5KSB7CiAgICAgICAgICByZXR1cm4gc2xvdFtrZXldIHx8IChzY29wZWRTbG90W2tleV0gPyBzY29wZWRTbG90W2tleV0oKSA6IHVuZGVmaW5lZCk7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBjb21wdXRlQ2hpbGRyZW5BbmRPZmZzZXRzKGNoaWxkcmVuLCBzbG90LCBzY29wZWRTbG90KSB7CiAgICAgICAgICB2YXIgaGVhZGVyT2Zmc2V0ID0gMDsKICAgICAgICAgIHZhciBmb290ZXJPZmZzZXQgPSAwOwogICAgICAgICAgdmFyIGhlYWRlciA9IGdldFNsb3Qoc2xvdCwgc2NvcGVkU2xvdCwgImhlYWRlciIpOwoKICAgICAgICAgIGlmIChoZWFkZXIpIHsKICAgICAgICAgICAgaGVhZGVyT2Zmc2V0ID0gaGVhZGVyLmxlbmd0aDsKICAgICAgICAgICAgY2hpbGRyZW4gPSBjaGlsZHJlbiA/IFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkoaGVhZGVyKSwgX3RvQ29uc3VtYWJsZUFycmF5KGNoaWxkcmVuKSkgOiBfdG9Db25zdW1hYmxlQXJyYXkoaGVhZGVyKTsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgZm9vdGVyID0gZ2V0U2xvdChzbG90LCBzY29wZWRTbG90LCAiZm9vdGVyIik7CgogICAgICAgICAgaWYgKGZvb3RlcikgewogICAgICAgICAgICBmb290ZXJPZmZzZXQgPSBmb290ZXIubGVuZ3RoOwogICAgICAgICAgICBjaGlsZHJlbiA9IGNoaWxkcmVuID8gW10uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShjaGlsZHJlbiksIF90b0NvbnN1bWFibGVBcnJheShmb290ZXIpKSA6IF90b0NvbnN1bWFibGVBcnJheShmb290ZXIpOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGNoaWxkcmVuOiBjaGlsZHJlbiwKICAgICAgICAgICAgaGVhZGVyT2Zmc2V0OiBoZWFkZXJPZmZzZXQsCiAgICAgICAgICAgIGZvb3Rlck9mZnNldDogZm9vdGVyT2Zmc2V0CiAgICAgICAgICB9OwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gZ2V0Q29tcG9uZW50QXR0cmlidXRlcygkYXR0cnMsIGNvbXBvbmVudERhdGEpIHsKICAgICAgICAgIHZhciBhdHRyaWJ1dGVzID0gbnVsbDsKCiAgICAgICAgICB2YXIgdXBkYXRlID0gZnVuY3Rpb24gdXBkYXRlKG5hbWUsIHZhbHVlKSB7CiAgICAgICAgICAgIGF0dHJpYnV0ZXMgPSBidWlsZEF0dHJpYnV0ZShhdHRyaWJ1dGVzLCBuYW1lLCB2YWx1ZSk7CiAgICAgICAgICB9OwoKICAgICAgICAgIHZhciBhdHRycyA9IE9iamVjdC5rZXlzKCRhdHRycykuZmlsdGVyKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICAgICAgcmV0dXJuIGtleSA9PT0gImlkIiB8fCBrZXkuc3RhcnRzV2l0aCgiZGF0YS0iKTsKICAgICAgICAgIH0pLnJlZHVjZShmdW5jdGlvbiAocmVzLCBrZXkpIHsKICAgICAgICAgICAgcmVzW2tleV0gPSAkYXR0cnNba2V5XTsKICAgICAgICAgICAgcmV0dXJuIHJlczsKICAgICAgICAgIH0sIHt9KTsKICAgICAgICAgIHVwZGF0ZSgiYXR0cnMiLCBhdHRycyk7CgogICAgICAgICAgaWYgKCFjb21wb25lbnREYXRhKSB7CiAgICAgICAgICAgIHJldHVybiBhdHRyaWJ1dGVzOwogICAgICAgICAgfQoKICAgICAgICAgIHZhciBvbiA9IGNvbXBvbmVudERhdGEub24sCiAgICAgICAgICAgICAgcHJvcHMgPSBjb21wb25lbnREYXRhLnByb3BzLAogICAgICAgICAgICAgIGNvbXBvbmVudERhdGFBdHRycyA9IGNvbXBvbmVudERhdGEuYXR0cnM7CiAgICAgICAgICB1cGRhdGUoIm9uIiwgb24pOwogICAgICAgICAgdXBkYXRlKCJwcm9wcyIsIHByb3BzKTsKICAgICAgICAgIE9iamVjdC5hc3NpZ24oYXR0cmlidXRlcy5hdHRycywgY29tcG9uZW50RGF0YUF0dHJzKTsKICAgICAgICAgIHJldHVybiBhdHRyaWJ1dGVzOwogICAgICAgIH0KCiAgICAgICAgdmFyIGV2ZW50c0xpc3RlbmVkID0gWyJTdGFydCIsICJBZGQiLCAiUmVtb3ZlIiwgIlVwZGF0ZSIsICJFbmQiXTsKICAgICAgICB2YXIgZXZlbnRzVG9FbWl0ID0gWyJDaG9vc2UiLCAiVW5jaG9vc2UiLCAiU29ydCIsICJGaWx0ZXIiLCAiQ2xvbmUiXTsKICAgICAgICB2YXIgcmVhZG9ubHlQcm9wZXJ0aWVzID0gWyJNb3ZlIl0uY29uY2F0KGV2ZW50c0xpc3RlbmVkLCBldmVudHNUb0VtaXQpLm1hcChmdW5jdGlvbiAoZXZ0KSB7CiAgICAgICAgICByZXR1cm4gIm9uIiArIGV2dDsKICAgICAgICB9KTsKICAgICAgICB2YXIgZHJhZ2dpbmdFbGVtZW50ID0gbnVsbDsKICAgICAgICB2YXIgcHJvcHMgPSB7CiAgICAgICAgICBvcHRpb25zOiBPYmplY3QsCiAgICAgICAgICBsaXN0OiB7CiAgICAgICAgICAgIHR5cGU6IEFycmF5LAogICAgICAgICAgICByZXF1aXJlZDogZmFsc2UsCiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwKICAgICAgICAgIH0sCiAgICAgICAgICB2YWx1ZTogewogICAgICAgICAgICB0eXBlOiBBcnJheSwKICAgICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLAogICAgICAgICAgICBkZWZhdWx0OiBudWxsCiAgICAgICAgICB9LAogICAgICAgICAgbm9UcmFuc2l0aW9uT25EcmFnOiB7CiAgICAgICAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgICAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICAgICAgICB9LAogICAgICAgICAgY2xvbmU6IHsKICAgICAgICAgICAgdHlwZTogRnVuY3Rpb24sCiAgICAgICAgICAgIGRlZmF1bHQ6IGZ1bmN0aW9uIF9kZWZhdWx0KG9yaWdpbmFsKSB7CiAgICAgICAgICAgICAgcmV0dXJuIG9yaWdpbmFsOwogICAgICAgICAgICB9CiAgICAgICAgICB9LAogICAgICAgICAgZWxlbWVudDogewogICAgICAgICAgICB0eXBlOiBTdHJpbmcsCiAgICAgICAgICAgIGRlZmF1bHQ6ICJkaXYiCiAgICAgICAgICB9LAogICAgICAgICAgdGFnOiB7CiAgICAgICAgICAgIHR5cGU6IFN0cmluZywKICAgICAgICAgICAgZGVmYXVsdDogbnVsbAogICAgICAgICAgfSwKICAgICAgICAgIG1vdmU6IHsKICAgICAgICAgICAgdHlwZTogRnVuY3Rpb24sCiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwKICAgICAgICAgIH0sCiAgICAgICAgICBjb21wb25lbnREYXRhOiB7CiAgICAgICAgICAgIHR5cGU6IE9iamVjdCwKICAgICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLAogICAgICAgICAgICBkZWZhdWx0OiBudWxsCiAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICB2YXIgZHJhZ2dhYmxlQ29tcG9uZW50ID0gewogICAgICAgICAgbmFtZTogImRyYWdnYWJsZSIsCiAgICAgICAgICBpbmhlcml0QXR0cnM6IGZhbHNlLAogICAgICAgICAgcHJvcHM6IHByb3BzLAogICAgICAgICAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICB0cmFuc2l0aW9uTW9kZTogZmFsc2UsCiAgICAgICAgICAgICAgbm9uZUZ1bmN0aW9uYWxDb21wb25lbnRNb2RlOiBmYWxzZQogICAgICAgICAgICB9OwogICAgICAgICAgfSwKICAgICAgICAgIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKGgpIHsKICAgICAgICAgICAgdmFyIHNsb3RzID0gdGhpcy4kc2xvdHMuZGVmYXVsdDsKICAgICAgICAgICAgdGhpcy50cmFuc2l0aW9uTW9kZSA9IHZ1ZWRyYWdnYWJsZV9pc1RyYW5zaXRpb24oc2xvdHMpOwoKICAgICAgICAgICAgdmFyIF9jb21wdXRlQ2hpbGRyZW5BbmRPZiA9IGNvbXB1dGVDaGlsZHJlbkFuZE9mZnNldHMoc2xvdHMsIHRoaXMuJHNsb3RzLCB0aGlzLiRzY29wZWRTbG90cyksCiAgICAgICAgICAgICAgICBjaGlsZHJlbiA9IF9jb21wdXRlQ2hpbGRyZW5BbmRPZi5jaGlsZHJlbiwKICAgICAgICAgICAgICAgIGhlYWRlck9mZnNldCA9IF9jb21wdXRlQ2hpbGRyZW5BbmRPZi5oZWFkZXJPZmZzZXQsCiAgICAgICAgICAgICAgICBmb290ZXJPZmZzZXQgPSBfY29tcHV0ZUNoaWxkcmVuQW5kT2YuZm9vdGVyT2Zmc2V0OwoKICAgICAgICAgICAgdGhpcy5oZWFkZXJPZmZzZXQgPSBoZWFkZXJPZmZzZXQ7CiAgICAgICAgICAgIHRoaXMuZm9vdGVyT2Zmc2V0ID0gZm9vdGVyT2Zmc2V0OwogICAgICAgICAgICB2YXIgYXR0cmlidXRlcyA9IGdldENvbXBvbmVudEF0dHJpYnV0ZXModGhpcy4kYXR0cnMsIHRoaXMuY29tcG9uZW50RGF0YSk7CiAgICAgICAgICAgIHJldHVybiBoKHRoaXMuZ2V0VGFnKCksIGF0dHJpYnV0ZXMsIGNoaWxkcmVuKTsKICAgICAgICAgIH0sCiAgICAgICAgICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgICAgICAgICBpZiAodGhpcy5saXN0ICE9PSBudWxsICYmIHRoaXMudmFsdWUgIT09IG51bGwpIHsKICAgICAgICAgICAgICBoZWxwZXJbImIiCiAgICAgICAgICAgICAgLyogY29uc29sZSAqLwogICAgICAgICAgICAgIF0uZXJyb3IoIlZhbHVlIGFuZCBsaXN0IHByb3BzIGFyZSBtdXR1YWxseSBleGNsdXNpdmUhIFBsZWFzZSBzZXQgb25lIG9yIGFub3RoZXIuIik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICh0aGlzLmVsZW1lbnQgIT09ICJkaXYiKSB7CiAgICAgICAgICAgICAgaGVscGVyWyJiIgogICAgICAgICAgICAgIC8qIGNvbnNvbGUgKi8KICAgICAgICAgICAgICBdLndhcm4oIkVsZW1lbnQgcHJvcHMgaXMgZGVwcmVjYXRlZCBwbGVhc2UgdXNlIHRhZyBwcm9wcyBpbnN0ZWFkLiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL1NvcnRhYmxlSlMvVnVlLkRyYWdnYWJsZS9ibG9iL21hc3Rlci9kb2N1bWVudGF0aW9uL21pZ3JhdGUubWQjZWxlbWVudC1wcm9wcyIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICBoZWxwZXJbImIiCiAgICAgICAgICAgICAgLyogY29uc29sZSAqLwogICAgICAgICAgICAgIF0ud2FybigiT3B0aW9ucyBwcm9wcyBpcyBkZXByZWNhdGVkLCBhZGQgc29ydGFibGUgb3B0aW9ucyBkaXJlY3RseSBhcyB2dWUuZHJhZ2dhYmxlIGl0ZW0sIG9yIHVzZSB2LWJpbmQuIFNlZSBodHRwczovL2dpdGh1Yi5jb20vU29ydGFibGVKUy9WdWUuRHJhZ2dhYmxlL2Jsb2IvbWFzdGVyL2RvY3VtZW50YXRpb24vbWlncmF0ZS5tZCNvcHRpb25zLXByb3BzIik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sCiAgICAgICAgICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkgewogICAgICAgICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgICAgICAgIHRoaXMubm9uZUZ1bmN0aW9uYWxDb21wb25lbnRNb2RlID0gdGhpcy5nZXRUYWcoKS50b0xvd2VyQ2FzZSgpICE9PSB0aGlzLiRlbC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpICYmICF0aGlzLmdldElzRnVuY3Rpb25hbCgpOwoKICAgICAgICAgICAgaWYgKHRoaXMubm9uZUZ1bmN0aW9uYWxDb21wb25lbnRNb2RlICYmIHRoaXMudHJhbnNpdGlvbk1vZGUpIHsKICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIlRyYW5zaXRpb24tZ3JvdXAgaW5zaWRlIGNvbXBvbmVudCBpcyBub3Qgc3VwcG9ydGVkLiBQbGVhc2UgYWx0ZXIgdGFnIHZhbHVlIG9yIHJlbW92ZSB0cmFuc2l0aW9uLWdyb3VwLiBDdXJyZW50IHRhZyB2YWx1ZTogIi5jb25jYXQodGhpcy5nZXRUYWcoKSkpOwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgb3B0aW9uc0FkZGVkID0ge307CiAgICAgICAgICAgIGV2ZW50c0xpc3RlbmVkLmZvckVhY2goZnVuY3Rpb24gKGVsdCkgewogICAgICAgICAgICAgIG9wdGlvbnNBZGRlZFsib24iICsgZWx0XSA9IGRlbGVnYXRlQW5kRW1pdC5jYWxsKF90aGlzMywgZWx0KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGV2ZW50c1RvRW1pdC5mb3JFYWNoKGZ1bmN0aW9uIChlbHQpIHsKICAgICAgICAgICAgICBvcHRpb25zQWRkZWRbIm9uIiArIGVsdF0gPSBlbWl0LmJpbmQoX3RoaXMzLCBlbHQpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZXMgPSBPYmplY3Qua2V5cyh0aGlzLiRhdHRycykucmVkdWNlKGZ1bmN0aW9uIChyZXMsIGtleSkgewogICAgICAgICAgICAgIHJlc1tPYmplY3QoaGVscGVyWyJhIgogICAgICAgICAgICAgIC8qIGNhbWVsaXplICovCiAgICAgICAgICAgICAgXSkoa2V5KV0gPSBfdGhpczMuJGF0dHJzW2tleV07CiAgICAgICAgICAgICAgcmV0dXJuIHJlczsKICAgICAgICAgICAgfSwge30pOwogICAgICAgICAgICB2YXIgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe30sIHRoaXMub3B0aW9ucywgYXR0cmlidXRlcywgb3B0aW9uc0FkZGVkLCB7CiAgICAgICAgICAgICAgb25Nb3ZlOiBmdW5jdGlvbiBvbk1vdmUoZXZ0LCBvcmlnaW5hbEV2ZW50KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMzLm9uRHJhZ01vdmUoZXZ0LCBvcmlnaW5hbEV2ZW50KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICAhKCJkcmFnZ2FibGUiIGluIG9wdGlvbnMpICYmIChvcHRpb25zLmRyYWdnYWJsZSA9ICI+KiIpOwogICAgICAgICAgICB0aGlzLl9zb3J0YWJsZSA9IG5ldyBleHRlcm5hbF9jb21tb25qc19zb3J0YWJsZWpzX2NvbW1vbmpzMl9zb3J0YWJsZWpzX2FtZF9zb3J0YWJsZWpzX3Jvb3RfU29ydGFibGVfZGVmYXVsdC5hKHRoaXMucm9vdENvbnRhaW5lciwgb3B0aW9ucyk7CiAgICAgICAgICAgIHRoaXMuY29tcHV0ZUluZGV4ZXMoKTsKICAgICAgICAgIH0sCiAgICAgICAgICBiZWZvcmVEZXN0cm95OiBmdW5jdGlvbiBiZWZvcmVEZXN0cm95KCkgewogICAgICAgICAgICBpZiAodGhpcy5fc29ydGFibGUgIT09IHVuZGVmaW5lZCkgdGhpcy5fc29ydGFibGUuZGVzdHJveSgpOwogICAgICAgICAgfSwKICAgICAgICAgIGNvbXB1dGVkOiB7CiAgICAgICAgICAgIHJvb3RDb250YWluZXI6IGZ1bmN0aW9uIHJvb3RDb250YWluZXIoKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudHJhbnNpdGlvbk1vZGUgPyB0aGlzLiRlbC5jaGlsZHJlblswXSA6IHRoaXMuJGVsOwogICAgICAgICAgICB9LAogICAgICAgICAgICByZWFsTGlzdDogZnVuY3Rpb24gcmVhbExpc3QoKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubGlzdCA/IHRoaXMubGlzdCA6IHRoaXMudmFsdWU7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sCiAgICAgICAgICB3YXRjaDogewogICAgICAgICAgICBvcHRpb25zOiB7CiAgICAgICAgICAgICAgaGFuZGxlcjogZnVuY3Rpb24gaGFuZGxlcihuZXdPcHRpb25WYWx1ZSkgewogICAgICAgICAgICAgICAgdGhpcy51cGRhdGVPcHRpb25zKG5ld09wdGlvblZhbHVlKTsKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIGRlZXA6IHRydWUKICAgICAgICAgICAgfSwKICAgICAgICAgICAgJGF0dHJzOiB7CiAgICAgICAgICAgICAgaGFuZGxlcjogZnVuY3Rpb24gaGFuZGxlcihuZXdPcHRpb25WYWx1ZSkgewogICAgICAgICAgICAgICAgdGhpcy51cGRhdGVPcHRpb25zKG5ld09wdGlvblZhbHVlKTsKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIGRlZXA6IHRydWUKICAgICAgICAgICAgfSwKICAgICAgICAgICAgcmVhbExpc3Q6IGZ1bmN0aW9uIHJlYWxMaXN0KCkgewogICAgICAgICAgICAgIHRoaXMuY29tcHV0ZUluZGV4ZXMoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSwKICAgICAgICAgIG1ldGhvZHM6IHsKICAgICAgICAgICAgZ2V0SXNGdW5jdGlvbmFsOiBmdW5jdGlvbiBnZXRJc0Z1bmN0aW9uYWwoKSB7CiAgICAgICAgICAgICAgdmFyIGZuT3B0aW9ucyA9IHRoaXMuX3Zub2RlLmZuT3B0aW9uczsKICAgICAgICAgICAgICByZXR1cm4gZm5PcHRpb25zICYmIGZuT3B0aW9ucy5mdW5jdGlvbmFsOwogICAgICAgICAgICB9LAogICAgICAgICAgICBnZXRUYWc6IGZ1bmN0aW9uIGdldFRhZygpIHsKICAgICAgICAgICAgICByZXR1cm4gdGhpcy50YWcgfHwgdGhpcy5lbGVtZW50OwogICAgICAgICAgICB9LAogICAgICAgICAgICB1cGRhdGVPcHRpb25zOiBmdW5jdGlvbiB1cGRhdGVPcHRpb25zKG5ld09wdGlvblZhbHVlKSB7CiAgICAgICAgICAgICAgZm9yICh2YXIgcHJvcGVydHkgaW4gbmV3T3B0aW9uVmFsdWUpIHsKICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IE9iamVjdChoZWxwZXJbImEiCiAgICAgICAgICAgICAgICAvKiBjYW1lbGl6ZSAqLwogICAgICAgICAgICAgICAgXSkocHJvcGVydHkpOwoKICAgICAgICAgICAgICAgIGlmIChyZWFkb25seVByb3BlcnRpZXMuaW5kZXhPZih2YWx1ZSkgPT09IC0xKSB7CiAgICAgICAgICAgICAgICAgIHRoaXMuX3NvcnRhYmxlLm9wdGlvbih2YWx1ZSwgbmV3T3B0aW9uVmFsdWVbcHJvcGVydHldKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGdldENoaWxkcmVuTm9kZXM6IGZ1bmN0aW9uIGdldENoaWxkcmVuTm9kZXMoKSB7CiAgICAgICAgICAgICAgaWYgKHRoaXMubm9uZUZ1bmN0aW9uYWxDb21wb25lbnRNb2RlKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy4kY2hpbGRyZW5bMF0uJHNsb3RzLmRlZmF1bHQ7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB2YXIgcmF3Tm9kZXMgPSB0aGlzLiRzbG90cy5kZWZhdWx0OwogICAgICAgICAgICAgIHJldHVybiB0aGlzLnRyYW5zaXRpb25Nb2RlID8gcmF3Tm9kZXNbMF0uY2hpbGQuJHNsb3RzLmRlZmF1bHQgOiByYXdOb2RlczsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgY29tcHV0ZUluZGV4ZXM6IGZ1bmN0aW9uIGNvbXB1dGVJbmRleGVzKCkgewogICAgICAgICAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgICAgICAgICB0aGlzLiRuZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICBfdGhpczQudmlzaWJsZUluZGV4ZXMgPSBfY29tcHV0ZUluZGV4ZXMoX3RoaXM0LmdldENoaWxkcmVuTm9kZXMoKSwgX3RoaXM0LnJvb3RDb250YWluZXIuY2hpbGRyZW4sIF90aGlzNC50cmFuc2l0aW9uTW9kZSwgX3RoaXM0LmZvb3Rlck9mZnNldCk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGdldFVuZGVybHlpbmdWbTogZnVuY3Rpb24gZ2V0VW5kZXJseWluZ1ZtKGh0bWxFbHQpIHsKICAgICAgICAgICAgICB2YXIgaW5kZXggPSBjb21wdXRlVm1JbmRleCh0aGlzLmdldENoaWxkcmVuTm9kZXMoKSB8fCBbXSwgaHRtbEVsdCk7CgogICAgICAgICAgICAgIGlmIChpbmRleCA9PT0gLTEpIHsKICAgICAgICAgICAgICAgIC8vRWRnZSBjYXNlIGR1cmluZyBtb3ZlIGNhbGxiYWNrOiByZWxhdGVkIGVsZW1lbnQgbWlnaHQgYmUKICAgICAgICAgICAgICAgIC8vYW4gZWxlbWVudCBkaWZmZXJlbnQgZnJvbSBjb2xsZWN0aW9uCiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gdGhpcy5yZWFsTGlzdFtpbmRleF07CiAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgIGluZGV4OiBpbmRleCwKICAgICAgICAgICAgICAgIGVsZW1lbnQ6IGVsZW1lbnQKICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9LAogICAgICAgICAgICBnZXRVbmRlcmx5aW5nUG90ZW5jaWFsRHJhZ2dhYmxlQ29tcG9uZW50OiBmdW5jdGlvbiBnZXRVbmRlcmx5aW5nUG90ZW5jaWFsRHJhZ2dhYmxlQ29tcG9uZW50KF9yZWYpIHsKICAgICAgICAgICAgICB2YXIgdnVlID0gX3JlZi5fX3Z1ZV9fOwoKICAgICAgICAgICAgICBpZiAoIXZ1ZSB8fCAhdnVlLiRvcHRpb25zIHx8ICFpc1RyYW5zaXRpb25OYW1lKHZ1ZS4kb3B0aW9ucy5fY29tcG9uZW50VGFnKSkgewogICAgICAgICAgICAgICAgaWYgKCEoInJlYWxMaXN0IiBpbiB2dWUpICYmIHZ1ZS4kY2hpbGRyZW4ubGVuZ3RoID09PSAxICYmICJyZWFsTGlzdCIgaW4gdnVlLiRjaGlsZHJlblswXSkgcmV0dXJuIHZ1ZS4kY2hpbGRyZW5bMF07CiAgICAgICAgICAgICAgICByZXR1cm4gdnVlOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgcmV0dXJuIHZ1ZS4kcGFyZW50OwogICAgICAgICAgICB9LAogICAgICAgICAgICBlbWl0Q2hhbmdlczogZnVuY3Rpb24gZW1pdENoYW5nZXMoZXZ0KSB7CiAgICAgICAgICAgICAgdmFyIF90aGlzNSA9IHRoaXM7CgogICAgICAgICAgICAgIHRoaXMuJG5leHRUaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIF90aGlzNS4kZW1pdCgiY2hhbmdlIiwgZXZ0KTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgYWx0ZXJMaXN0OiBmdW5jdGlvbiBhbHRlckxpc3Qob25MaXN0KSB7CiAgICAgICAgICAgICAgaWYgKHRoaXMubGlzdCkgewogICAgICAgICAgICAgICAgb25MaXN0KHRoaXMubGlzdCk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB2YXIgbmV3TGlzdCA9IF90b0NvbnN1bWFibGVBcnJheSh0aGlzLnZhbHVlKTsKCiAgICAgICAgICAgICAgb25MaXN0KG5ld0xpc3QpOwogICAgICAgICAgICAgIHRoaXMuJGVtaXQoImlucHV0IiwgbmV3TGlzdCk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHNwbGljZUxpc3Q6IGZ1bmN0aW9uIHNwbGljZUxpc3QoKSB7CiAgICAgICAgICAgICAgdmFyIF9hcmd1bWVudHMgPSBhcmd1bWVudHM7CgogICAgICAgICAgICAgIHZhciBzcGxpY2VMaXN0ID0gZnVuY3Rpb24gc3BsaWNlTGlzdChsaXN0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbGlzdC5zcGxpY2UuYXBwbHkobGlzdCwgX3RvQ29uc3VtYWJsZUFycmF5KF9hcmd1bWVudHMpKTsKICAgICAgICAgICAgICB9OwoKICAgICAgICAgICAgICB0aGlzLmFsdGVyTGlzdChzcGxpY2VMaXN0KTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgdXBkYXRlUG9zaXRpb246IGZ1bmN0aW9uIHVwZGF0ZVBvc2l0aW9uKG9sZEluZGV4LCBuZXdJbmRleCkgewogICAgICAgICAgICAgIHZhciB1cGRhdGVQb3NpdGlvbiA9IGZ1bmN0aW9uIHVwZGF0ZVBvc2l0aW9uKGxpc3QpIHsKICAgICAgICAgICAgICAgIHJldHVybiBsaXN0LnNwbGljZShuZXdJbmRleCwgMCwgbGlzdC5zcGxpY2Uob2xkSW5kZXgsIDEpWzBdKTsKICAgICAgICAgICAgICB9OwoKICAgICAgICAgICAgICB0aGlzLmFsdGVyTGlzdCh1cGRhdGVQb3NpdGlvbik7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGdldFJlbGF0ZWRDb250ZXh0RnJvbU1vdmVFdmVudDogZnVuY3Rpb24gZ2V0UmVsYXRlZENvbnRleHRGcm9tTW92ZUV2ZW50KF9yZWYyKSB7CiAgICAgICAgICAgICAgdmFyIHRvID0gX3JlZjIudG8sCiAgICAgICAgICAgICAgICAgIHJlbGF0ZWQgPSBfcmVmMi5yZWxhdGVkOwogICAgICAgICAgICAgIHZhciBjb21wb25lbnQgPSB0aGlzLmdldFVuZGVybHlpbmdQb3RlbmNpYWxEcmFnZ2FibGVDb21wb25lbnQodG8pOwoKICAgICAgICAgICAgICBpZiAoIWNvbXBvbmVudCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgY29tcG9uZW50OiBjb21wb25lbnQKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB2YXIgbGlzdCA9IGNvbXBvbmVudC5yZWFsTGlzdDsKICAgICAgICAgICAgICB2YXIgY29udGV4dCA9IHsKICAgICAgICAgICAgICAgIGxpc3Q6IGxpc3QsCiAgICAgICAgICAgICAgICBjb21wb25lbnQ6IGNvbXBvbmVudAogICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgIGlmICh0byAhPT0gcmVsYXRlZCAmJiBsaXN0ICYmIGNvbXBvbmVudC5nZXRVbmRlcmx5aW5nVm0pIHsKICAgICAgICAgICAgICAgIHZhciBkZXN0aW5hdGlvbiA9IGNvbXBvbmVudC5nZXRVbmRlcmx5aW5nVm0ocmVsYXRlZCk7CgogICAgICAgICAgICAgICAgaWYgKGRlc3RpbmF0aW9uKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKGRlc3RpbmF0aW9uLCBjb250ZXh0KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHJldHVybiBjb250ZXh0OwogICAgICAgICAgICB9LAogICAgICAgICAgICBnZXRWbUluZGV4OiBmdW5jdGlvbiBnZXRWbUluZGV4KGRvbUluZGV4KSB7CiAgICAgICAgICAgICAgdmFyIGluZGV4ZXMgPSB0aGlzLnZpc2libGVJbmRleGVzOwogICAgICAgICAgICAgIHZhciBudW1iZXJJbmRleGVzID0gaW5kZXhlcy5sZW5ndGg7CiAgICAgICAgICAgICAgcmV0dXJuIGRvbUluZGV4ID4gbnVtYmVySW5kZXhlcyAtIDEgPyBudW1iZXJJbmRleGVzIDogaW5kZXhlc1tkb21JbmRleF07CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGdldENvbXBvbmVudDogZnVuY3Rpb24gZ2V0Q29tcG9uZW50KCkgewogICAgICAgICAgICAgIHJldHVybiB0aGlzLiRzbG90cy5kZWZhdWx0WzBdLmNvbXBvbmVudEluc3RhbmNlOwogICAgICAgICAgICB9LAogICAgICAgICAgICByZXNldFRyYW5zaXRpb25EYXRhOiBmdW5jdGlvbiByZXNldFRyYW5zaXRpb25EYXRhKGluZGV4KSB7CiAgICAgICAgICAgICAgaWYgKCF0aGlzLm5vVHJhbnNpdGlvbk9uRHJhZyB8fCAhdGhpcy50cmFuc2l0aW9uTW9kZSkgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdmFyIG5vZGVzID0gdGhpcy5nZXRDaGlsZHJlbk5vZGVzKCk7CiAgICAgICAgICAgICAgbm9kZXNbaW5kZXhdLmRhdGEgPSBudWxsOwogICAgICAgICAgICAgIHZhciB0cmFuc2l0aW9uQ29udGFpbmVyID0gdGhpcy5nZXRDb21wb25lbnQoKTsKICAgICAgICAgICAgICB0cmFuc2l0aW9uQ29udGFpbmVyLmNoaWxkcmVuID0gW107CiAgICAgICAgICAgICAgdHJhbnNpdGlvbkNvbnRhaW5lci5rZXB0ID0gdW5kZWZpbmVkOwogICAgICAgICAgICB9LAogICAgICAgICAgICBvbkRyYWdTdGFydDogZnVuY3Rpb24gb25EcmFnU3RhcnQoZXZ0KSB7CiAgICAgICAgICAgICAgdGhpcy5jb250ZXh0ID0gdGhpcy5nZXRVbmRlcmx5aW5nVm0oZXZ0Lml0ZW0pOwogICAgICAgICAgICAgIGV2dC5pdGVtLl91bmRlcmx5aW5nX3ZtXyA9IHRoaXMuY2xvbmUodGhpcy5jb250ZXh0LmVsZW1lbnQpOwogICAgICAgICAgICAgIGRyYWdnaW5nRWxlbWVudCA9IGV2dC5pdGVtOwogICAgICAgICAgICB9LAogICAgICAgICAgICBvbkRyYWdBZGQ6IGZ1bmN0aW9uIG9uRHJhZ0FkZChldnQpIHsKICAgICAgICAgICAgICB2YXIgZWxlbWVudCA9IGV2dC5pdGVtLl91bmRlcmx5aW5nX3ZtXzsKCiAgICAgICAgICAgICAgaWYgKGVsZW1lbnQgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgT2JqZWN0KGhlbHBlclsiZCIKICAgICAgICAgICAgICAvKiByZW1vdmVOb2RlICovCiAgICAgICAgICAgICAgXSkoZXZ0Lml0ZW0pOwogICAgICAgICAgICAgIHZhciBuZXdJbmRleCA9IHRoaXMuZ2V0Vm1JbmRleChldnQubmV3SW5kZXgpOwogICAgICAgICAgICAgIHRoaXMuc3BsaWNlTGlzdChuZXdJbmRleCwgMCwgZWxlbWVudCk7CiAgICAgICAgICAgICAgdGhpcy5jb21wdXRlSW5kZXhlcygpOwogICAgICAgICAgICAgIHZhciBhZGRlZCA9IHsKICAgICAgICAgICAgICAgIGVsZW1lbnQ6IGVsZW1lbnQsCiAgICAgICAgICAgICAgICBuZXdJbmRleDogbmV3SW5kZXgKICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgIHRoaXMuZW1pdENoYW5nZXMoewogICAgICAgICAgICAgICAgYWRkZWQ6IGFkZGVkCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIG9uRHJhZ1JlbW92ZTogZnVuY3Rpb24gb25EcmFnUmVtb3ZlKGV2dCkgewogICAgICAgICAgICAgIE9iamVjdChoZWxwZXJbImMiCiAgICAgICAgICAgICAgLyogaW5zZXJ0Tm9kZUF0ICovCiAgICAgICAgICAgICAgXSkodGhpcy5yb290Q29udGFpbmVyLCBldnQuaXRlbSwgZXZ0Lm9sZEluZGV4KTsKCiAgICAgICAgICAgICAgaWYgKGV2dC5wdWxsTW9kZSA9PT0gImNsb25lIikgewogICAgICAgICAgICAgICAgT2JqZWN0KGhlbHBlclsiZCIKICAgICAgICAgICAgICAgIC8qIHJlbW92ZU5vZGUgKi8KICAgICAgICAgICAgICAgIF0pKGV2dC5jbG9uZSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB2YXIgb2xkSW5kZXggPSB0aGlzLmNvbnRleHQuaW5kZXg7CiAgICAgICAgICAgICAgdGhpcy5zcGxpY2VMaXN0KG9sZEluZGV4LCAxKTsKICAgICAgICAgICAgICB2YXIgcmVtb3ZlZCA9IHsKICAgICAgICAgICAgICAgIGVsZW1lbnQ6IHRoaXMuY29udGV4dC5lbGVtZW50LAogICAgICAgICAgICAgICAgb2xkSW5kZXg6IG9sZEluZGV4CiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICB0aGlzLnJlc2V0VHJhbnNpdGlvbkRhdGEob2xkSW5kZXgpOwogICAgICAgICAgICAgIHRoaXMuZW1pdENoYW5nZXMoewogICAgICAgICAgICAgICAgcmVtb3ZlZDogcmVtb3ZlZAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9LAogICAgICAgICAgICBvbkRyYWdVcGRhdGU6IGZ1bmN0aW9uIG9uRHJhZ1VwZGF0ZShldnQpIHsKICAgICAgICAgICAgICBPYmplY3QoaGVscGVyWyJkIgogICAgICAgICAgICAgIC8qIHJlbW92ZU5vZGUgKi8KICAgICAgICAgICAgICBdKShldnQuaXRlbSk7CiAgICAgICAgICAgICAgT2JqZWN0KGhlbHBlclsiYyIKICAgICAgICAgICAgICAvKiBpbnNlcnROb2RlQXQgKi8KICAgICAgICAgICAgICBdKShldnQuZnJvbSwgZXZ0Lml0ZW0sIGV2dC5vbGRJbmRleCk7CiAgICAgICAgICAgICAgdmFyIG9sZEluZGV4ID0gdGhpcy5jb250ZXh0LmluZGV4OwogICAgICAgICAgICAgIHZhciBuZXdJbmRleCA9IHRoaXMuZ2V0Vm1JbmRleChldnQubmV3SW5kZXgpOwogICAgICAgICAgICAgIHRoaXMudXBkYXRlUG9zaXRpb24ob2xkSW5kZXgsIG5ld0luZGV4KTsKICAgICAgICAgICAgICB2YXIgbW92ZWQgPSB7CiAgICAgICAgICAgICAgICBlbGVtZW50OiB0aGlzLmNvbnRleHQuZWxlbWVudCwKICAgICAgICAgICAgICAgIG9sZEluZGV4OiBvbGRJbmRleCwKICAgICAgICAgICAgICAgIG5ld0luZGV4OiBuZXdJbmRleAogICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgdGhpcy5lbWl0Q2hhbmdlcyh7CiAgICAgICAgICAgICAgICBtb3ZlZDogbW92ZWQKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgdXBkYXRlUHJvcGVydHk6IGZ1bmN0aW9uIHVwZGF0ZVByb3BlcnR5KGV2dCwgcHJvcGVydHlOYW1lKSB7CiAgICAgICAgICAgICAgZXZ0Lmhhc093blByb3BlcnR5KHByb3BlcnR5TmFtZSkgJiYgKGV2dFtwcm9wZXJ0eU5hbWVdICs9IHRoaXMuaGVhZGVyT2Zmc2V0KTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgY29tcHV0ZUZ1dHVyZUluZGV4OiBmdW5jdGlvbiBjb21wdXRlRnV0dXJlSW5kZXgocmVsYXRlZENvbnRleHQsIGV2dCkgewogICAgICAgICAgICAgIGlmICghcmVsYXRlZENvbnRleHQuZWxlbWVudCkgewogICAgICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB2YXIgZG9tQ2hpbGRyZW4gPSBfdG9Db25zdW1hYmxlQXJyYXkoZXZ0LnRvLmNoaWxkcmVuKS5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZWwuc3R5bGVbImRpc3BsYXkiXSAhPT0gIm5vbmUiOwogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICB2YXIgY3VycmVudERPTUluZGV4ID0gZG9tQ2hpbGRyZW4uaW5kZXhPZihldnQucmVsYXRlZCk7CiAgICAgICAgICAgICAgdmFyIGN1cnJlbnRJbmRleCA9IHJlbGF0ZWRDb250ZXh0LmNvbXBvbmVudC5nZXRWbUluZGV4KGN1cnJlbnRET01JbmRleCk7CiAgICAgICAgICAgICAgdmFyIGRyYWdnZWRJbkxpc3QgPSBkb21DaGlsZHJlbi5pbmRleE9mKGRyYWdnaW5nRWxlbWVudCkgIT09IC0xOwogICAgICAgICAgICAgIHJldHVybiBkcmFnZ2VkSW5MaXN0IHx8ICFldnQud2lsbEluc2VydEFmdGVyID8gY3VycmVudEluZGV4IDogY3VycmVudEluZGV4ICsgMTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgb25EcmFnTW92ZTogZnVuY3Rpb24gb25EcmFnTW92ZShldnQsIG9yaWdpbmFsRXZlbnQpIHsKICAgICAgICAgICAgICB2YXIgb25Nb3ZlID0gdGhpcy5tb3ZlOwoKICAgICAgICAgICAgICBpZiAoIW9uTW92ZSB8fCAhdGhpcy5yZWFsTGlzdCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB2YXIgcmVsYXRlZENvbnRleHQgPSB0aGlzLmdldFJlbGF0ZWRDb250ZXh0RnJvbU1vdmVFdmVudChldnQpOwogICAgICAgICAgICAgIHZhciBkcmFnZ2VkQ29udGV4dCA9IHRoaXMuY29udGV4dDsKICAgICAgICAgICAgICB2YXIgZnV0dXJlSW5kZXggPSB0aGlzLmNvbXB1dGVGdXR1cmVJbmRleChyZWxhdGVkQ29udGV4dCwgZXZ0KTsKICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKGRyYWdnZWRDb250ZXh0LCB7CiAgICAgICAgICAgICAgICBmdXR1cmVJbmRleDogZnV0dXJlSW5kZXgKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB2YXIgc2VuZEV2dCA9IE9iamVjdC5hc3NpZ24oe30sIGV2dCwgewogICAgICAgICAgICAgICAgcmVsYXRlZENvbnRleHQ6IHJlbGF0ZWRDb250ZXh0LAogICAgICAgICAgICAgICAgZHJhZ2dlZENvbnRleHQ6IGRyYWdnZWRDb250ZXh0CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgcmV0dXJuIG9uTW92ZShzZW5kRXZ0LCBvcmlnaW5hbEV2ZW50KTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgb25EcmFnRW5kOiBmdW5jdGlvbiBvbkRyYWdFbmQoKSB7CiAgICAgICAgICAgICAgdGhpcy5jb21wdXRlSW5kZXhlcygpOwogICAgICAgICAgICAgIGRyYWdnaW5nRWxlbWVudCA9IG51bGw7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gInVuZGVmaW5lZCIgJiYgIlZ1ZSIgaW4gd2luZG93KSB7CiAgICAgICAgICB3aW5kb3cuVnVlLmNvbXBvbmVudCgiZHJhZ2dhYmxlIiwgZHJhZ2dhYmxlQ29tcG9uZW50KTsKICAgICAgICB9CiAgICAgICAgLyogaGFybW9ueSBkZWZhdWx0IGV4cG9ydCAqLwoKCiAgICAgICAgdmFyIHZ1ZWRyYWdnYWJsZSA9IGRyYWdnYWJsZUNvbXBvbmVudDsgLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9ub2RlX21vZHVsZXMvQHZ1ZS9jbGktc2VydmljZS9saWIvY29tbWFuZHMvYnVpbGQvZW50cnktbGliLmpzCgogICAgICAgIC8qIGhhcm1vbnkgZGVmYXVsdCBleHBvcnQgKi8KCiAgICAgICAgdmFyIGVudHJ5X2xpYiA9IF9fd2VicGFja19leHBvcnRzX19bImRlZmF1bHQiXSA9IHZ1ZWRyYWdnYWJsZTsKICAgICAgICAvKioqLwogICAgICB9CiAgICAgIC8qKioqKiovCgogICAgfSlbImRlZmF1bHQiXQogICk7Cn0pOw=="},null]}