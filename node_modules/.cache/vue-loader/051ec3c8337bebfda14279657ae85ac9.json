{"remainingRequest":"/media/ernst/63bce43c-5e51-4bf1-a611-3afdf32ac6f6/VueJS/IPTV-Tools/node_modules/vue-loader/lib/index.js??vue-loader-options!/media/ernst/63bce43c-5e51-4bf1-a611-3afdf32ac6f6/VueJS/IPTV-Tools/src/views/app/user/tickets.vue?vue&type=script&lang=js&","dependencies":[{"path":"/media/ernst/63bce43c-5e51-4bf1-a611-3afdf32ac6f6/VueJS/IPTV-Tools/src/views/app/user/tickets.vue","mtime":1625072775146},{"path":"/media/ernst/63bce43c-5e51-4bf1-a611-3afdf32ac6f6/VueJS/IPTV-Tools/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/media/ernst/63bce43c-5e51-4bf1-a611-3afdf32ac6f6/VueJS/IPTV-Tools/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/media/ernst/63bce43c-5e51-4bf1-a611-3afdf32ac6f6/VueJS/IPTV-Tools/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/media/ernst/63bce43c-5e51-4bf1-a611-3afdf32ac6f6/VueJS/IPTV-Tools/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCi8qIGVzbGludC1kaXNhYmxlIG5vLXVudXNlZC12YXJzICovCmltcG9ydCB7IG1hcEdldHRlcnMgfSBmcm9tICJ2dWV4IjsKaW1wb3J0IHsgaHR0cFNlcnZpY2UgfSBmcm9tICIuLi8uLi8uLi9zZXJ2aWNlcy9odHRwIjsKaW1wb3J0IHsgRXZlbnRCdXMgfSBmcm9tICIuLi8uLi8uLi9zZXJ2aWNlcy9lYnVzIjsKCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgaXNMb2FkaW5nOiBmYWxzZSwKICAgICAgYWN0aXZlQm94OiAwLAogICAgICB0aWNrZXRzOiBbXSwKICAgICAgZWRpdG9yT3BlbjogZmFsc2UsCiAgICAgIHRpY2tldE9wZW46IGZhbHNlLAogICAgICBzZWxlY3RlZDogW10sCiAgICAgIGVkaXRvcjogewogICAgICAgIHRpdGxlOiAiIiwKICAgICAgICBjb252ZXJzYXRpb246IFtdLAogICAgICAgIGF0dGFjaG1lbnRzOiBbXSwKICAgICAgICB0YWdzOiBbXSwKICAgICAgICBwcmlvcml0eTogMCwKICAgICAgICBzdGF0dXM6IDAsCiAgICAgICAgZGVwYXJ0ZW1lbnQ6IDEsCiAgICAgICAgbWVzc2FnZTogIiIsCiAgICAgICAgaWQ6IG51bGwsCiAgICAgIH0sCiAgICAgIHJlYWRlcjogewogICAgICAgIHRpY2tldDogbnVsbCwKICAgICAgICB0aXRsZTogIiIsCiAgICAgICAgY29udmVyc2F0aW9uOiBbXSwKICAgICAgfSwKICAgICAgcHJpb3JpdGllczogWwogICAgICAgIHsgdGV4dDogdGhpcy4kdCgicHJpb3JpdHkuMCIpLCB2YWx1ZTogMCB9LAogICAgICAgIHsgdGV4dDogdGhpcy4kdCgicHJpb3JpdHkuMSIpLCB2YWx1ZTogMSB9LAogICAgICAgIHsgdGV4dDogdGhpcy4kdCgicHJpb3JpdHkuMiIpLCB2YWx1ZTogMiB9LAogICAgICAgIHsgdGV4dDogdGhpcy4kdCgicHJpb3JpdHkuMyIpLCB2YWx1ZTogMyB9LAogICAgICBdLAogICAgICBkZXBhcnRlbWVudHM6IFsKICAgICAgICB7IHRleHQ6IHRoaXMuJHQoImRlcGFydGVtZW50LjAiKSwgdmFsdWU6IDAgfSwKICAgICAgICB7IHRleHQ6IHRoaXMuJHQoImRlcGFydGVtZW50LjEiKSwgdmFsdWU6IDEgfSwKICAgICAgICB7IHRleHQ6IHRoaXMuJHQoImRlcGFydGVtZW50LjIiKSwgdmFsdWU6IDIgfSwKICAgICAgICB7IHRleHQ6IHRoaXMuJHQoImRlcGFydGVtZW50LjMiKSwgdmFsdWU6IDMgfSwKICAgICAgICB7IHRleHQ6IHRoaXMuJHQoImRlcGFydGVtZW50LjQiKSwgdmFsdWU6IDQgfSwKICAgICAgICB7IHRleHQ6IHRoaXMuJHQoImRlcGFydGVtZW50LjUiKSwgdmFsdWU6IDUgfSwKICAgICAgXSwKICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgLi4ubWFwR2V0dGVycyhbImN1cnJlbnRVc2VyIl0pLAogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHZ1ZS9yZXR1cm4taW4tY29tcHV0ZWQtcHJvcGVydHkKICAgIGJveFRpdGxlKCkgewogICAgICBzd2l0Y2ggKHRoaXMuYWN0aXZlQm94KSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgcmV0dXJuIHRoaXMuJHQoInRpY2tldHMub3BlbiIpOwogICAgICAgIGNhc2UgMToKICAgICAgICAgIHJldHVybiB0aGlzLiR0KCJ0aWNrZXRzLmFuc3dlcmVkIik7CiAgICAgICAgY2FzZSAyOgogICAgICAgICAgcmV0dXJuIHRoaXMuJHQoInRpY2tldHMuY2xvc2VkIik7CiAgICAgICAgY2FzZSAzOgogICAgICAgICAgcmV0dXJuIHRoaXMuJHQoInRpY2tldHMuYXJjaGl2ZWQiKTsKICAgICAgfQogICAgfSwKICAgIHRpY2tldHNJbkJveCgpIHsKICAgICAgcmV0dXJuIHRoaXMudGlja2V0cy5maWx0ZXIoKHRpY2tldCkgPT4gewogICAgICAgIHJldHVybiB0aWNrZXQudGlja2V0X3N0YXR1cyA9PT0gdGhpcy5hY3RpdmVCb3g7CiAgICAgIH0pOwogICAgfSwKICAgIG9wZW5UaWNrZXRzKCkgewogICAgICByZXR1cm4gKAogICAgICAgIHRoaXMudGlja2V0cy5maWx0ZXIoKHRpY2tldCkgPT4gewogICAgICAgICAgcmV0dXJuIHRpY2tldC50aWNrZXRfc3RhdHVzID09PSAwOwogICAgICAgIH0pLmxlbmd0aCArIGAgJHt0aGlzLiR0KCJuYXZiYXIudGlja2V0cyIpfWAKICAgICAgKTsKICAgIH0sCiAgICBhbnN3ZXJlZFRpY2tldHMoKSB7CiAgICAgIHJldHVybiAoCiAgICAgICAgdGhpcy50aWNrZXRzLmZpbHRlcigodGlja2V0KSA9PiB7CiAgICAgICAgICByZXR1cm4gdGlja2V0LnRpY2tldF9zdGF0dXMgPT09IDE7CiAgICAgICAgfSkubGVuZ3RoICsgYCAke3RoaXMuJHQoIm5hdmJhci50aWNrZXRzIil9YAogICAgICApOwogICAgfSwKICAgIGNsb3NlZFRpY2tldHMoKSB7CiAgICAgIHJldHVybiAoCiAgICAgICAgdGhpcy50aWNrZXRzLmZpbHRlcigodGlja2V0KSA9PiB7CiAgICAgICAgICByZXR1cm4gdGlja2V0LnRpY2tldF9zdGF0dXMgPT09IDI7CiAgICAgICAgfSkubGVuZ3RoICsgYCAke3RoaXMuJHQoIm5hdmJhci50aWNrZXRzIil9YAogICAgICApOwogICAgfSwKICAgIGFyY2hpdmVkVGlja2V0cygpIHsKICAgICAgcmV0dXJuICgKICAgICAgICB0aGlzLnRpY2tldHMuZmlsdGVyKCh0aWNrZXQpID0+IHsKICAgICAgICAgIHJldHVybiB0aWNrZXQudGlja2V0X3N0YXR1cyA9PT0gMzsKICAgICAgICB9KS5sZW5ndGggKyBgICR7dGhpcy4kdCgibmF2YmFyLnRpY2tldHMiKX1gCiAgICAgICk7CiAgICB9LAogICAgY2FuQW5zd2VyKCkgewogICAgICByZXR1cm4gdGhpcy5hY3RpdmVCb3ggPCAyOwogICAgfSwKICAgIGNhbkRlbGV0ZSgpIHsKICAgICAgcmV0dXJuIHRoaXMuc2VsZWN0ZWQubGVuZ3RoID4gMDsKICAgIH0sCiAgICBjYW5TZWxlY3RBbGwoKSB7CiAgICAgIHJldHVybiB0aGlzLnRpY2tldHNJbkJveC5sZW5ndGggPiAwOwogICAgfSwKICAgIGhhc0hpc3RvcnkoKSB7CiAgICAgIHJldHVybiB0aGlzLmVkaXRvci5jb252ZXJzYXRpb24ubGVuZ3RoOwogICAgfSwKICB9LAogIG1ldGhvZHM6IHsKICAgIGZvcm1hdERhdGUoZGF0ZSwgbG9uZyA9IHRydWUpIHsKICAgICAgcmV0dXJuIGxvbmcKICAgICAgICA/IG5ldyBEYXRlKGRhdGUpLnRvTG9jYWxlU3RyaW5nKHRoaXMuJHQoImRhdGUubG9jYWxlIikpCiAgICAgICAgOiBuZXcgRGF0ZShkYXRlKS50b0xvY2FsZURhdGVTdHJpbmcodGhpcy4kdCgiZGF0ZS5sb2NhbGUiKSk7CiAgICB9LAogICAgY2hhbmdlQm94KGJveCkgewogICAgICB0aGlzLmVkaXRvck9wZW4gPSBmYWxzZTsKICAgICAgdGhpcy5zZWxlY3RlZC5sZW5ndGggPSAwOwogICAgICB0aGlzLmFjdGl2ZUJveCA9IGJveDsKICAgIH0sCiAgICB0b2dnbGVTZWxlY3RBbGwoKSB7CiAgICAgIGlmICh0aGlzLnNlbGVjdGVkLmxlbmd0aCA+IDApIHsKICAgICAgICB0aGlzLnNlbGVjdGVkLnNwbGljZSgwLCB0aGlzLnNlbGVjdGVkLmxlbmd0aCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy50aWNrZXRzSW5Cb3gubWFwKCh0aWNrZXQpID0+IHsKICAgICAgICAgIHRoaXMuc2VsZWN0ZWQucHVzaCh0aWNrZXQuaWQpOwogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgbG9hZFRpY2tldHMoKSB7CiAgICAgIHRoaXMuaXNMb2FkaW5nID0gdHJ1ZTsKICAgICAgaHR0cFNlcnZpY2UKICAgICAgICAuZ2V0KCJ1c2Vycy90aWNrZXRzIikKICAgICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgICB0aGlzLmlzTG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgaWYgKHJlcy5zdGF0dXMgPT09IHRydWUpIHsKICAgICAgICAgICAgdGhpcy50aWNrZXRzID0gcmVzLmRhdGE7CiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKCkgPT4gewogICAgICAgICAgdGhpcy5pc0xvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgIHRoaXMuJG5vdGlmeSgKICAgICAgICAgICAgImVycm9yIiwKICAgICAgICAgICAgdGhpcy4kdCgicHJvZmlsZS5mYWlsZWQiKSwKICAgICAgICAgICAgdGhpcy4kdCgidGlja2V0cy50aWNrZXRzLWxvYWRpbmctZmFpbGVkIiksCiAgICAgICAgICAgICJsYS11c2VyLXNoaWVsZCIsCiAgICAgICAgICAgIHsgZHVyYXRpb246IDUwMDAsIHBlcm1hbmVudDogZmFsc2UgfQogICAgICAgICAgKTsKICAgICAgICB9KTsKICAgIH0sCiAgICBkZWxldGVUaWNrZXQoaWQpIHsKICAgICAgdGhpcy5pc0xvYWRpbmcgPSB0cnVlOwogICAgICBodHRwU2VydmljZQogICAgICAgIC5kZWxldGUoYHVzZXJzL3RpY2tldHMvJHtpZCAhPT0gdW5kZWZpbmVkID8gaWQgOiB0aGlzLnNlbGVjdGVkLmpvaW4oKX1gKQogICAgICAgIC50aGVuKChyZXMpID0+IHsKICAgICAgICAgIHRoaXMuaXNMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICBpZiAocmVzLnN0YXR1cyA9PT0gdHJ1ZSkgewogICAgICAgICAgICB0aGlzLmxvYWRUaWNrZXRzKCk7CiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKCkgPT4gewogICAgICAgICAgdGhpcy5pc0xvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgIHRoaXMuJG5vdGlmeSgKICAgICAgICAgICAgImVycm9yIiwKICAgICAgICAgICAgdGhpcy4kdCgicHJvZmlsZS5mYWlsZWQiKSwKICAgICAgICAgICAgdGhpcy4kdCgidGlja2V0cy50aWNrZXRzLXJlbW92aW5nLWZhaWxlZCIpLAogICAgICAgICAgICAibGEtdXNlci1zaGllbGQiLAogICAgICAgICAgICB7IGR1cmF0aW9uOiA1MDAwLCBwZXJtYW5lbnQ6IGZhbHNlIH0KICAgICAgICAgICk7CiAgICAgICAgfSk7CiAgICB9LAogICAgc2F2ZVRpY2tldCgpIHsKICAgICAgbGV0IHRpdGxlID0KICAgICAgICB0aGlzLmN1cnJlbnRVc2VyLnByb2ZpbGUgJiYKICAgICAgICB0aGlzLmN1cnJlbnRVc2VyLnByb2ZpbGUubmFtZV9maXJzdC5sZW5ndGggJiYKICAgICAgICB0aGlzLmN1cnJlbnRVc2VyLnByb2ZpbGUubmFtZV9sYXN0Lmxlbmd0aAogICAgICAgICAgPyBgJHt0aGlzLmN1cnJlbnRVc2VyLnByb2ZpbGUubmFtZV9maXJzdH0gJHt0aGlzLmN1cnJlbnRVc2VyLnByb2ZpbGUubmFtZV9sYXN0fWAKICAgICAgICAgIDogdGhpcy5jdXJyZW50VXNlci51c2VyLnVzZXJuYW1lOwoKICAgICAgLy8gQWRkIG1lc3NhZ2UgdG8gY29udmVyc2F0aW9uCiAgICAgIHRoaXMuZWRpdG9yLmNvbnZlcnNhdGlvbi51bnNoaWZ0KHsKICAgICAgICBkYXRlOiBuZXcgRGF0ZSgpLAogICAgICAgIG1lc3NhZ2U6IHRoaXMuZWRpdG9yLm1lc3NhZ2UsCiAgICAgICAgdXNlcjogewogICAgICAgICAgdGl0bGU6IHRpdGxlLAogICAgICAgICAgaWNvbjogImxhLXVzZXIiLAogICAgICAgICAgcm9sZTogdGhpcy5jdXJyZW50VXNlci51c2VyLnJvbGUsCiAgICAgICAgfSwKICAgICAgfSk7CgogICAgICBsZXQgZGF0YSA9IHsKICAgICAgICB1c2VyX2lkOiB0aGlzLmN1cnJlbnRVc2VyLnVzZXIuaWQsCiAgICAgICAgdGl0bGU6IHRoaXMuZWRpdG9yLnRpdGxlLAogICAgICAgIHByaW9yaXR5OiB0aGlzLmVkaXRvci5wcmlvcml0eSwKICAgICAgICB0aWNrZXRfc3RhdHVzOiAwLAogICAgICAgIGRlcGFydGVtZW50OiB0aGlzLmVkaXRvci5kZXBhcnRlbWVudCwKICAgICAgICBjb252ZXJzYXRpb246IHRoaXMuZWRpdG9yLmNvbnZlcnNhdGlvbiwKICAgICAgICBsYW5nOiB0aGlzLiRpMThuLmxvY2FsZSwKICAgICAgfTsKCiAgICAgIGlmICghaXNOYU4odGhpcy5lZGl0b3IuaWQpICYmIHRoaXMuZWRpdG9yLmlkICE9PSBudWxsKSB7CiAgICAgICAgZGF0YS5pZCA9IHRoaXMuZWRpdG9yLmlkOwogICAgICB9CgogICAgICB0aGlzLmlzTG9hZGluZyA9IHRydWU7CiAgICAgIGh0dHBTZXJ2aWNlCiAgICAgICAgLnBvc3QoInVzZXJzL3RpY2tldHMiLCBkYXRhKQogICAgICAgIC50aGVuKChyZXMpID0+IHsKICAgICAgICAgIHRoaXMuaXNMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICBpZiAocmVzLnN0YXR1cyA9PT0gdHJ1ZSkgewogICAgICAgICAgICB0aGlzLmVkaXRvck9wZW4gPSBmYWxzZTsKICAgICAgICAgICAgdGhpcy4kbm90aWZ5KAogICAgICAgICAgICAgICJwcmltYXJ5IiwKICAgICAgICAgICAgICB0aGlzLiR0KCJwcm9maWxlLnN1Y2Nlc3MiKSwKICAgICAgICAgICAgICB0aGlzLiR0KCJ0aWNrZXRzLnRpY2tldHMtc2F2aW5nLXN1Y2Nlc3MiKSwKICAgICAgICAgICAgICAibGEtcGFwZXItcGxhbmUiLAogICAgICAgICAgICAgIHsgZHVyYXRpb246IDUwMDAsIHBlcm1hbmVudDogZmFsc2UgfQogICAgICAgICAgICApOwogICAgICAgICAgICB0aGlzLmxvYWRUaWNrZXRzKCk7CiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKCkgPT4gewogICAgICAgICAgdGhpcy5pc0xvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgIHRoaXMuJG5vdGlmeSgKICAgICAgICAgICAgImVycm9yIiwKICAgICAgICAgICAgdGhpcy4kdCgicHJvZmlsZS5mYWlsZWQiKSwKICAgICAgICAgICAgdGhpcy4kdCgidGlja2V0cy50aWNrZXRzLXNhdmluZy1mYWlsZWQiKSwKICAgICAgICAgICAgImxhLXVzZXItc2hpZWxkIiwKICAgICAgICAgICAgeyBkdXJhdGlvbjogNTAwMCwgcGVybWFuZW50OiBmYWxzZSB9CiAgICAgICAgICApOwogICAgICAgIH0pOwogICAgfSwKICAgIG5ld1RpY2tldCgpIHsKICAgICAgbGV0IGUgPSB0aGlzLmVkaXRvcjsKICAgICAgZS50aXRsZSA9ICIiOwogICAgICBlLmNvbnZlcnNhdGlvbiA9IFtdOwogICAgICBlLmF0dGFjaG1lbnRzID0gW107CiAgICAgIGUudGFncyA9IFtdOwogICAgICBlLnByaW9yaXR5ID0gMDsKICAgICAgZS5zdGF0dXMgPSAwOwogICAgICBlLmRlcGFydGVtZW50ID0gMTsKICAgICAgZS5tZXNzYWdlID0gIiI7CiAgICAgIGUuaWQgPSBudWxsOwogICAgICB0aGlzLmVkaXRvck9wZW4gPSB0cnVlOwogICAgfSwKICAgIGVkaXRUaWNrZXQodGlja2V0KSB7CiAgICAgIGxldCBlID0gdGhpcy5lZGl0b3I7CiAgICAgIGxldCB0OwogICAgICBpZiAodGlja2V0KSB7CiAgICAgICAgdCA9IE9iamVjdC5hc3NpZ24oe30sIHRpY2tldCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdCA9IE9iamVjdC5hc3NpZ24oe30sIHRoaXMucmVhZGVyLnRpY2tldCk7CiAgICAgIH0KICAgICAgZS50aXRsZSA9IHQudGl0bGU7CiAgICAgIGUuY29udmVyc2F0aW9uID0gdC5jb252ZXJzYXRpb247CiAgICAgIGUuYXR0YWNobWVudHMgPSB0LmF0dGFjaG1lbnRzOwogICAgICBlLnRhZ3MgPSB0LnRhZ3M7CiAgICAgIGUucHJpb3JpdHkgPSB0LnByaW9yaXR5OwogICAgICBlLnN0YXR1cyA9IDA7CiAgICAgIGUuZGVwYXJ0ZW1lbnQgPSB0LmRlcGFydGVtZW50OwogICAgICBlLm1lc3NhZ2UgPSAiIjsKICAgICAgZS5pZCA9IHQuaWQ7CiAgICAgIHRoaXMudGlja2V0T3BlbiA9IGZhbHNlOwogICAgICB0aGlzLmVkaXRvck9wZW4gPSB0cnVlOwogICAgfSwKICAgIGFyY2hpdmVUaWNrZXQoKSB7CiAgICAgIGh0dHBTZXJ2aWNlCiAgICAgICAgLnBvc3QoInVzZXJzL3RpY2tldHMiLCB7CiAgICAgICAgICBpZDogdGhpcy5yZWFkZXIudGlja2V0LmlkLAogICAgICAgICAgdXNlcl9pZDogdGhpcy5jdXJyZW50VXNlci51c2VyLmlkLAogICAgICAgICAgdGlja2V0X3N0YXR1czogMywKICAgICAgICB9KQogICAgICAgIC50aGVuKChyZXMpID0+IHsKICAgICAgICAgIHRoaXMuaXNMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICBpZiAocmVzLnN0YXR1cyA9PT0gdHJ1ZSkgewogICAgICAgICAgICB0aGlzLmVkaXRvck9wZW4gPSBmYWxzZTsKICAgICAgICAgICAgdGhpcy50aWNrZXRPcGVuID0gZmFsc2U7CiAgICAgICAgICAgIHRoaXMubG9hZFRpY2tldHMoKTsKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoKSA9PiB7CiAgICAgICAgICB0aGlzLmlzTG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgdGhpcy4kbm90aWZ5KAogICAgICAgICAgICAiZXJyb3IiLAogICAgICAgICAgICB0aGlzLiR0KCJwcm9maWxlLmZhaWxlZCIpLAogICAgICAgICAgICB0aGlzLiR0KCJ0aWNrZXRzLnRpY2tldHMtc2F2aW5nLWZhaWxlZCIpLAogICAgICAgICAgICAibGEtdXNlci1zaGllbGQiLAogICAgICAgICAgICB7IGR1cmF0aW9uOiA1MDAwLCBwZXJtYW5lbnQ6IGZhbHNlIH0KICAgICAgICAgICk7CiAgICAgICAgfSk7CiAgICB9LAogICAgb3BlblRpY2tldCh0aWNrZXQpIHsKICAgICAgdGhpcy5yZWFkZXIudGl0bGUgPSB0aWNrZXQudGl0bGU7CiAgICAgIHRoaXMucmVhZGVyLmNvbnZlcnNhdGlvbiA9IHRpY2tldC5jb252ZXJzYXRpb247CiAgICAgIHRoaXMucmVhZGVyLnRpY2tldCA9IHRpY2tldDsKICAgICAgdGhpcy50aWNrZXRPcGVuID0gdHJ1ZTsKICAgIH0sCiAgICByb2xlVmFyaWFudChyb2xlKSB7CiAgICAgIHN3aXRjaCAocm9sZSkgewogICAgICAgIGNhc2UgMToKICAgICAgICBjYXNlIDE5ODU6CiAgICAgICAgICByZXR1cm4gImRhbmdlciI7CgogICAgICAgIGNhc2UgMjoKICAgICAgICBjYXNlIDQ6CiAgICAgICAgY2FzZSA1OgogICAgICAgICAgcmV0dXJuICJpbmZvIjsKCiAgICAgICAgY2FzZSAzOgogICAgICAgICAgcmV0dXJuICJwcmltYXJ5IjsKICAgICAgfQogICAgfSwKICAgIHBhZ2VQcmludCgpIHsKICAgICAgaWYgKHRoaXMudGlja2V0T3BlbikgewogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ0aWNrZXQtcmVhZGVyIikucHJpbnQoKTsKICAgICAgfSBlbHNlIGlmICh0aGlzLmVkaXRvck9wZW4pIHsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgidGlja2V0LWVkaXRvciIpLnByaW50KCk7CiAgICAgIH0KICAgIH0sCiAgICBzZWFyY2hJbkNvbnZlcnNhdGlvbnMoY29udmVyc2F0aW9ucywgc2VhcmNoKSB7CiAgICAgIGxldCBmb3VuZCA9IGZhbHNlOwogICAgICBsZXQgcmUgPSBuZXcgUmVnRXhwKHNlYXJjaCwgImkiKTsKICAgICAgY29udmVyc2F0aW9ucy5tYXAoKGNvbnZlcnNhdGlvbikgPT4gewogICAgICAgIGlmIChjb252ZXJzYXRpb24ubWVzc2FnZS5tYXRjaChyZSkpIHsKICAgICAgICAgIGZvdW5kID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICByZXR1cm4gZm91bmQ7CiAgICB9LAogICAgc2VhcmNoVGlja2V0KHNlYXJjaCkgewogICAgICBpZiAoc2VhcmNoID09PSB1bmRlZmluZWQgfHwgc2VhcmNoID09PSBudWxsIHx8IHNlYXJjaC5sZW5ndGggPT09IDApIHsKICAgICAgICB0aGlzLmxvYWRUaWNrZXRzKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaHR0cFNlcnZpY2UKICAgICAgICAgIC5nZXQoInVzZXJzL3RpY2tldHMiKQogICAgICAgICAgLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgICB0aGlzLmlzTG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICBpZiAocmVzLnN0YXR1cyA9PT0gdHJ1ZSkgewogICAgICAgICAgICAgIHRoaXMudGlja2V0cyA9IHJlcy5kYXRhLmZpbHRlcigodGlja2V0KSA9PiB7CiAgICAgICAgICAgICAgICB2YXIgcmUgPSBuZXcgUmVnRXhwKHNlYXJjaCwgImkiKTsKICAgICAgICAgICAgICAgIHZhciBmb3VuZEluVGl0bGUgPSB0aWNrZXQudGl0bGUubWF0Y2gocmUpOwogICAgICAgICAgICAgICAgdmFyIGZvdW5kSW5Db252ZXJzYXRpb24gPSB0aGlzLnNlYXJjaEluQ29udmVyc2F0aW9ucygKICAgICAgICAgICAgICAgICAgdGlja2V0LmNvbnZlcnNhdGlvbiwKICAgICAgICAgICAgICAgICAgc2VhcmNoCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgcmV0dXJuIGZvdW5kSW5UaXRsZSB8fCBmb3VuZEluQ29udmVyc2F0aW9uOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9KQogICAgICAgICAgLmNhdGNoKCgpID0+IHsKICAgICAgICAgICAgdGhpcy50aWNrZXRzID0gW107CiAgICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICB9LAogIG1vdW50ZWQoKSB7CiAgICB0aGlzLmxvYWRUaWNrZXRzKCk7CiAgfSwKICBiZWZvcmVNb3VudCgpIHsKICAgIEV2ZW50QnVzLiRvbigicHJpbnQiLCB0aGlzLnBhZ2VQcmludCk7CiAgICBFdmVudEJ1cy4kb24oInNlYXJjaCIsIHRoaXMuc2VhcmNoVGlja2V0KTsKICB9LAogIGJlZm9yZURlc3Ryb3koKSB7CiAgICBFdmVudEJ1cy4kb2ZmKCJwcmludCIsIHRoaXMucGFnZVByaW50KTsKICAgIEV2ZW50QnVzLiRvZmYoInNlYXJjaCIsIHRoaXMuc2VhcmNoVGlja2V0KTsKICB9LAp9Owo="},{"version":3,"sources":["tickets.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkTA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"tickets.vue","sourceRoot":"src/views/app/user","sourcesContent":["<template>\n  <erd-row class=\"m-0 p-0\">\n    <erd-spinner v-if=\"isLoading\" size=\"lg\" overlay absolute></erd-spinner>\n    <erd-col xl=\"2\" lg=\"3\" md=\"4\" v-if=\"!editorOpen && !ticketOpen\">\n      <erd-button icon=\"la-user-edit\" block @click=\"newTicket\">\n        {{ $t(\"tickets.new-ticket\") }}\n      </erd-button>\n      <erd-card class=\"mt-3 p-2 boxes\">\n        <a\n          class=\"ticket-box\"\n          href=\"#\"\n          :class=\"{ active: activeBox === 0 }\"\n          @click.prevent=\"changeBox(0)\"\n        >\n          <i class=\"las la-user\"></i>\n          <span>{{ $t(\"tickets.open\") }}</span>\n        </a>\n        <a\n          class=\"ticket-box\"\n          href=\"#\"\n          :class=\"{ active: activeBox === 1 }\"\n          @click.prevent=\"changeBox(1)\"\n        >\n          <i class=\"las la-user-check\"></i>\n          <span>{{ $t(\"tickets.answered\") }}</span>\n        </a>\n        <a\n          class=\"ticket-box\"\n          href=\"#\"\n          :class=\"{ active: activeBox === 2 }\"\n          @click.prevent=\"changeBox(2)\"\n        >\n          <i class=\"las la-user-check\"></i>\n          <span>{{ $t(\"tickets.closed\") }}</span>\n        </a>\n        <a\n          class=\"ticket-box\"\n          href=\"#\"\n          :class=\"{ active: activeBox === 3 }\"\n          @click.prevent=\"changeBox(3)\"\n        >\n          <i class=\"las la-user-lock\"></i>\n          <span>{{ $t(\"tickets.archived\") }}</span>\n        </a>\n      </erd-card>\n    </erd-col>\n    <erd-col xl=\"2\" lg=\"3\" md=\"4\" v-if=\"editorOpen && !ticketOpen\">\n      <erd-button\n        class=\"mb-1\"\n        icon=\"la-paper-plane\"\n        @click=\"saveTicket\"\n        block\n        >{{ $t(\"general.submit\") }}</erd-button\n      >\n      <erd-button\n        variant=\"danger\"\n        @click=\"editorOpen = false\"\n        class=\"mb-3\"\n        block\n        >{{ $t(\"general.cancel\") }}</erd-button\n      >\n      <label for=\"priority\">{{ $t(\"tickets.priority\") }}</label>\n      <erd-select\n        :items=\"priorities\"\n        v-model=\"editor.priority\"\n        class=\"w-100 mb-2\"\n        id=\"priority\"\n      ></erd-select>\n      <label for=\"departement\">{{ $t(\"tickets.departement\") }}</label>\n      <erd-select\n        :items=\"departements\"\n        v-model=\"editor.departement\"\n        class=\"w-100\"\n        id=\"departement\"\n      ></erd-select>\n    </erd-col>\n    <erd-col xl=\"2\" lg=\"3\" md=\"4\" v-if=\"!editorOpen && ticketOpen\">\n      <erd-button\n        class=\"mb-1\"\n        icon=\"la-reply\"\n        @click=\"editTicket\"\n        v-if=\"activeBox < 2\"\n        block\n        >{{ $t(\"tickets.reply\") }}</erd-button\n      >\n      <erd-button\n        variant=\"info\"\n        icon=\"la-user-lock\"\n        @click=\"archiveTicket\"\n        class=\"mb-1\"\n        v-if=\"activeBox < 2\"\n        block\n        >{{ $t(\"tickets.archive\") }}</erd-button\n      >\n      <erd-button\n        variant=\"danger\"\n        @click=\"ticketOpen = false\"\n        class=\"mb-3\"\n        block\n        >{{ $t(\"general.cancel\") }}</erd-button\n      >\n    </erd-col>\n    <erd-col xl=\"10\" lg=\"9\" md=\"8\" class=\"m-0 p-0\">\n      <erd-row class=\"m-0 p-0\" v-if=\"!editorOpen && !ticketOpen\">\n        <erd-col xl=\"3\" md=\"6\" class=\"d-none d-md-block\">\n          <erd-card>\n            <erd-card-body class=\"ticket-card\">\n              <i class=\"las la-user la-5x color-theme-1\"></i>\n              <div class=\"ticket-card-title\" style=\"\">\n                <h5 class=\"m-0\">{{ $t(\"tickets.open\") }}</h5>\n                <p class=\"m-0 color-theme-1\">{{ openTickets }}</p>\n              </div>\n            </erd-card-body>\n          </erd-card>\n        </erd-col>\n        <erd-col xl=\"3\" md=\"6\" class=\"d-none d-md-block\">\n          <erd-card>\n            <erd-card-body class=\"ticket-card\">\n              <i class=\"las la-user-check la-5x text-success\"></i>\n              <div class=\"ticket-card-title\" style=\"\">\n                <h5 class=\"m-0\">{{ $t(\"tickets.answered\") }}</h5>\n                <p class=\"m-0 text-success\">{{ answeredTickets }}</p>\n              </div>\n            </erd-card-body>\n          </erd-card>\n        </erd-col>\n        <erd-col xl=\"3\" md=\"6\" class=\"d-none d-md-block\">\n          <erd-card>\n            <erd-card-body class=\"ticket-card\">\n              <i class=\"las la-user-shield la-5x text-danger\"></i>\n              <div class=\"ticket-card-title\" style=\"\">\n                <h5 class=\"m-0\">{{ $t(\"tickets.closed\") }}</h5>\n                <p class=\"m-0 text-danger\">{{ closedTickets }}</p>\n              </div>\n            </erd-card-body>\n          </erd-card>\n        </erd-col>\n        <erd-col xl=\"3\" md=\"6\" class=\"d-none d-md-block\">\n          <erd-card>\n            <erd-card-body class=\"ticket-card\">\n              <i class=\"las la-user-lock la-5x text-info\"></i>\n              <div class=\"ticket-card-title\" style=\"\">\n                <h5 class=\"m-0\">{{ $t(\"tickets.archived\") }}</h5>\n                <p class=\"m-0 text-info\">{{ archivedTickets }}</p>\n              </div>\n            </erd-card-body>\n          </erd-card>\n        </erd-col>\n        <erd-col xl=\"12\">\n          <erd-card class=\"p-2 ticket-list-view\">\n            <div class=\"ticket-list-header\">\n              <h5>{{ boxTitle }}</h5>\n              <div class=\"buttons\">\n                <erd-button\n                  icon=\"la-check\"\n                  variant=\"info\"\n                  class=\"mr-1\"\n                  :disabled=\"!canSelectAll\"\n                  @click=\"toggleSelectAll\"\n                ></erd-button>\n                <erd-button\n                  icon=\"la-trash\"\n                  variant=\"danger\"\n                  class=\"mr-1\"\n                  :disabled=\"!canDelete\"\n                  @click=\"deleteTicket\"\n                ></erd-button>\n                <erd-button icon=\"la-sync\" @click=\"loadTickets\"></erd-button>\n              </div>\n            </div>\n            <div class=\"ticket-list\">\n              <div class=\"empty-list\" v-if=\"ticketsInBox.length === 0\">\n                <i class=\"las la-box-open\"></i>\n                <p>{{ $t(\"tickets.empty\") }}</p>\n              </div>\n              <div\n                class=\"\n                  d-flex\n                  flex-row\n                  px-2\n                  py-2\n                  justify-content-between\n                  ticket-list-item\n                \"\n                v-for=\"ticket in ticketsInBox\"\n                :key=\"`ticket-${ticket.id}`\"\n              >\n                <div class=\"flex-fill\">\n                  <erd-checkbox\n                    :value=\"ticket.id\"\n                    v-model=\"selected\"\n                  ></erd-checkbox>\n                  <a href=\"#\" @click.prevent=\"openTicket(ticket)\"\n                    >{{ ticket.title }}\n                    <erd-badge\n                      class=\"ml-2\"\n                      v-for=\"(tag, index) in ticket.tags\"\n                      :key=\"`ticket-${ticket.id}-tag-${index}`\"\n                      variant=\"primary\"\n                      >{{ tag }}</erd-badge\n                    ></a\n                  >\n                </div>\n                <div class=\"flex-grow-0 flex-shrink-0\">\n                  <erd-button\n                    icon=\"la-reply\"\n                    variant=\"primary\"\n                    class=\"mx-1\"\n                    v-if=\"canAnswer\"\n                    @click=\"editTicket(ticket)\"\n                  ></erd-button>\n                  <erd-button\n                    icon=\"la-trash\"\n                    variant=\"danger\"\n                    class=\"mr-3\"\n                    @click=\"deleteTicket(ticket.id)\"\n                  ></erd-button>\n                  <span\n                    class=\"text-small text-muted d-none d-md-inline-block\"\n                    >{{ formatDate(ticket.last_updated) }}</span\n                  >\n                  <span\n                    class=\"text-small text-muted d-sm-inline-block d-md-none\"\n                    >{{ formatDate(ticket.last_updated, false) }}</span\n                  >\n                </div>\n              </div>\n            </div>\n          </erd-card>\n        </erd-col>\n      </erd-row>\n      <erd-row class=\"m-0 p-0\" v-if=\"editorOpen && !ticketOpen\">\n        <div class=\"ticket-editor\">\n          <label for=\"title\">{{ $t(\"tickets.title\") }}</label>\n          <erd-input\n            v-model=\"editor.title\"\n            class=\"w-100 mb-2\"\n            id=\"title\"\n          ></erd-input>\n          <label>{{ $t(\"tickets.message\") }}</label>\n          <wysiwyg v-model=\"editor.message\" class=\"mb-2\" />\n          <label v-if=\"hasHistory\">{{ $t(\"tickets.history\") }}</label>\n          <div\n            class=\"form-control w-100 pt-4 mt-print-4 pt-print-2\"\n            v-if=\"hasHistory\"\n            id=\"ticket-editor\"\n          >\n            <div\n              class=\"ticket-conversation\"\n              v-for=\"(conversation, index) in editor.conversation\"\n              :key=\"`conversation-${index}`\"\n            >\n              <div class=\"ticket-title\">\n                <span class=\"sender\">\n                  <i class=\"las la-2x\" :class=\"conversation.user.icon\"></i>\n                  <span class=\"font-weight-bold\">{{\n                    conversation.user.title\n                  }}</span>\n                  <erd-badge\n                    :variant=\"roleVariant(conversation.user.role)\"\n                    class=\"ml-2 pb-1\"\n                    >{{ $t(`roles.${conversation.user.role}`) }}</erd-badge\n                  >\n                </span>\n                <span class=\"date\">{{ formatDate(conversation.date) }}</span>\n              </div>\n              <div class=\"ticket-body\">\n                <div v-html=\"conversation.message\"></div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </erd-row>\n      <erd-row class=\"p-0\" v-if=\"!editorOpen && ticketOpen\" id=\"ticket-reader\">\n        <h1 class=\"mb-0 ml-0 pl-0 pb-0 mt-print-4\">{{ reader.title }}</h1>\n        <div\n          class=\"ticket-conversation reader\"\n          v-for=\"(conversation, index) in reader.conversation\"\n          :key=\"`conversation-${index}`\"\n        >\n          <div class=\"ticket-title\">\n            <span class=\"sender\">\n              <i class=\"las la-2x\" :class=\"conversation.user.icon\"></i>\n              <span class=\"font-weight-bold\">{{\n                conversation.user.title\n              }}</span>\n              <erd-badge\n                :variant=\"roleVariant(conversation.user.role)\"\n                class=\"ml-2 pb-1\"\n                >{{ $t(`roles.${conversation.user.role}`) }}</erd-badge\n              >\n            </span>\n            <span class=\"date\">{{ formatDate(conversation.date) }}</span>\n          </div>\n          <div class=\"ticket-body\">\n            <div v-html=\"conversation.message\"></div>\n          </div>\n        </div>\n      </erd-row>\n    </erd-col>\n\n    <!---->\n  </erd-row>\n</template>\n\n<script>\n/* eslint-disable no-unused-vars */\nimport { mapGetters } from \"vuex\";\nimport { httpService } from \"../../../services/http\";\nimport { EventBus } from \"../../../services/ebus\";\n\nexport default {\n  data() {\n    return {\n      isLoading: false,\n      activeBox: 0,\n      tickets: [],\n      editorOpen: false,\n      ticketOpen: false,\n      selected: [],\n      editor: {\n        title: \"\",\n        conversation: [],\n        attachments: [],\n        tags: [],\n        priority: 0,\n        status: 0,\n        departement: 1,\n        message: \"\",\n        id: null,\n      },\n      reader: {\n        ticket: null,\n        title: \"\",\n        conversation: [],\n      },\n      priorities: [\n        { text: this.$t(\"priority.0\"), value: 0 },\n        { text: this.$t(\"priority.1\"), value: 1 },\n        { text: this.$t(\"priority.2\"), value: 2 },\n        { text: this.$t(\"priority.3\"), value: 3 },\n      ],\n      departements: [\n        { text: this.$t(\"departement.0\"), value: 0 },\n        { text: this.$t(\"departement.1\"), value: 1 },\n        { text: this.$t(\"departement.2\"), value: 2 },\n        { text: this.$t(\"departement.3\"), value: 3 },\n        { text: this.$t(\"departement.4\"), value: 4 },\n        { text: this.$t(\"departement.5\"), value: 5 },\n      ],\n    };\n  },\n  computed: {\n    ...mapGetters([\"currentUser\"]),\n    // eslint-disable-next-line vue/return-in-computed-property\n    boxTitle() {\n      switch (this.activeBox) {\n        case 0:\n          return this.$t(\"tickets.open\");\n        case 1:\n          return this.$t(\"tickets.answered\");\n        case 2:\n          return this.$t(\"tickets.closed\");\n        case 3:\n          return this.$t(\"tickets.archived\");\n      }\n    },\n    ticketsInBox() {\n      return this.tickets.filter((ticket) => {\n        return ticket.ticket_status === this.activeBox;\n      });\n    },\n    openTickets() {\n      return (\n        this.tickets.filter((ticket) => {\n          return ticket.ticket_status === 0;\n        }).length + ` ${this.$t(\"navbar.tickets\")}`\n      );\n    },\n    answeredTickets() {\n      return (\n        this.tickets.filter((ticket) => {\n          return ticket.ticket_status === 1;\n        }).length + ` ${this.$t(\"navbar.tickets\")}`\n      );\n    },\n    closedTickets() {\n      return (\n        this.tickets.filter((ticket) => {\n          return ticket.ticket_status === 2;\n        }).length + ` ${this.$t(\"navbar.tickets\")}`\n      );\n    },\n    archivedTickets() {\n      return (\n        this.tickets.filter((ticket) => {\n          return ticket.ticket_status === 3;\n        }).length + ` ${this.$t(\"navbar.tickets\")}`\n      );\n    },\n    canAnswer() {\n      return this.activeBox < 2;\n    },\n    canDelete() {\n      return this.selected.length > 0;\n    },\n    canSelectAll() {\n      return this.ticketsInBox.length > 0;\n    },\n    hasHistory() {\n      return this.editor.conversation.length;\n    },\n  },\n  methods: {\n    formatDate(date, long = true) {\n      return long\n        ? new Date(date).toLocaleString(this.$t(\"date.locale\"))\n        : new Date(date).toLocaleDateString(this.$t(\"date.locale\"));\n    },\n    changeBox(box) {\n      this.editorOpen = false;\n      this.selected.length = 0;\n      this.activeBox = box;\n    },\n    toggleSelectAll() {\n      if (this.selected.length > 0) {\n        this.selected.splice(0, this.selected.length);\n      } else {\n        this.ticketsInBox.map((ticket) => {\n          this.selected.push(ticket.id);\n        });\n      }\n    },\n    loadTickets() {\n      this.isLoading = true;\n      httpService\n        .get(\"users/tickets\")\n        .then((res) => {\n          this.isLoading = false;\n          if (res.status === true) {\n            this.tickets = res.data;\n          }\n        })\n        .catch(() => {\n          this.isLoading = false;\n          this.$notify(\n            \"error\",\n            this.$t(\"profile.failed\"),\n            this.$t(\"tickets.tickets-loading-failed\"),\n            \"la-user-shield\",\n            { duration: 5000, permanent: false }\n          );\n        });\n    },\n    deleteTicket(id) {\n      this.isLoading = true;\n      httpService\n        .delete(`users/tickets/${id !== undefined ? id : this.selected.join()}`)\n        .then((res) => {\n          this.isLoading = false;\n          if (res.status === true) {\n            this.loadTickets();\n          }\n        })\n        .catch(() => {\n          this.isLoading = false;\n          this.$notify(\n            \"error\",\n            this.$t(\"profile.failed\"),\n            this.$t(\"tickets.tickets-removing-failed\"),\n            \"la-user-shield\",\n            { duration: 5000, permanent: false }\n          );\n        });\n    },\n    saveTicket() {\n      let title =\n        this.currentUser.profile &&\n        this.currentUser.profile.name_first.length &&\n        this.currentUser.profile.name_last.length\n          ? `${this.currentUser.profile.name_first} ${this.currentUser.profile.name_last}`\n          : this.currentUser.user.username;\n\n      // Add message to conversation\n      this.editor.conversation.unshift({\n        date: new Date(),\n        message: this.editor.message,\n        user: {\n          title: title,\n          icon: \"la-user\",\n          role: this.currentUser.user.role,\n        },\n      });\n\n      let data = {\n        user_id: this.currentUser.user.id,\n        title: this.editor.title,\n        priority: this.editor.priority,\n        ticket_status: 0,\n        departement: this.editor.departement,\n        conversation: this.editor.conversation,\n        lang: this.$i18n.locale,\n      };\n\n      if (!isNaN(this.editor.id) && this.editor.id !== null) {\n        data.id = this.editor.id;\n      }\n\n      this.isLoading = true;\n      httpService\n        .post(\"users/tickets\", data)\n        .then((res) => {\n          this.isLoading = false;\n          if (res.status === true) {\n            this.editorOpen = false;\n            this.$notify(\n              \"primary\",\n              this.$t(\"profile.success\"),\n              this.$t(\"tickets.tickets-saving-success\"),\n              \"la-paper-plane\",\n              { duration: 5000, permanent: false }\n            );\n            this.loadTickets();\n          }\n        })\n        .catch(() => {\n          this.isLoading = false;\n          this.$notify(\n            \"error\",\n            this.$t(\"profile.failed\"),\n            this.$t(\"tickets.tickets-saving-failed\"),\n            \"la-user-shield\",\n            { duration: 5000, permanent: false }\n          );\n        });\n    },\n    newTicket() {\n      let e = this.editor;\n      e.title = \"\";\n      e.conversation = [];\n      e.attachments = [];\n      e.tags = [];\n      e.priority = 0;\n      e.status = 0;\n      e.departement = 1;\n      e.message = \"\";\n      e.id = null;\n      this.editorOpen = true;\n    },\n    editTicket(ticket) {\n      let e = this.editor;\n      let t;\n      if (ticket) {\n        t = Object.assign({}, ticket);\n      } else {\n        t = Object.assign({}, this.reader.ticket);\n      }\n      e.title = t.title;\n      e.conversation = t.conversation;\n      e.attachments = t.attachments;\n      e.tags = t.tags;\n      e.priority = t.priority;\n      e.status = 0;\n      e.departement = t.departement;\n      e.message = \"\";\n      e.id = t.id;\n      this.ticketOpen = false;\n      this.editorOpen = true;\n    },\n    archiveTicket() {\n      httpService\n        .post(\"users/tickets\", {\n          id: this.reader.ticket.id,\n          user_id: this.currentUser.user.id,\n          ticket_status: 3,\n        })\n        .then((res) => {\n          this.isLoading = false;\n          if (res.status === true) {\n            this.editorOpen = false;\n            this.ticketOpen = false;\n            this.loadTickets();\n          }\n        })\n        .catch(() => {\n          this.isLoading = false;\n          this.$notify(\n            \"error\",\n            this.$t(\"profile.failed\"),\n            this.$t(\"tickets.tickets-saving-failed\"),\n            \"la-user-shield\",\n            { duration: 5000, permanent: false }\n          );\n        });\n    },\n    openTicket(ticket) {\n      this.reader.title = ticket.title;\n      this.reader.conversation = ticket.conversation;\n      this.reader.ticket = ticket;\n      this.ticketOpen = true;\n    },\n    roleVariant(role) {\n      switch (role) {\n        case 1:\n        case 1985:\n          return \"danger\";\n\n        case 2:\n        case 4:\n        case 5:\n          return \"info\";\n\n        case 3:\n          return \"primary\";\n      }\n    },\n    pagePrint() {\n      if (this.ticketOpen) {\n        document.getElementById(\"ticket-reader\").print();\n      } else if (this.editorOpen) {\n        document.getElementById(\"ticket-editor\").print();\n      }\n    },\n    searchInConversations(conversations, search) {\n      let found = false;\n      let re = new RegExp(search, \"i\");\n      conversations.map((conversation) => {\n        if (conversation.message.match(re)) {\n          found = true;\n        }\n      });\n      return found;\n    },\n    searchTicket(search) {\n      if (search === undefined || search === null || search.length === 0) {\n        this.loadTickets();\n      } else {\n        httpService\n          .get(\"users/tickets\")\n          .then((res) => {\n            this.isLoading = false;\n            if (res.status === true) {\n              this.tickets = res.data.filter((ticket) => {\n                var re = new RegExp(search, \"i\");\n                var foundInTitle = ticket.title.match(re);\n                var foundInConversation = this.searchInConversations(\n                  ticket.conversation,\n                  search\n                );\n                return foundInTitle || foundInConversation;\n              });\n            }\n          })\n          .catch(() => {\n            this.tickets = [];\n          });\n      }\n    },\n  },\n  mounted() {\n    this.loadTickets();\n  },\n  beforeMount() {\n    EventBus.$on(\"print\", this.pagePrint);\n    EventBus.$on(\"search\", this.searchTicket);\n  },\n  beforeDestroy() {\n    EventBus.$off(\"print\", this.pagePrint);\n    EventBus.$off(\"search\", this.searchTicket);\n  },\n};\n</script>\n\n<style scoped lang=\"scss\">\n.ticket-card {\n  display: table;\n}\n.ticket-card-title {\n  display: table-cell;\n  vertical-align: middle;\n  width: 100%;\n  padding-left: 0.5rem;\n}\n.ticket-box {\n  user-select: none;\n  display: block;\n  padding: 0.5rem 1rem 0.5rem 0.25rem;\n\n  i {\n    margin-right: 0.3rem;\n    font-size: 18px;\n  }\n\n  span {\n    line-height: 18px;\n  }\n\n  &.active {\n    font-weight: bold;\n  }\n\n  &:not(:last-child) {\n    border-bottom: 1px solid $separator-color-light;\n  }\n}\n.boxes {\n  box-sizing: border-box;\n}\n.ticket-list-header {\n  padding: 0.5rem;\n  border-bottom: 1px solid $separator-color-light;\n\n  h5 {\n    display: inline-block;\n    margin: 0.25rem;\n  }\n\n  .buttons {\n    float: right;\n\n    .btn {\n      width: 29px;\n      height: 29px;\n      padding: 0.25rem;\n      border-radius: 50%;\n    }\n  }\n}\n.ticket-list {\n  padding: 0.5rem 0;\n\n  .empty-list {\n    user-select: none;\n    margin-top: 2rem;\n    margin-bottom: 2rem;\n    text-align: center;\n\n    i {\n      font-size: 32px;\n      color: $muted-color;\n    }\n\n    p {\n      margin-top: 0;\n      color: $muted-color;\n    }\n  }\n\n  .ticket-list-item {\n    line-height: 30px;\n    vertical-align: middle;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n\n    &:hover {\n      a {\n        color: $theme-color-1;\n      }\n    }\n\n    .erd-checkbox {\n      display: inline-block;\n      vertical-align: middle;\n      line-height: normal;\n      box-sizing: border-box;\n      max-width: 20px;\n    }\n\n    a {\n      display: inline-block;\n      box-sizing: border-box;\n      margin: 0;\n      width: 100%;\n    }\n\n    .btn {\n      width: 29px;\n      height: 29px;\n      padding: 0.25rem;\n      border-radius: 50%;\n    }\n\n    &:not(:last-child) {\n      border-bottom: 1px solid $separator-color-light;\n    }\n  }\n}\n.ticket-list-view {\n  box-sizing: border-box;\n}\n.ticket-conversation {\n  background-color: $background-color;\n  border-radius: 10px;\n  padding: 1rem 1rem;\n  border: 1px solid $separator-color;\n  margin-bottom: 0.5rem;\n\n  img {\n    max-width: 50%;\n    max-height: 50%;\n  }\n\n  .ticket-title {\n    display: flex;\n    justify-content: space-between;\n    line-height: 30px;\n  }\n\n  .ticket-body {\n    margin-top: 1rem;\n  }\n\n  &.reader {\n    background-color: $foreground-color;\n    margin-bottom: 0;\n    margin-top: 0.5rem;\n  }\n}\n</style>\n"]}]}