{"remainingRequest":"/home/ernst/Desktop/IPTV-Tools/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ernst/Desktop/IPTV-Tools/src/views/app/user/tickets.vue?vue&type=style&index=0&id=8951352a&scoped=true&lang=scss&","dependencies":[{"path":"/home/ernst/Desktop/IPTV-Tools/src/views/app/user/tickets.vue","mtime":1622629984066},{"path":"/home/ernst/Desktop/IPTV-Tools/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ernst/Desktop/IPTV-Tools/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/ernst/Desktop/IPTV-Tools/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/home/ernst/Desktop/IPTV-Tools/node_modules/sass-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ernst/Desktop/IPTV-Tools/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ernst/Desktop/IPTV-Tools/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi50aWNrZXQtY2FyZCB7CiAgZGlzcGxheTogdGFibGU7Cn0KLnRpY2tldC1jYXJkLXRpdGxlIHsKICBkaXNwbGF5OiB0YWJsZS1jZWxsOwogIHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7CiAgd2lkdGg6IDEwMCU7CiAgcGFkZGluZy1sZWZ0OiAwLjVyZW07Cn0KLnRpY2tldC1ib3ggewogIHVzZXItc2VsZWN0OiBub25lOwogIGRpc3BsYXk6IGJsb2NrOwogIHBhZGRpbmc6IDAuNXJlbSAxcmVtIDAuNXJlbSAwLjI1cmVtOwoKICBpIHsKICAgIG1hcmdpbi1yaWdodDogMC4zcmVtOwogICAgZm9udC1zaXplOiAxOHB4OwogIH0KCiAgc3BhbiB7CiAgICBsaW5lLWhlaWdodDogMThweDsKICB9CgogICYuYWN0aXZlIHsKICAgIGZvbnQtd2VpZ2h0OiBib2xkOwogIH0KCiAgJjpub3QoOmxhc3QtY2hpbGQpIHsKICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAkc2VwYXJhdG9yLWNvbG9yLWxpZ2h0OwogIH0KfQouYm94ZXMgewogIGJveC1zaXppbmc6IGJvcmRlci1ib3g7Cn0KLnRpY2tldC1saXN0LWhlYWRlciB7CiAgcGFkZGluZzogMC41cmVtOwogIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAkc2VwYXJhdG9yLWNvbG9yLWxpZ2h0OwoKICBoNSB7CiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7CiAgICBtYXJnaW46IDAuMjVyZW07CiAgfQoKICAuYnV0dG9ucyB7CiAgICBmbG9hdDogcmlnaHQ7CgogICAgLmJ0biB7CiAgICAgIHdpZHRoOiAyOXB4OwogICAgICBoZWlnaHQ6IDI5cHg7CiAgICAgIHBhZGRpbmc6IDAuMjVyZW07CiAgICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgIH0KICB9Cn0KLnRpY2tldC1saXN0IHsKICBwYWRkaW5nOiAwLjVyZW0gMDsKCiAgLmVtcHR5LWxpc3QgewogICAgdXNlci1zZWxlY3Q6IG5vbmU7CiAgICBtYXJnaW4tdG9wOiAycmVtOwogICAgbWFyZ2luLWJvdHRvbTogMnJlbTsKICAgIHRleHQtYWxpZ246IGNlbnRlcjsKCiAgICBpIHsKICAgICAgZm9udC1zaXplOiAzMnB4OwogICAgICBjb2xvcjogJG11dGVkLWNvbG9yOwogICAgfQoKICAgIHAgewogICAgICBtYXJnaW4tdG9wOiAwOwogICAgICBjb2xvcjogJG11dGVkLWNvbG9yOwogICAgfQogIH0KCiAgLnRpY2tldC1saXN0LWl0ZW0gewogICAgbGluZS1oZWlnaHQ6IDMwcHg7CiAgICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOwogICAgd2hpdGUtc3BhY2U6IG5vd3JhcDsKICAgIG92ZXJmbG93OiBoaWRkZW47CiAgICB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpczsKCiAgICAmOmhvdmVyIHsKICAgICAgYSB7CiAgICAgICAgY29sb3I6ICR0aGVtZS1jb2xvci0xOwogICAgICB9CiAgICB9CgogICAgLmVyZC1jaGVja2JveCB7CiAgICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsKICAgICAgdmVydGljYWwtYWxpZ246IG1pZGRsZTsKICAgICAgbGluZS1oZWlnaHQ6IG5vcm1hbDsKICAgICAgYm94LXNpemluZzogYm9yZGVyLWJveDsKICAgICAgbWF4LXdpZHRoOiAyMHB4OwogICAgfQoKICAgIGEgewogICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7CiAgICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7CiAgICAgIG1hcmdpbjogMDsKICAgICAgd2lkdGg6IDEwMCU7CiAgICB9CgogICAgLmJ0biB7CiAgICAgIHdpZHRoOiAyOXB4OwogICAgICBoZWlnaHQ6IDI5cHg7CiAgICAgIHBhZGRpbmc6IDAuMjVyZW07CiAgICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgIH0KCiAgICAmOm5vdCg6bGFzdC1jaGlsZCkgewogICAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgJHNlcGFyYXRvci1jb2xvci1saWdodDsKICAgIH0KICB9Cn0KLnRpY2tldC1saXN0LXZpZXcgewogIGJveC1zaXppbmc6IGJvcmRlci1ib3g7Cn0KLnRpY2tldC1jb252ZXJzYXRpb24gewogIGJhY2tncm91bmQtY29sb3I6ICRiYWNrZ3JvdW5kLWNvbG9yOwogIGJvcmRlci1yYWRpdXM6IDEwcHg7CiAgcGFkZGluZzogMXJlbSAxcmVtOwogIGJvcmRlcjogMXB4IHNvbGlkICRzZXBhcmF0b3ItY29sb3I7CiAgbWFyZ2luLWJvdHRvbTogMC41cmVtOwoKICBpbWcgewogICAgbWF4LXdpZHRoOiA1MCU7CiAgICBtYXgtaGVpZ2h0OiA1MCU7CiAgfQoKICAudGlja2V0LXRpdGxlIHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47CiAgICBsaW5lLWhlaWdodDogMzBweDsKICB9CgogIC50aWNrZXQtYm9keSB7CiAgICBtYXJnaW4tdG9wOiAxcmVtOwogIH0KCiAgJi5yZWFkZXIgewogICAgYmFja2dyb3VuZC1jb2xvcjogJGZvcmVncm91bmQtY29sb3I7CiAgICBtYXJnaW4tYm90dG9tOiAwOwogICAgbWFyZ2luLXRvcDogMC41cmVtOwogIH0KfQo="},{"version":3,"sources":["tickets.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2pBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"tickets.vue","sourceRoot":"src/views/app/user","sourcesContent":["<template>\n  <erd-row class=\"m-0 p-0\">\n    <erd-spinner v-if=\"isLoading\" size=\"lg\" overlay absolute></erd-spinner>\n    <erd-col xl=\"2\" lg=\"3\" md=\"4\" v-if=\"!editorOpen && !ticketOpen\">\n      <erd-button icon=\"la-user-edit\" block @click=\"newTicket\">\n        {{ $t(\"tickets.new-ticket\") }}\n      </erd-button>\n      <erd-card class=\"mt-3 p-2 boxes\">\n        <a\n          class=\"ticket-box\"\n          href=\"#\"\n          :class=\"{ active: activeBox === 0 }\"\n          @click.prevent=\"changeBox(0)\"\n        >\n          <i class=\"las la-user\"></i>\n          <span>{{ $t(\"tickets.open\") }}</span>\n        </a>\n        <a\n          class=\"ticket-box\"\n          href=\"#\"\n          :class=\"{ active: activeBox === 1 }\"\n          @click.prevent=\"changeBox(1)\"\n        >\n          <i class=\"las la-user-check\"></i>\n          <span>{{ $t(\"tickets.answered\") }}</span>\n        </a>\n        <a\n          class=\"ticket-box\"\n          href=\"#\"\n          :class=\"{ active: activeBox === 2 }\"\n          @click.prevent=\"changeBox(2)\"\n        >\n          <i class=\"las la-user-check\"></i>\n          <span>{{ $t(\"tickets.closed\") }}</span>\n        </a>\n        <a\n          class=\"ticket-box\"\n          href=\"#\"\n          :class=\"{ active: activeBox === 3 }\"\n          @click.prevent=\"changeBox(3)\"\n        >\n          <i class=\"las la-user-lock\"></i>\n          <span>{{ $t(\"tickets.archived\") }}</span>\n        </a>\n      </erd-card>\n    </erd-col>\n    <erd-col xl=\"2\" lg=\"3\" md=\"4\" v-if=\"editorOpen && !ticketOpen\">\n      <erd-button\n        class=\"mb-1\"\n        icon=\"la-paper-plane\"\n        @click=\"saveTicket\"\n        block\n        >{{ $t(\"general.submit\") }}</erd-button\n      >\n      <erd-button\n        variant=\"danger\"\n        @click=\"editorOpen = false\"\n        class=\"mb-3\"\n        block\n        >{{ $t(\"general.cancel\") }}</erd-button\n      >\n      <label for=\"priority\">{{ $t(\"tickets.priority\") }}</label>\n      <erd-select\n        :items=\"priorities\"\n        v-model=\"editor.priority\"\n        class=\"w-100 mb-2\"\n        id=\"priority\"\n      ></erd-select>\n      <label for=\"departement\">{{ $t(\"tickets.departement\") }}</label>\n      <erd-select\n        :items=\"departements\"\n        v-model=\"editor.departement\"\n        class=\"w-100\"\n        id=\"departement\"\n      ></erd-select>\n    </erd-col>\n    <erd-col xl=\"2\" lg=\"3\" md=\"4\" v-if=\"!editorOpen && ticketOpen\">\n      <erd-button\n        class=\"mb-1\"\n        icon=\"la-reply\"\n        @click=\"editTicket\"\n        v-if=\"activeBox < 2\"\n        block\n        >{{ $t(\"tickets.reply\") }}</erd-button\n      >\n      <erd-button\n        variant=\"info\"\n        icon=\"la-user-lock\"\n        @click=\"archiveTicket\"\n        class=\"mb-1\"\n        v-if=\"activeBox < 2\"\n        block\n        >{{ $t(\"tickets.archive\") }}</erd-button\n      >\n      <erd-button\n        variant=\"danger\"\n        @click=\"ticketOpen = false\"\n        class=\"mb-3\"\n        block\n        >{{ $t(\"general.cancel\") }}</erd-button\n      >\n    </erd-col>\n    <erd-col xl=\"10\" lg=\"9\" md=\"8\" class=\"m-0 p-0\">\n      <erd-row class=\"m-0 p-0\" v-if=\"!editorOpen && !ticketOpen\">\n        <erd-col xl=\"3\" md=\"6\" class=\"d-none d-md-block\">\n          <erd-card>\n            <erd-card-body class=\"ticket-card\">\n              <i class=\"las la-user la-5x color-theme-1\"></i>\n              <div class=\"ticket-card-title\" style=\"\">\n                <h5 class=\"m-0\">{{ $t(\"tickets.open\") }}</h5>\n                <p class=\"m-0 color-theme-1\">{{ openTickets }}</p>\n              </div>\n            </erd-card-body>\n          </erd-card>\n        </erd-col>\n        <erd-col xl=\"3\" md=\"6\" class=\"d-none d-md-block\">\n          <erd-card>\n            <erd-card-body class=\"ticket-card\">\n              <i class=\"las la-user-check la-5x text-success\"></i>\n              <div class=\"ticket-card-title\" style=\"\">\n                <h5 class=\"m-0\">{{ $t(\"tickets.answered\") }}</h5>\n                <p class=\"m-0 text-success\">{{ answeredTickets }}</p>\n              </div>\n            </erd-card-body>\n          </erd-card>\n        </erd-col>\n        <erd-col xl=\"3\" md=\"6\" class=\"d-none d-md-block\">\n          <erd-card>\n            <erd-card-body class=\"ticket-card\">\n              <i class=\"las la-user-shield la-5x text-danger\"></i>\n              <div class=\"ticket-card-title\" style=\"\">\n                <h5 class=\"m-0\">{{ $t(\"tickets.closed\") }}</h5>\n                <p class=\"m-0 text-danger\">{{ closedTickets }}</p>\n              </div>\n            </erd-card-body>\n          </erd-card>\n        </erd-col>\n        <erd-col xl=\"3\" md=\"6\" class=\"d-none d-md-block\">\n          <erd-card>\n            <erd-card-body class=\"ticket-card\">\n              <i class=\"las la-user-lock la-5x text-info\"></i>\n              <div class=\"ticket-card-title\" style=\"\">\n                <h5 class=\"m-0\">{{ $t(\"tickets.archived\") }}</h5>\n                <p class=\"m-0 text-info\">{{ archivedTickets }}</p>\n              </div>\n            </erd-card-body>\n          </erd-card>\n        </erd-col>\n        <erd-col xl=\"12\">\n          <erd-card class=\"p-2 ticket-list-view\">\n            <div class=\"ticket-list-header\">\n              <h5>{{ boxTitle }}</h5>\n              <div class=\"buttons\">\n                <erd-button\n                  icon=\"la-check\"\n                  variant=\"info\"\n                  class=\"mr-1\"\n                  :disabled=\"!canSelectAll\"\n                  @click=\"toggleSelectAll\"\n                ></erd-button>\n                <erd-button\n                  icon=\"la-trash\"\n                  variant=\"danger\"\n                  class=\"mr-1\"\n                  :disabled=\"!canDelete\"\n                  @click=\"deleteTicket\"\n                ></erd-button>\n                <erd-button icon=\"la-sync\" @click=\"loadTickets\"></erd-button>\n              </div>\n            </div>\n            <div class=\"ticket-list\">\n              <div class=\"empty-list\" v-if=\"ticketsInBox.length === 0\">\n                <i class=\"las la-box-open\"></i>\n                <p>{{ $t(\"tickets.empty\") }}</p>\n              </div>\n              <div\n                class=\"d-flex flex-row px-2 py-2 justify-content-between ticket-list-item\"\n                v-for=\"ticket in ticketsInBox\"\n                :key=\"`ticket-${ticket.id}`\"\n              >\n                <div class=\"flex-fill\">\n                  <erd-checkbox\n                    :value=\"ticket.id\"\n                    v-model=\"selected\"\n                  ></erd-checkbox>\n                  <a href=\"#\" @click.prevent=\"openTicket(ticket)\"\n                    >{{ ticket.title }}\n                    <erd-badge\n                      class=\"ml-2\"\n                      v-for=\"(tag, index) in ticket.tags\"\n                      :key=\"`ticket-${ticket.id}-tag-${index}`\"\n                      variant=\"primary\"\n                      >{{ tag }}</erd-badge\n                    ></a\n                  >\n                </div>\n                <div class=\"flex-grow-0 flex-shrink-0\">\n                  <erd-button\n                    icon=\"la-reply\"\n                    variant=\"primary\"\n                    class=\"mx-1\"\n                    v-if=\"canAnswer\"\n                    @click=\"editTicket(ticket)\"\n                  ></erd-button>\n                  <erd-button\n                    icon=\"la-trash\"\n                    variant=\"danger\"\n                    class=\"mr-3\"\n                    @click=\"deleteTicket(ticket.id)\"\n                  ></erd-button>\n                  <span\n                    class=\"text-small text-muted d-none d-md-inline-block\"\n                    >{{ formatDate(ticket.last_updated) }}</span\n                  >\n                  <span\n                    class=\"text-small text-muted d-sm-inline-block d-md-none\"\n                    >{{ formatDate(ticket.last_updated, false) }}</span\n                  >\n                </div>\n              </div>\n            </div>\n          </erd-card>\n        </erd-col>\n      </erd-row>\n      <erd-row class=\"m-0 p-0\" v-if=\"editorOpen && !ticketOpen\">\n        <div class=\"ticket-editor\">\n          <label for=\"title\">{{ $t(\"tickets.title\") }}</label>\n          <erd-input\n            v-model=\"editor.title\"\n            class=\"w-100 mb-2\"\n            id=\"title\"\n          ></erd-input>\n          <label>{{ $t(\"tickets.message\") }}</label>\n          <wysiwyg v-model=\"editor.message\" class=\"mb-2\" />\n          <label v-if=\"hasHistory\">{{ $t(\"tickets.history\") }}</label>\n          <div\n            class=\"form-control w-100 pt-4 mt-print-4 pt-print-2\"\n            v-if=\"hasHistory\"\n            id=\"ticket-editor\"\n          >\n            <div\n              class=\"ticket-conversation\"\n              v-for=\"(conversation, index) in editor.conversation\"\n              :key=\"`conversation-${index}`\"\n            >\n              <div class=\"ticket-title\">\n                <span class=\"sender\">\n                  <i class=\"las la-2x\" :class=\"conversation.user.icon\"></i>\n                  <span class=\"font-weight-bold\">{{\n                    conversation.user.title\n                  }}</span>\n                  <erd-badge\n                    :variant=\"roleVariant(conversation.user.role)\"\n                    class=\"ml-2 pb-1\"\n                    >{{ $t(`roles.${conversation.user.role}`) }}</erd-badge\n                  >\n                </span>\n                <span class=\"date\">{{ formatDate(conversation.date) }}</span>\n              </div>\n              <div class=\"ticket-body\">\n                <div v-html=\"conversation.message\"></div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </erd-row>\n      <erd-row class=\"p-0\" v-if=\"!editorOpen && ticketOpen\" id=\"ticket-reader\">\n        <h1 class=\"mb-0 ml-0 pl-0 pb-0 mt-print-4\">{{ reader.title }}</h1>\n        <div\n          class=\"ticket-conversation reader\"\n          v-for=\"(conversation, index) in reader.conversation\"\n          :key=\"`conversation-${index}`\"\n        >\n          <div class=\"ticket-title\">\n            <span class=\"sender\">\n              <i class=\"las la-2x\" :class=\"conversation.user.icon\"></i>\n              <span class=\"font-weight-bold\">{{\n                conversation.user.title\n              }}</span>\n              <erd-badge\n                :variant=\"roleVariant(conversation.user.role)\"\n                class=\"ml-2 pb-1\"\n                >{{ $t(`roles.${conversation.user.role}`) }}</erd-badge\n              >\n            </span>\n            <span class=\"date\">{{ formatDate(conversation.date) }}</span>\n          </div>\n          <div class=\"ticket-body\">\n            <div v-html=\"conversation.message\"></div>\n          </div>\n        </div>\n      </erd-row>\n    </erd-col>\n\n    <!---->\n  </erd-row>\n</template>\n\n<script>\n/* eslint-disable no-unused-vars */\nimport { mapGetters } from \"vuex\";\nimport { httpService } from \"../../../services/http\";\nimport { EventBus } from \"../../../services/ebus\";\n\nexport default {\n  data() {\n    return {\n      isLoading: false,\n      activeBox: 0,\n      tickets: [],\n      editorOpen: false,\n      ticketOpen: false,\n      selected: [],\n      editor: {\n        title: \"\",\n        conversation: [],\n        attachments: [],\n        tags: [],\n        priority: 0,\n        status: 0,\n        departement: 1,\n        message: \"\",\n        id: null,\n      },\n      reader: {\n        ticket: null,\n        title: \"\",\n        conversation: [],\n      },\n      priorities: [\n        { text: this.$t(\"priority.0\"), value: 0 },\n        { text: this.$t(\"priority.1\"), value: 1 },\n        { text: this.$t(\"priority.2\"), value: 2 },\n        { text: this.$t(\"priority.3\"), value: 3 },\n      ],\n      departements: [\n        { text: this.$t(\"departement.0\"), value: 0 },\n        { text: this.$t(\"departement.1\"), value: 1 },\n        { text: this.$t(\"departement.2\"), value: 2 },\n        { text: this.$t(\"departement.3\"), value: 3 },\n        { text: this.$t(\"departement.4\"), value: 4 },\n        { text: this.$t(\"departement.5\"), value: 5 },\n      ],\n    };\n  },\n  computed: {\n    ...mapGetters([\"currentUser\"]),\n    // eslint-disable-next-line vue/return-in-computed-property\n    boxTitle() {\n      switch (this.activeBox) {\n        case 0:\n          return this.$t(\"tickets.open\");\n        case 1:\n          return this.$t(\"tickets.answered\");\n        case 2:\n          return this.$t(\"tickets.closed\");\n        case 3:\n          return this.$t(\"tickets.archived\");\n      }\n    },\n    ticketsInBox() {\n      return this.tickets.filter((ticket) => {\n        return ticket.ticket_status === this.activeBox;\n      });\n    },\n    openTickets() {\n      return (\n        this.tickets.filter((ticket) => {\n          return ticket.ticket_status === 0;\n        }).length + ` ${this.$t(\"navbar.tickets\")}`\n      );\n    },\n    answeredTickets() {\n      return (\n        this.tickets.filter((ticket) => {\n          return ticket.ticket_status === 1;\n        }).length + ` ${this.$t(\"navbar.tickets\")}`\n      );\n    },\n    closedTickets() {\n      return (\n        this.tickets.filter((ticket) => {\n          return ticket.ticket_status === 2;\n        }).length + ` ${this.$t(\"navbar.tickets\")}`\n      );\n    },\n    archivedTickets() {\n      return (\n        this.tickets.filter((ticket) => {\n          return ticket.ticket_status === 3;\n        }).length + ` ${this.$t(\"navbar.tickets\")}`\n      );\n    },\n    canAnswer() {\n      return this.activeBox < 2;\n    },\n    canDelete() {\n      return this.selected.length > 0;\n    },\n    canSelectAll() {\n      return this.ticketsInBox.length > 0;\n    },\n    hasHistory() {\n      return this.editor.conversation.length;\n    },\n  },\n  methods: {\n    formatDate(date, long = true) {\n      return long\n        ? new Date(date).toLocaleString(this.$t(\"date.locale\"))\n        : new Date(date).toLocaleDateString(this.$t(\"date.locale\"));\n    },\n    changeBox(box) {\n      this.editorOpen = false;\n      this.selected.length = 0;\n      this.activeBox = box;\n    },\n    toggleSelectAll() {\n      if (this.selected.length > 0) {\n        this.selected.splice(0, this.selected.length);\n      } else {\n        this.ticketsInBox.map((ticket) => {\n          this.selected.push(ticket.id);\n        });\n      }\n    },\n    loadTickets() {\n      this.isLoading = true;\n      httpService\n        .get(\"users/tickets\")\n        .then((res) => {\n          this.isLoading = false;\n          if (res.status === true) {\n            this.tickets = res.data;\n          }\n        })\n        .catch(() => {\n          this.isLoading = false;\n          this.$notify(\n            \"error\",\n            this.$t(\"profile.failed\"),\n            this.$t(\"tickets.tickets-loading-failed\"),\n            \"la-user-shield\",\n            { duration: 5000, permanent: false }\n          );\n        });\n    },\n    deleteTicket(id) {\n      this.isLoading = true;\n      httpService\n        .delete(`users/tickets/${id !== undefined ? id : this.selected.join()}`)\n        .then((res) => {\n          this.isLoading = false;\n          if (res.status === true) {\n            this.loadTickets();\n          }\n        })\n        .catch(() => {\n          this.isLoading = false;\n          this.$notify(\n            \"error\",\n            this.$t(\"profile.failed\"),\n            this.$t(\"tickets.tickets-removing-failed\"),\n            \"la-user-shield\",\n            { duration: 5000, permanent: false }\n          );\n        });\n    },\n    saveTicket() {\n      let title =\n        this.currentUser.profile &&\n        this.currentUser.profile.name_first.length &&\n        this.currentUser.profile.name_last.length\n          ? `${this.currentUser.profile.name_first} ${this.currentUser.profile.name_last}`\n          : this.currentUser.user.username;\n\n      // Add message to conversation\n      this.editor.conversation.unshift({\n        date: new Date(),\n        message: this.editor.message,\n        user: {\n          title: title,\n          icon: \"la-user\",\n          role: this.currentUser.user.role,\n        },\n      });\n\n      let data = {\n        user_id: this.currentUser.user.id,\n        title: this.editor.title,\n        priority: this.editor.priority,\n        ticket_status: 0,\n        departement: this.editor.departement,\n        conversation: this.editor.conversation,\n        lang: this.$i18n.locale,\n      };\n\n      if (!isNaN(this.editor.id) && this.editor.id !== null) {\n        data.id = this.editor.id;\n      }\n\n      this.isLoading = true;\n      httpService\n        .post(\"users/tickets\", data)\n        .then((res) => {\n          this.isLoading = false;\n          if (res.status === true) {\n            this.editorOpen = false;\n            this.$notify(\n              \"primary\",\n              this.$t(\"profile.success\"),\n              this.$t(\"tickets.tickets-saving-success\"),\n              \"la-paper-plane\",\n              { duration: 5000, permanent: false }\n            );\n            this.loadTickets();\n          }\n        })\n        .catch(() => {\n          this.isLoading = false;\n          this.$notify(\n            \"error\",\n            this.$t(\"profile.failed\"),\n            this.$t(\"tickets.tickets-saving-failed\"),\n            \"la-user-shield\",\n            { duration: 5000, permanent: false }\n          );\n        });\n    },\n    newTicket() {\n      let e = this.editor;\n      e.title = \"\";\n      e.conversation = [];\n      e.attachments = [];\n      e.tags = [];\n      e.priority = 0;\n      e.status = 0;\n      e.departement = 1;\n      e.message = \"\";\n      e.id = null;\n      this.editorOpen = true;\n    },\n    editTicket(ticket) {\n      let e = this.editor;\n      let t;\n      if (ticket) {\n        t = Object.assign({}, ticket);\n      } else {\n        t = Object.assign({}, this.reader.ticket);\n      }\n      e.title = t.title;\n      e.conversation = t.conversation;\n      e.attachments = t.attachments;\n      e.tags = t.tags;\n      e.priority = t.priority;\n      e.status = 0;\n      e.departement = t.departement;\n      e.message = \"\";\n      e.id = t.id;\n      this.ticketOpen = false;\n      this.editorOpen = true;\n    },\n    archiveTicket() {\n      httpService\n        .post(\"users/tickets\", {\n          id: this.reader.ticket.id,\n          user_id: this.currentUser.user.id,\n          ticket_status: 3,\n        })\n        .then((res) => {\n          this.isLoading = false;\n          if (res.status === true) {\n            this.editorOpen = false;\n            this.ticketOpen = false;\n            this.loadTickets();\n          }\n        })\n        .catch(() => {\n          this.isLoading = false;\n          this.$notify(\n            \"error\",\n            this.$t(\"profile.failed\"),\n            this.$t(\"tickets.tickets-saving-failed\"),\n            \"la-user-shield\",\n            { duration: 5000, permanent: false }\n          );\n        });\n    },\n    openTicket(ticket) {\n      this.reader.title = ticket.title;\n      this.reader.conversation = ticket.conversation;\n      this.reader.ticket = ticket;\n      this.ticketOpen = true;\n    },\n    roleVariant(role) {\n      switch (role) {\n        case 1:\n        case 1985:\n          return \"danger\";\n\n        case 2:\n        case 4:\n        case 5:\n          return \"info\";\n\n        case 3:\n          return \"primary\";\n      }\n    },\n    pagePrint() {\n      if (this.ticketOpen) {\n        document.getElementById(\"ticket-reader\").print();\n      } else if (this.editorOpen) {\n        document.getElementById(\"ticket-editor\").print();\n      }\n    },\n    searchInConversations(conversations, search) {\n      let found = false;\n      let re = new RegExp(search, \"i\");\n      conversations.map((conversation) => {\n        if (conversation.message.match(re)) {\n          found = true;\n        }\n      });\n      return found;\n    },\n    searchTicket(search) {\n      if (search === undefined || search === null || search.length === 0) {\n        this.loadTickets();\n      } else {\n        httpService\n          .get(\"users/tickets\")\n          .then((res) => {\n            this.isLoading = false;\n            if (res.status === true) {\n              this.tickets = res.data.filter((ticket) => {\n                var re = new RegExp(search, \"i\");\n                var foundInTitle = ticket.title.match(re);\n                var foundInConversation = this.searchInConversations(\n                  ticket.conversation,\n                  search\n                );\n                return foundInTitle || foundInConversation;\n              });\n            }\n          })\n          .catch(() => {\n            this.tickets = [];\n          });\n      }\n    },\n  },\n  mounted() {\n    this.loadTickets();\n  },\n  beforeMount() {\n    EventBus.$on(\"print\", this.pagePrint);\n    EventBus.$on(\"search\", this.searchTicket);\n  },\n  beforeDestroy() {\n    EventBus.$off(\"print\", this.pagePrint);\n    EventBus.$off(\"search\", this.searchTicket);\n  },\n};\n</script>\n\n<style scoped lang=\"scss\">\n.ticket-card {\n  display: table;\n}\n.ticket-card-title {\n  display: table-cell;\n  vertical-align: middle;\n  width: 100%;\n  padding-left: 0.5rem;\n}\n.ticket-box {\n  user-select: none;\n  display: block;\n  padding: 0.5rem 1rem 0.5rem 0.25rem;\n\n  i {\n    margin-right: 0.3rem;\n    font-size: 18px;\n  }\n\n  span {\n    line-height: 18px;\n  }\n\n  &.active {\n    font-weight: bold;\n  }\n\n  &:not(:last-child) {\n    border-bottom: 1px solid $separator-color-light;\n  }\n}\n.boxes {\n  box-sizing: border-box;\n}\n.ticket-list-header {\n  padding: 0.5rem;\n  border-bottom: 1px solid $separator-color-light;\n\n  h5 {\n    display: inline-block;\n    margin: 0.25rem;\n  }\n\n  .buttons {\n    float: right;\n\n    .btn {\n      width: 29px;\n      height: 29px;\n      padding: 0.25rem;\n      border-radius: 50%;\n    }\n  }\n}\n.ticket-list {\n  padding: 0.5rem 0;\n\n  .empty-list {\n    user-select: none;\n    margin-top: 2rem;\n    margin-bottom: 2rem;\n    text-align: center;\n\n    i {\n      font-size: 32px;\n      color: $muted-color;\n    }\n\n    p {\n      margin-top: 0;\n      color: $muted-color;\n    }\n  }\n\n  .ticket-list-item {\n    line-height: 30px;\n    vertical-align: middle;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n\n    &:hover {\n      a {\n        color: $theme-color-1;\n      }\n    }\n\n    .erd-checkbox {\n      display: inline-block;\n      vertical-align: middle;\n      line-height: normal;\n      box-sizing: border-box;\n      max-width: 20px;\n    }\n\n    a {\n      display: inline-block;\n      box-sizing: border-box;\n      margin: 0;\n      width: 100%;\n    }\n\n    .btn {\n      width: 29px;\n      height: 29px;\n      padding: 0.25rem;\n      border-radius: 50%;\n    }\n\n    &:not(:last-child) {\n      border-bottom: 1px solid $separator-color-light;\n    }\n  }\n}\n.ticket-list-view {\n  box-sizing: border-box;\n}\n.ticket-conversation {\n  background-color: $background-color;\n  border-radius: 10px;\n  padding: 1rem 1rem;\n  border: 1px solid $separator-color;\n  margin-bottom: 0.5rem;\n\n  img {\n    max-width: 50%;\n    max-height: 50%;\n  }\n\n  .ticket-title {\n    display: flex;\n    justify-content: space-between;\n    line-height: 30px;\n  }\n\n  .ticket-body {\n    margin-top: 1rem;\n  }\n\n  &.reader {\n    background-color: $foreground-color;\n    margin-bottom: 0;\n    margin-top: 0.5rem;\n  }\n}\n</style>\n"]}]}