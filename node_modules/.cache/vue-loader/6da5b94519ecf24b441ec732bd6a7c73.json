{"remainingRequest":"/media/ernst/63bce43c-5e51-4bf1-a611-3afdf32ac6f6/VueJS/IPTV-Tools/node_modules/vue-loader/lib/index.js??vue-loader-options!/media/ernst/63bce43c-5e51-4bf1-a611-3afdf32ac6f6/VueJS/IPTV-Tools/src/views/app/tools/applications/kodi.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"/media/ernst/63bce43c-5e51-4bf1-a611-3afdf32ac6f6/VueJS/IPTV-Tools/src/views/app/tools/applications/kodi.vue","mtime":1626969972844},{"path":"/media/ernst/63bce43c-5e51-4bf1-a611-3afdf32ac6f6/VueJS/IPTV-Tools/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/media/ernst/63bce43c-5e51-4bf1-a611-3afdf32ac6f6/VueJS/IPTV-Tools/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/media/ernst/63bce43c-5e51-4bf1-a611-3afdf32ac6f6/VueJS/IPTV-Tools/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/media/ernst/63bce43c-5e51-4bf1-a611-3afdf32ac6f6/VueJS/IPTV-Tools/node_modules/sass-loader/dist/cjs.js","mtime":499162500000},{"path":"/media/ernst/63bce43c-5e51-4bf1-a611-3afdf32ac6f6/VueJS/IPTV-Tools/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/media/ernst/63bce43c-5e51-4bf1-a611-3afdf32ac6f6/VueJS/IPTV-Tools/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5rb2RpLW1lbnUgewogIHBvc2l0aW9uOiByZWxhdGl2ZTsKICBoZWlnaHQ6IGNhbGMoMTAwJSAtIDUwcHgpOwp9Cgoua29kaS1kZXNjcmlwdGlvbiB7CiAgcG9zaXRpb246IGFic29sdXRlOwogIGJvdHRvbTogMDsKfQoKLmtvZGktbW92aWVzIHsKICBoZWlnaHQ6IDE1MHB4ICFpbXBvcnRhbnQ7CiAgcGFkZGluZzogMCAhaW1wb3J0YW50OwogIC5wcyB7CiAgICBoZWlnaHQ6IDEwMCU7CiAgfQp9Cgoua29kaS1zZXJpZXMgewogIGhlaWdodDogMTUwcHggIWltcG9ydGFudDsKICBwYWRkaW5nOiAwICFpbXBvcnRhbnQ7CiAgLnBzIHsKICAgIGhlaWdodDogMTAwJTsKICB9Cn0K"},{"version":3,"sources":["kodi.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4ZA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"kodi.vue","sourceRoot":"src/views/app/tools/applications","sourcesContent":["<template>\n  <erd-row class=\"m-0 p-0\">\n    <erd-spinner v-if=\"isLoading\" size=\"lg\" overlay absolute></erd-spinner>\n    <!--  \n\n      INSTANCE EDITOR\n\n    -->\n    <erd-modal\n      v-show=\"modal\"\n      @close=\"m3u2strmModal(false)\"\n      :title=\"$t('kodi.kodi')\"\n      class=\"select-none\"\n      small\n    >\n      <div class=\"px-2\" v-if=\"instance\">\n        <label class=\"w-100\">{{ $t(\"kodi.name\") }}</label>\n        <erd-input\n          class=\"mt-1 mb-2 w-100\"\n          v-model=\"instance.name\"\n        ></erd-input>\n        <label class=\"w-100\">{{ $t(\"kodi.code\") }}</label>\n        <erd-input\n          class=\"mt-1 mb-2 w-100\"\n          v-model=\"instance.code\"\n          readonly\n        ></erd-input>\n        <label class=\"w-100\">{{ $t(\"kodi.movies\") }}</label>\n        <div class=\"kodi-movies form-control mt-1 mb-2\">\n          <perfect-scrollbar>\n            <erd-checkbox v-for=\"(movie, index) in movies\" :key=\"`movie-${index}`\" class=\"mx-2\" :class=\"{'mt-2': index === 0}\" v-model=\"instance.groups\" :value=\"movie.id\">{{ movie.group_name }}</erd-checkbox>\n          </perfect-scrollbar>\n        </div>\n        <label class=\"w-100\">{{ $t(\"kodi.series\") }}</label>\n        <div class=\"kodi-series form-control mt-1 mb-2\">\n          <perfect-scrollbar>\n            <erd-checkbox v-for=\"(serie, index) in series\" :key=\"`serie-${index}`\" class=\"mx-2\" :class=\"{'mt-2': index === 0}\" v-model=\"instance.groups\" :value=\"serie.id\">{{ serie.group_name }}</erd-checkbox>\n          </perfect-scrollbar>\n        </div>\n      </div>\n      <template v-slot:footer>\n        <erd-button\n          @click=\"m3u2strmModal(false)\"\n          icon=\"la-times\"\n          class=\"mr-1\"\n          variant=\"danger\"\n          >{{ $t(\"general.cancel\") }}</erd-button\n        >\n        <erd-button\n          icon=\"la-check\"\n          variant=\"success\"\n          @click=\"m3u2strmModal(false, true)\"\n          >{{ $t(\"general.ok\") }}</erd-button\n        >\n      </template>\n    </erd-modal>\n    <!--  \n\n      APP MENU\n\n    -->\n    <erd-app-menu icon=\"la-tools\">\n      <div class=\"pt-3 select-none kodi-menu\">\n        <erd-collapse\n          :title=\"$t('kodi.kodi')\"\n          key=\"kodi-instance\"\n          small\n        >\n          <ul class=\"list-unstyled mb-0\">\n            <li class=\"nav-item\">\n              <a href=\"#\" @click.prevent=\"addInstance\"\n                ><i class=\"las la-plus mr-1\"></i\n                >{{ $t(\"kodi.add-instance\") }}</a\n              >\n            </li>\n          </ul>\n        </erd-collapse>\n        <erd-collapse\n          :title=\"$t('kodi.download-addon')\"\n          key=\"kodi-download\"\n          small\n        >\n          <ul class=\"list-unstyled mb-0\">\n            <li class=\"nav-item\">\n              <a href=\"https://iptv-tools.com/downloads/m3u2strm-win.zip\"\n                ><i class=\"las la-download mr-1\"></i\n                >{{ $t(\"kodi.download-zip\") }}</a\n              >\n            </li>\n            <li class=\"nav-item\">\n              <div class=\"form-control\">\n                <p class=\"text-center\">{{ $t(\"kodi.add-source\") }}</p>\n              </div>\n            </li>\n          </ul>\n        </erd-collapse>\n        <div class=\"px-2 kodi-description\">\n          <p class=\"text-muted\">{{ $t(\"kodi.description\") }}</p>\n        </div>\n      </div>\n    </erd-app-menu>\n    <!--  \n\n      M3U 2 STRM INSTANCES\n\n    -->\n    <erd-col xl=\"12\" sm=\"12\">\n      <b-table :items=\"pagedInstances\" :fields=\"fields\" striped small>\n        <template v-slot:cell(groups)=\"row\">\n          <erd-badge v-for=\"group in row.item.groups\" :key=\"`group-${group}`\" :variant=\"groupVariant(group)\" class=\"mr-1 mt-1 d-inline-block\">{{ groupName(group) }}</erd-badge>\n        </template>\n        <template v-slot:cell(code)=\"row\">\n          <erd-badge variant=\"success\"><i class=\"las la-key\"></i> {{ row.item.code }}</erd-badge>\n        </template>\n        <template v-slot:cell(actions)=\"row\">\n          <erd-tooltip :tooltip=\"$t('xd-pro.tooltip-edit-instance')\" :enabled=\"showTooltips\">\n            <erd-button\n              variant=\"info\"\n              class=\"btn-table\"\n              @click=\"editInstance(row.item)\"\n              ><i class=\"las la-pen\"></i\n            ></erd-button>\n          </erd-tooltip>\n          <erd-tooltip :tooltip=\"$t('xd-pro.tooltip-delete-instance')\" :enabled=\"showTooltips\">\n            <erd-button\n              variant=\"danger\"\n              class=\"btn-table\"\n              @click=\"deleteInstance(row.item.id)\"\n              ><i class=\"las la-trash\"></i\n            ></erd-button>\n          </erd-tooltip>\n        </template>\n      </b-table>\n      <b-pagination\n        key=\"m3u2strm-instances\"\n        class=\"w-100 my-3\"\n        size=\"sm\"\n        align=\"center\"\n        :total-rows=\"total\"\n        :per-page=\"perPage\"\n        v-model=\"currentPage\"\n      >\n        <template v-slot:next-text>\n          <i class=\"las la-angle-right\" />\n        </template>\n        <template v-slot:prev-text>\n          <i class=\"las la-angle-left\" />\n        </template>\n        <template v-slot:first-text>\n          <i class=\"las la-angle-double-left\" />\n        </template>\n        <template v-slot:last-text>\n          <i class=\"las la-angle-double-right\" />\n        </template>\n      </b-pagination>\n    </erd-col>\n  </erd-row>\n</template>\n\n<script>\n/* eslint-disable vue/no-side-effects-in-computed-properties */\n/* eslint-disable no-unused-vars */\nimport { EventBus } from \"../../../../services/ebus\";\nimport { httpService } from \"../../../../services/http\";\nimport { mapGetters } from \"vuex\";\n\nexport default {\n  data() {\n    return {\n      search: null,\n      isLoading: false,\n      modal: false,\n      instance: null,\n      instances: [],\n      movies: [],\n      series: [],\n      from: 0,\n      to: 0,\n      total: 0,\n      currentPage: 0,\n      fields: [\n        { key: \"name\", label: this.$t(\"m3u2strm.name\"), sortable: true },\n        {\n          key: \"groups\",\n          label: this.$t(\"kodi.groups\"),\n          sortable: true,\n        },\n        {\n          key: \"code\",\n          label: this.$t(\"kodi.code\"),\n          sortable: true,\n        },\n        {\n          key: \"actions\",\n          label: this.$t(\"users.actions\"),\n          sortable: false,\n          thClass: \"text-right\",\n          tdClass: \"text-right\",\n        },\n      ],\n    };\n  },\n  computed: {\n    ...mapGetters([\"currentUser\", \"settings\"]),\n    showTooltips () {\n      return this.settings.showTooltips;\n    },\n    searchFilteredInstances() {\n      if (this.search === null) {\n        return this.instances;\n      } else {\n        var re = new RegExp(this.search, \"i\");\n        return this.instances.filter((kodi) => {\n          return (\n            String(kodi.name).match(re) ||\n            String(kodi.code).match(re) ||\n            String(kodi.groups).match(re)\n          );\n        });\n      }\n    },\n    perPage() {\n      return this.settings.perPage;\n    },\n    pagedInstances() {\n      this.total = this.searchFilteredInstances.length;\n      this.from = (this.currentPage - 1) * this.perPage || 0;\n      this.to =\n        this.from + this.perPage > this.total\n          ? this.total\n          : this.from + this.perPage;\n      return this.searchFilteredInstances.slice(this.from, this.to);\n    },\n  },\n  methods: {\n    searchStream(search) {\n      if (search.length === 0) {\n        this.search = null;\n      } else {\n        this.search = search;\n      }\n    },\n    printStreams() {\n      document.getElementById(\"streams\").print();\n    },\n    formatDate(date) {\n      return new Date(date).toLocaleString(\n        this.$t(\"date.locale\"),\n        this.dateOptions\n      );\n    },\n    addInstance() {\n      this.isLoading = true;\n      httpService.post(\"kodi/instance\").then((res) => {\n        this.isLoading = false;\n        if (res.status === true) {\n          this.instance = {\n            id: res.data.id,\n            name: \"\",\n            groups: [],\n            code: res.data.code,\n            pin: \"\"\n          };\n          this.modal = true;\n        }\n      });\n    },\n    editInstance(instance) {\n      this.instance = Object.assign({}, instance);\n      this.modal = true;\n    },\n    deleteInstance(id) {\n      this.isLoading = true;\n      httpService\n        .delete(`kodi/instance/${id}`)\n        .then((res) => {\n          this.isLoading = false;\n          this.loadInstances();\n          if (res.status === true) {\n            this.$notify(\n              \"primary\",\n              this.$t(\"profile.success\"),\n              this.$t(\"kodi.delete-success\"),\n              \"la-user-shield\",\n              { duration: 5000, permanent: false }\n            );\n          }\n        })\n        .catch(() => {\n          this.isLoading = false;\n          this.loadInstances();\n          this.$notify(\n            \"error\",\n            this.$t(\"profile.failed\"),\n            this.$t(\"kodi.delete-error\"),\n            \"la-user-shield\",\n            { duration: 5000, permanent: false }\n          );\n        });\n    },\n    saveInstance() {\n      this.isLoading = true;\n      let instance = Object.assign({}, this.instance);\n      httpService\n        .put(`kodi/instance/${this.instance.id}`, instance)\n        .then((res) => {\n          this.isLoading = false;\n          this.loadInstances();\n          if (res.status === true) {\n            this.instance = null;\n            this.$notify(\n              \"primary\",\n              this.$t(\"profile.success\"),\n              this.$t(\"kodi.save-success\"),\n              \"la-user-shield\",\n              { duration: 5000, permanent: false }\n            );\n          }\n        })\n        .catch(() => {\n          this.isLoading = false;\n          this.loadInstances();\n          this.$notify(\n            \"error\",\n            this.$t(\"profile.failed\"),\n            this.$t(\"kodi.save-error\"),\n            \"la-user-shield\",\n            { duration: 5000, permanent: false }\n          );\n        });\n    },\n    m3u2strmModal(show, save = false) {\n      if (save) {\n        this.saveInstance();\n      }\n      this.modal = show;\n    },\n    loadInstances() {\n      this.isLoading = true;\n      httpService\n        .get(\"kodi/instances\")\n        .then((res) => {\n          this.isLoading = false;\n          if (res.status === true) {\n            this.instances = res.data;\n          }\n        })\n        .catch(() => {\n          this.isLoading = false;\n        });\n    },\n    loadGroups() {\n      this.isLoading = true;\n      httpService\n        .get(\"kodi/groups\")\n        .then((res) => {\n          this.isLoading = false;\n          if (res.status === true) {\n            this.movies = res.data.movies;\n            this.series = res.data.series;\n          }\n        })\n        .catch(() => {\n          this.isLoading = false;\n        });\n    },\n    refresh() {\n      this.loadGroups();\n      this.loadInstances();\n    },\n    groupVariant(id) {\n      let movie = this.movies.find(m => m.id === id);\n      let serie = this.series.find(s => s.id === id);\n      if (movie !== undefined) {\n        return 'info';\n      }\n      if (serie !== undefined) {\n        return 'primary';\n      }\n      return 'danger';\n    },\n    groupName(id) {\n      let movie = this.movies.find(m => m.id === id);\n      let serie = this.series.find(s => s.id === id);\n      if (movie !== undefined) {\n        return movie.group_name;\n      }\n      if (serie !== undefined) {\n        return serie.group_name;\n      }\n      return 'N/A';\n    }\n  },\n  beforeMount() {\n    this.loadGroups();\n    this.loadInstances();\n    document.body.classList.add(\"right-menu\");\n    EventBus.$on(\"search\", this.searchStream);\n    EventBus.$on(\"print\", this.printStreams);\n    EventBus.$on(\"refresh\", this.refresh);\n  },\n  beforeDestroy() {\n    document.body.classList.remove(\"right-menu\");\n    EventBus.$off(\"search\", this.searchStream);\n    EventBus.$off(\"print\", this.printStreams);\n    EventBus.$off(\"refresh\", this.refresh);\n  },\n  watch: {},\n};\n</script>\n\n<style lang=\"scss\">\n.kodi-menu {\n  position: relative;\n  height: calc(100% - 50px);\n}\n\n.kodi-description {\n  position: absolute;\n  bottom: 0;\n}\n\n.kodi-movies {\n  height: 150px !important;\n  padding: 0 !important;\n  .ps {\n    height: 100%;\n  }\n}\n\n.kodi-series {\n  height: 150px !important;\n  padding: 0 !important;\n  .ps {\n    height: 100%;\n  }\n}\n</style>\n"]}]}